2024-12-30 17:22:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:01 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:23:01 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:23:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:03 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:23:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:23:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:23:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:23:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:23:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:23:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:23:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:23:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:23:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:23:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:23:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:23:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:23:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:23:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:23:04 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:23:04 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:23:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:14 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:14 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:23:17 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:23:17 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:23:17 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:23:17 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\traces
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters
2024-12-30 17:23:17 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e0647f4f-faa4-460a-ae09-6cac6f1e1b6c
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e0647f4f-faa4-460a-ae09-6cac6f1e1b6c', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:17.621145', 'character_id': 'current'}
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:23:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '53a2e521-35fc-4660-872b-cdfcf07adaa7', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:17.651064', 'character_id': 'current'}
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7 and game_id: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7 and section_number: 1
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:23:17 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:23:17 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:23:17 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:23:17 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:23:17 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:23:17 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:23:17 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:23:17 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:23:17 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:23:17 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:23:17 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:23:17 | ERROR    | agents.story_graph:_process_decision:222 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=37176, pipe_handle=1144)
                                      â           â <function spawn_main at 0x00000299F88C0860>
                                      â <function spawn_main at 0x00000299F88C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 592
               â     â 3
               â <function _main at 0x00000299F88C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 592
           â    â <function BaseProcess._bootstrap at 0x00000299F8806A20>
           â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000299F8805F80>
    â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000299FDDAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
    â    â <function subprocess_started at 0x00000299FE00E700>
    â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=720, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000299FDDAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=720, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x00000299FE00D9E0>
           â       â   â <uvicorn.server.Server object at 0x00000299FDDAF4D0>
           â       â <function run at 0x00000299F8E063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x00000299FE002420>
           â      â <function Runner.run at 0x00000299F8E704A0>
           â <asyncio.runners.Runner object at 0x00000299FE038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000299F8E69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x00000299FE038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000299F8E69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000299F8E6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000299F8DED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x00000299FDC531A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:23:21 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:23:21 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:23:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f8817732-8e68-4758-ac86-682e34e9a36d
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f8817732-8e68-4758-ac86-682e34e9a36d', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:21.825994', 'character_id': 'current'}
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: f8817732-8e68-4758-ac86-682e34e9a36d and game_id: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: f8817732-8e68-4758-ac86-682e34e9a36d and section_number: 1
2024-12-30 17:23:21 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:23:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:23:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:23:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:23:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:23:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:23:21 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:23:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:23:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:23:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:23:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:23:21 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:23:21 | ERROR    | agents.story_graph:_process_decision:204 - Decision missing next_section
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:23:21 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:23:21 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:23:21 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:24:07 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:24:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:24:07 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:07 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:24:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:24:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:24:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:24:15 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:24:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:24:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:24:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:24:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:24:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:24:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:24:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:24:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:24:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:24:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:24:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:24:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:24:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:24:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:24:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:24:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:24:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:24:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:24:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:20 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:20 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:25:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:49 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:25:49 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:25:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:25:52 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:25:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:25:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:25:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:25:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:25:52 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:25:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:25:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:25:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:25:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:25:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:25:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:25:52 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:25:52 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:25:52 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:25:52 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:52 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:25:57 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:25:57 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:25:57 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:25:57 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\traces
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters
2024-12-30 17:25:57 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 104f6641-f028-46af-8958-ff331871d090
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '104f6641-f028-46af-8958-ff331871d090', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:25:57.113508', 'character_id': 'current'}
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:25:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ac451b39-ed3b-438a-8072-6ca73502d642
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ac451b39-ed3b-438a-8072-6ca73502d642', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:25:57.132901', 'character_id': 'current'}
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ac451b39-ed3b-438a-8072-6ca73502d642 and game_id: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ac451b39-ed3b-438a-8072-6ca73502d642 and section_number: 1
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:25:57 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:25:57 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:25:57 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:25:57 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:25:57 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:25:57 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:25:57 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:25:57 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:25:57 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:25:57 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:25:57 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:25:57 | ERROR    | agents.story_graph:_process_decision:222 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1240)
                                      â           â <function spawn_main at 0x00000284B68C0860>
                                      â <function spawn_main at 0x00000284B68C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 604
               â     â 3
               â <function _main at 0x00000284B68C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 604
           â    â <function BaseProcess._bootstrap at 0x00000284B6806A20>
           â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000284B6805F80>
    â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000284BBCAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
    â    â <function subprocess_started at 0x00000284BBD0E700>
    â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=752, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000284BBCAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=752, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x00000284BBD0D9E0>
           â       â   â <uvicorn.server.Server object at 0x00000284BBCAF4D0>
           â       â <function run at 0x00000284B6D063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x00000284BBD06420>
           â      â <function Runner.run at 0x00000284B6D704A0>
           â <asyncio.runners.Runner object at 0x00000284BBD38050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000284B6D69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x00000284BBD38050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000284B6D69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000284B6D6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000284B6CED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x00000284BB9671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:25:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:26:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:26:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:26:12 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:26:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:26:12 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:12 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:26:12 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3c3b6705-0ff4-4366-b561-337622cac39e
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:26:12 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3c3b6705-0ff4-4366-b561-337622cac39e', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:26:12.200388', 'character_id': 'current'}
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 3c3b6705-0ff4-4366-b561-337622cac39e and game_id: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 3c3b6705-0ff4-4366-b561-337622cac39e and section_number: 1
2024-12-30 17:26:12 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:26:12 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:26:12 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:26:12 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:26:12 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:26:12 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:26:12 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:26:12 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:26:12 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:26:12 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:26:12 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:26:12 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:26:12 | ERROR    | agents.story_graph:_process_decision:204 - Decision missing next_section
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:26:12 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:26:12 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:26:12 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:31:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:31:09 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:31:09 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:09 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:31:10 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:31:10 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:31:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:31:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:31:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:31:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:31:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:31:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:31:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:31:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:31:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:31:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:31:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:31:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:31:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:31:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:31:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:31:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:31:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:31:21 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:31:21 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:31:21 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:31:21 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:30 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:30 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:31:33 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:31:33 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:31:33 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:31:33 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\traces
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters
2024-12-30 17:31:33 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 026f30e8-ac4d-451b-9afb-218ae577e947
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '026f30e8-ac4d-451b-9afb-218ae577e947', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:33.028977', 'character_id': 'current'}
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:31:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '402eec1a-d27f-41fa-b8e1-e4608af6e805', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:33.054685', 'character_id': 'current'}
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805 and game_id: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805 and section_number: 1
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:31:33 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:31:33 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:31:33 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:31:33 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:31:33 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:31:33 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:31:33 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:31:33 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:31:33 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:31:33 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:31:33 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:31:33 | ERROR    | agents.story_graph:_process_decision:223 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1288)
                                      â           â <function spawn_main at 0x00000296366C0860>
                                      â <function spawn_main at 0x00000296366C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 612
               â     â 3
               â <function _main at 0x00000296366C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 612
           â    â <function BaseProcess._bootstrap at 0x0000029636606A20>
           â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000029636605F80>
    â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000002963BBAF0E0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
    â    â <function subprocess_started at 0x000002963BE12700>
    â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=912, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000002963BBAF230>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=912, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002963BE119E0>
           â       â   â <uvicorn.server.Server object at 0x000002963BBAF230>
           â       â <function run at 0x0000029636C063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000002963BE06420>
           â      â <function Runner.run at 0x0000029636C704A0>
           â <asyncio.runners.Runner object at 0x000002963BBAFCB0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000029636C69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000002963BBAFCB0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000029636C69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000029636C6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000029636BED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000002963BAFF1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:31:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:31:35 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:31:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:31:35 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:35 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:31:35 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:31:35 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:35 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8c38339f-b30a-4530-9ace-a2b4fbe66335', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:35.993273', 'character_id': 'current'}
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335 and game_id: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335 and section_number: 1
2024-12-30 17:31:36 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:31:36 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:31:36 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:31:36 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:31:36 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:31:36 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:31:36 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:31:36 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:31:36 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:31:36 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:31:36 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:31:36 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_decision:214 - Decision processed: next_section=None
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:31:36 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:31:36 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:31:36 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:31:36 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:34:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:34:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:34:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:34:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 17, 31, 36, 38266)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:34:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:34:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:34:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:34:30 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:34:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:34:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:34:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:34:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:34:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:34:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:34:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:34:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:34:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:34:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:34:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:34:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:34:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:34:32 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:34:32 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:34:32 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:34:32 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:34:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:36:17 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:36:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:36:17 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:36:17 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:36:17 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-30 17:36:17 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:36:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:36:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:36:27 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:36:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:36:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:36:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:36:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:36:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:36:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:36:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:36:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:36:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:36:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:36:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:36:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:36:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:36:28 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:36:28 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:36:28 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:36:28 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:36:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:38:50 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:38:50 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:38:50 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:38:50 | ERROR    | managers.agent_manager:process_game_state:157 - Story graph not initialized
2024-12-30 17:38:50 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: Story graph not initialized
2024-12-30 17:38:50 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Story graph not initialized
2024-12-30 17:39:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:34 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:34 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:39:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:39:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:39:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:39:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:39:57 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:39:57 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:39:57 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:39:57 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\traces
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters
2024-12-30 17:39:57 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9fcdbc25-8b22-43e4-b60e-5e8616f10562
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9fcdbc25-8b22-43e4-b60e-5e8616f10562', 'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'last_update': '2024-12-30T17:39:57.455918', 'character_id': 'current'}
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:39:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fc2ff464-17f5-45fe-9021-7c31c5433615
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fc2ff464-17f5-45fe-9021-7c31c5433615', 'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'last_update': '2024-12-30T17:39:57.532268', 'character_id': 'current'}
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fc2ff464-17f5-45fe-9021-7c31c5433615 and game_id: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fc2ff464-17f5-45fe-9021-7c31c5433615 and section_number: 1
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:39:57 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:39:57 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:39:57 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:39:57 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:39:57 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:39:57 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:39:57 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:39:57 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:39:57 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:39:57 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:39:57 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:39:57 | ERROR    | agents.story_graph:_process_decision:223 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1452)
                                      â           â <function spawn_main at 0x000002B72C8C0860>
                                      â <function spawn_main at 0x000002B72C8C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 612
               â     â 3
               â <function _main at 0x000002B72C8C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 612
           â    â <function BaseProcess._bootstrap at 0x000002B72C806A20>
           â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000002B72C805F80>
    â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000002B731DAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
    â    â <function subprocess_started at 0x000002B73200E700>
    â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=708, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000002B731DAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=708, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002B73200D9E0>
           â       â   â <uvicorn.server.Server object at 0x000002B731DAF4D0>
           â       â <function run at 0x000002B72CD063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000002B732002420>
           â      â <function Runner.run at 0x000002B72CD704A0>
           â <asyncio.runners.Runner object at 0x000002B732038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000002B72CD69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000002B732038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000002B72CD69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000002B72CD6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000002B72CCED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000002B73191F1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:39:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:42:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:42:08 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:08 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:340 - Final game state saved successfully
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:342 - Game stopped successfully
2024-12-30 17:42:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:42:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:42:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:42:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:42:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:42:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:42:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:42:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:42:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:42:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:42:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:42:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:42:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:42:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:42:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:42:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:42:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:42:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:42:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:42:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:43:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:43:48 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:43:48 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:43:48 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-30 17:43:48 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:43:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:43:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:43:57 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:43:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:43:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:43:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:43:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:43:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:43:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:43:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:43:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:43:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:43:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:43:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:43:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:43:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:00 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:00 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:00 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:44:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:44:04 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:44:04 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:44:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:44:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:11 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:44:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:44:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:44:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:44:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:44:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:44:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:44:12 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:44:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:44:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:44:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:44:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:44:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:44:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:13 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:13 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:13 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:44:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:44:47 | INFO     | managers.agent_manager:stop_game:319 - Stopping game...
2024-12-30 17:44:47 | DEBUG    | managers.agent_manager:stop_game:324 - No game ID set, nothing to save
2024-12-30 17:44:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:44:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:52 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:44:52 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:44:52 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:44:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:44:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:44:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:44:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:44:52 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:44:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:44:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:44:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:44:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:44:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:44:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:53 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:53 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:53 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:44:58 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:44:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:44:58 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:58 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:58 | ERROR    | managers.agent_manager:process_game_state:172 - Error processing game state: No game state available
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle Task.task_wakeup()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle Task.task_wakeup()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle Task.task_wakeup()>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\protocols\websockets\wsproto_impl.py", line 235, in run_asgi
    result = await self.app(self.scope, self.receive, self.send)  # type: ignore[func-returns-value]
                   â    â   â    â      â    â        â    â <function WSProtocol.send at 0x0000027F235CB2E0>
                   â    â   â    â      â    â        â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â   â    â      â    â <function WSProtocol.receive at 0x0000027F235CB380>
                   â    â   â    â      â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â   â    â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   â    â   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
                   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                 â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                 â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 â    â <fastapi.applications.FastAPI object at 0x0000027F23087770>
                 â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                           â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                           â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
          â <fastapi.applications.FastAPI object at 0x0000027F23087770>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
          â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â                            â    â    â     â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â    â     â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â    â     â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â    â <starlette.websockets.WebSocket object at 0x0000027F235DB6F0>
          â                            â    â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
          â                            â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027F230805A0>>
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          â     â      â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â     â      â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â     â      â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â     â <function WebSocketRoute.handle at 0x0000027F210BEF20>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
          â    â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <function websocket_session.<locals>.app at 0x0000027F234916C0>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          â                            â    â        â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â                            â    â        â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â        â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â <starlette.websockets.WebSocket object at 0x0000027F238CE450>
          â                            â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F23904900>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
          â    â <starlette.websockets.WebSocket object at 0x0000027F238CE450>
          â <function get_websocket_app.<locals>.app at 0x0000027F23491620>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
          â         â      â             â {'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starlette.websockets.WebSocke...
          â         â      â SolvedDependency(values={'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starl...
          â         â <function game_websocket_endpoint at 0x0000027F22C42520>
          â Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "C:\Users\erpes\Desktop\casys-rpg\api\routes\ws\game_route_ws.py", line 137, in game_websocket_endpoint
    new_state = await agent_mgr.process_game_state(
                      â         â <function AgentManager.process_game_state at 0x0000027F22C40540>
                      â <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>

> File "C:\Users\erpes\Desktop\casys-rpg\managers\agent_manager.py", line 149, in process_game_state
    raise GameError("No game state available")
          â <class 'models.errors_model.GameError'>

models.errors_model.GameError: No game state available
2024-12-30 17:44:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No game state available
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | managers.agent_manager:initialize_game:196 - Initializing game
2024-12-30 17:45:08 | INFO     | managers.agent_manager:get_story_workflow:247 - Getting story workflow
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_story_workflow:251 - Story graph not configured, configuring now
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_story_workflow:260 - Compiling workflow
2024-12-30 17:45:08 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:45:08 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:45:08 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\traces
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters
2024-12-30 17:45:08 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3be4bced-3c0b-4192-823b-59a698f6de2b
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3be4bced-3c0b-4192-823b-59a698f6de2b', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:08.306687', 'character_id': 'current'}
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:45:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 188a22cf-6192-446d-91af-2a963429f1eb
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '188a22cf-6192-446d-91af-2a963429f1eb', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:08.327069', 'character_id': 'current'}
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 188a22cf-6192-446d-91af-2a963429f1eb and game_id: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 188a22cf-6192-446d-91af-2a963429f1eb and section_number: 1
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:45:08 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:45:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:45:08 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:45:08 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:45:08 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:45:08 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:45:08 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:45:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:45:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:45:08 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:45:08 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:45:08 | ERROR    | agents.story_graph:_process_decision:228 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x0000027F231671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.agent_manager:initialize_game:224 - Game initialization completed successfully
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:45:11 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:45:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='2416d142-0007-42b8-923f-55e74bff0ccf' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:process_game_state:151 - Processing game state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | INFO     | managers.agent_manager:get_story_workflow:247 - Getting story workflow
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:45:11 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d6798332-c21a-45c1-8bcb-98a6c2407124
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:11 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd6798332-c21a-45c1-8bcb-98a6c2407124', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:11.047031', 'character_id': 'current'}
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d6798332-c21a-45c1-8bcb-98a6c2407124 and game_id: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d6798332-c21a-45c1-8bcb-98a6c2407124 and section_number: 1
2024-12-30 17:45:11 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:45:11 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:45:11 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:45:11 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:45:11 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:45:11 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:45:11 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:45:11 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:45:11 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:45:11 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:45:11 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:45:11 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_decision:214 - Decision processed: next_section=None
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:45:11 | ERROR    | managers.agent_manager:process_game_state:168 - No valid result from workflow
2024-12-30 17:45:11 | ERROR    | managers.agent_manager:process_game_state:172 - Error processing game state: No valid result
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle Task.task_wakeup()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle Task.task_wakeup()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle Task.task_wakeup()>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\protocols\websockets\wsproto_impl.py", line 235, in run_asgi
    result = await self.app(self.scope, self.receive, self.send)  # type: ignore[func-returns-value]
                   â    â   â    â      â    â        â    â <function WSProtocol.send at 0x0000027F235CB2E0>
                   â    â   â    â      â    â        â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â   â    â      â    â <function WSProtocol.receive at 0x0000027F235CB380>
                   â    â   â    â      â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â   â    â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   â    â   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
                   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                 â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                 â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 â    â <fastapi.applications.FastAPI object at 0x0000027F23087770>
                 â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                           â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                           â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
          â <fastapi.applications.FastAPI object at 0x0000027F23087770>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
          â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â                            â    â    â     â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â    â     â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â    â     â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â    â <starlette.websockets.WebSocket object at 0x0000027F2394D8B0>
          â                            â    â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
          â                            â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027F230805A0>>
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          â     â      â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â     â      â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â     â      â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â     â <function WebSocketRoute.handle at 0x0000027F210BEF20>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
          â    â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <function websocket_session.<locals>.app at 0x0000027F234916C0>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          â                            â    â        â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â                            â    â        â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â        â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â <starlette.websockets.WebSocket object at 0x0000027F2394DB80>
          â                            â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F23904900>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
          â    â <starlette.websockets.WebSocket object at 0x0000027F2394DB80>
          â <function get_websocket_app.<locals>.app at 0x0000027F23491620>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
          â         â      â             â {'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starlette.websockets.WebSocke...
          â         â      â SolvedDependency(values={'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starl...
          â         â <function game_websocket_endpoint at 0x0000027F22C42520>
          â Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "C:\Users\erpes\Desktop\casys-rpg\api\routes\ws\game_route_ws.py", line 137, in game_websocket_endpoint
    new_state = await agent_mgr.process_game_state(
                      â         â <function AgentManager.process_game_state at 0x0000027F22C40540>
                      â <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>

> File "C:\Users\erpes\Desktop\casys-rpg\managers\agent_manager.py", line 169, in process_game_state
    raise GameError("No valid result")
          â <class 'models.errors_model.GameError'>

models.errors_model.GameError: No valid result
2024-12-30 17:45:11 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:42 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:45:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:42 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:319 - Stopping game...
2024-12-30 17:45:42 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:42 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 17, 45, 11, 121106)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:331 - Final game state saved successfully
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:333 - Game stopped successfully
2024-12-30 17:45:42 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:45:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:49 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:45:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:51 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:51 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:51 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:51 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:45:51 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:45:51 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:45:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:57 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 17:45:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:46:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:46:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:46:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:46:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:46:06 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:46:06 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:46:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:46:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:13 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:46:13 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:46:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:46:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:46:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:46:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:46:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:46:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:46:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:46:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:46:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:46:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:46:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:46:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:46:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:46:15 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:46:15 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:46:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:46:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:46:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:46:15 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:15 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:46:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:21 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:46:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:46:21 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:46:21 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:46:21 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\traces
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters
2024-12-30 17:46:21 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 351939d8-7c3e-4290-9157-ab3a94df637a
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '351939d8-7c3e-4290-9157-ab3a94df637a', 'game_id': 'd2a72714-b0cc-4fb0-9212-f05d998797fc', 'last_update': '2024-12-30T17:46:21.861333', 'character_id': 'current'}
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:46:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7c02d248-c6f5-4b43-9e83-30cdb7b51c94', 'game_id': 'd2a72714-b0cc-4fb0-9212-f05d998797fc', 'last_update': '2024-12-30T17:46:21.886950', 'character_id': 'current'}
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94 and game_id: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94 and section_number: 1
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:46:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:46:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:46:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:46:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:46:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:46:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:46:21 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:46:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:46:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:46:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:46:21 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:46:21 | ERROR    | agents.story_graph:_process_decision:228 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1144)
                                      â           â <function spawn_main at 0x000001E9B5FC0860>
                                      â <function spawn_main at 0x000001E9B5FC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 588
               â     â 3
               â <function _main at 0x000001E9B5FC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 588
           â    â <function BaseProcess._bootstrap at 0x000001E9B5F06A20>
           â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000001E9B5F05F80>
    â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000001E9BB4AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
    â    â <function subprocess_started at 0x000001E9BB50A700>
    â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=700, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000001E9BB4AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=700, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000001E9BB5099E0>
           â       â   â <uvicorn.server.Server object at 0x000001E9BB4AF4D0>
           â       â <function run at 0x000001E9B64063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000001E9BB502500>
           â      â <function Runner.run at 0x000001E9B64704A0>
           â <asyncio.runners.Runner object at 0x000001E9BB534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000001E9B6469E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000001E9BB534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000001E9B6469DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000001E9B646BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000001E9B63ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000001E9BB1671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:46:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:46:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:46:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:47:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:47:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:47:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:47:46 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:47:46 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:345 - Final game state saved successfully
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:347 - Game stopped successfully
2024-12-30 17:47:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:47:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:47:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:00 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:48:01 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:48:01 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:48:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:48:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:48:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:48:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:48:01 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:48:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:48:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:48:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:48:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:48:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:48:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:48:02 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:48:02 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:48:02 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:48:02 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:48:20 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:48:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:48:20 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:48:20 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:48:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:48:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:48:26 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:48:26 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:48:26 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:48:26 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:48:26 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:48:26 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:48:26 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:48:26 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:48:26 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:48:26 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:48:26 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:48:26 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:48:26 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:48:27 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:48:27 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:48:27 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:48:27 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:49:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:49:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:37 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:49:37 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:49:37 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:49:37 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:49:37 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:49:37 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:49:37 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\traces
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters
2024-12-30 17:49:37 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 063682be-bbb2-4e32-9e0b-6eed03d145a1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '063682be-bbb2-4e32-9e0b-6eed03d145a1', 'game_id': '9b89bd00-561b-4acd-ad84-c71d18373b94', 'last_update': '2024-12-30T17:49:37.400877', 'character_id': 'current'}
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:49:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b4d56dae-ba0a-4cab-b07c-56ae3c769f48', 'game_id': '9b89bd00-561b-4acd-ad84-c71d18373b94', 'last_update': '2024-12-30T17:49:37.502268', 'character_id': 'current'}
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48 and game_id: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48 and section_number: 1
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:49:37 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:49:37 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:49:37 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:49:37 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:49:37 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:49:37 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:49:37 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:49:37 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:49:37 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:49:37 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:49:37 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 17:49:37 | ERROR    | managers.agent_manager:initialize_game:245 - Error initializing game: catching classes that do not inherit from BaseException is not allowed
2024-12-30 17:49:37 | ERROR    | api.routes.rest.game_route_rest:initialize_game:35 - Failed to initialize game: Failed to initialize game: catching classes that do not inherit from BaseException is not allowed
2024-12-30 17:50:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:50:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:50:54 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:50:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:50:54 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:50:54 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:50:54 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='b4d56dae-ba0a-4cab-b07c-56ae3c769f48' game_id='9b89bd00-561b-4acd-ad84-c71d18373b94' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:345 - Final game state saved successfully
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:347 - Game stopped successfully
2024-12-30 17:50:54 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:50:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:51:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:51:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:51:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:51:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:51:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:51:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:51:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:51:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:51:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:51:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:51:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:51:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:51:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:51:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:51:05 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:51:05 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:51:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:51:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:51:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:51:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:51:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:51:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:51:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:51:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:51:09 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:51:09 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:51:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:51:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:51:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:51:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:51:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:51:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:51:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:51:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:51:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:51:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:51:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:51:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:51:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:51:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:51:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:51:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:51:15 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:51:15 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:51:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:51:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:51:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:51:15 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:51:15 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:53:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:53:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:53:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:53:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:53:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:53:46 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:53:46 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:53:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:53:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:53:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:53:54 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:53:55 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:53:55 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:53:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:53:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:53:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:53:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:53:55 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:53:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:53:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:53:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:53:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:53:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:53:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:53:56 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:53:56 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:53:56 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:53:56 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:53:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:53:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:53:56 | DEBUG    | managers.agent_manager:get_state:212 - Fetching current game state
2024-12-30 17:53:56 | DEBUG    | managers.agent_manager:get_state:214 - Current state: None
2024-12-30 18:02:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:02:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:02:38 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:02:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:02:38 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:02:38 | INFO     | managers.agent_manager:stop_game:353 - Stopping game...
2024-12-30 18:02:38 | DEBUG    | managers.agent_manager:stop_game:358 - No game ID set, nothing to save
2024-12-30 18:02:38 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:02:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:02:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:02:45 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:02:45 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:02:45 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:02:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:02:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:02:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:02:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:02:45 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:02:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:02:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:02:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:02:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:02:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:02:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:02:46 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:02:46 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:02:46 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:02:46 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:02:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:02:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:02:46 | DEBUG    | managers.agent_manager:get_state:212 - Fetching current game state
2024-12-30 18:02:46 | DEBUG    | managers.agent_manager:get_state:214 - Current state: None
2024-12-30 18:04:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:04:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:04:03 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:04:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:04:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:04:03 | INFO     | managers.agent_manager:stop_game:347 - Stopping game...
2024-12-30 18:04:03 | DEBUG    | managers.agent_manager:stop_game:352 - No game ID set, nothing to save
2024-12-30 18:04:03 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:04:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:08 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:04:08 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:04:08 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:04:08 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:04:08 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:04:08 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:04:08 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:04:08 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:04:08 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:04:08 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:04:08 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:04:08 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:04:08 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:04:08 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:04:09 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:04:09 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:04:09 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:04:09 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:04:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:04:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:04:09 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:04:09 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:04:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:04:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:04:45 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:04:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:04:45 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:04:45 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 18:04:45 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 18:04:45 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:04:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:04:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:04:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:04:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:04:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:04:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:04:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:04:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:04:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:04:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:04:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:04:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:04:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:04:50 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:04:50 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:04:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:04:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:04:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:04:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:04:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:05:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:05:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:05:00 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:05:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:05:00 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:05:00 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:05:00 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:05:00 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:05:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:05:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:05:05 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:05:05 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:05:05 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:05:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:05:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:05:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:05:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:05:05 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:05:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:05:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:05:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:05:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:05:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:05:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:05:06 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:05:06 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:05:06 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:05:06 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:05:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:05:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:05:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:05:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:13:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:13:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:13:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:13:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:13:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:13:22 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:13:22 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:13:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:13:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:13:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:13:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:13:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:13:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:13:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:13:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:13:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:13:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:13:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:13:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:13:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:13:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:13:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:13:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:13:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:13:28 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:13:28 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:13:28 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:13:28 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:13:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:13:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:13:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:13:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 18:14:19 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_story_workflow:268 - Story graph not configured, configuring now
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_story_workflow:277 - Compiling workflow
2024-12-30 18:14:19 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:14:19 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 18:14:19 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\traces
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters
2024-12-30 18:14:19 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d8cf9c0e-bead-4686-a78f-46c4ac337286
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd8cf9c0e-bead-4686-a78f-46c4ac337286', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:19.448038', 'character_id': 'current'}
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:19 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd7bc19d8-f56c-44e0-9c6c-503d4f92b734', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:19.480007', 'character_id': 'current'}
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734 and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734 and section_number: 1
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:19 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:19 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:19 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:19 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:19 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:19 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:19 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:14:19 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:19 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:19 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:19 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 18:14:19 | ERROR    | agents.story_graph:_process_decision:221 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1500)
                                      â           â <function spawn_main at 0x00000226FAEC0860>
                                      â <function spawn_main at 0x00000226FAEC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 624
               â     â 3
               â <function _main at 0x00000226FAEC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 624
           â    â <function BaseProcess._bootstrap at 0x00000226FAE06A20>
           â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000226FAE05F80>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000226801AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â <function subprocess_started at 0x000002268060E480>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000226801AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002268060D760>
           â       â   â <uvicorn.server.Server object at 0x00000226801AF4D0>
           â       â <function run at 0x00000226FB3063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000022680602420>
           â      â <function Runner.run at 0x00000226FB3704A0>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000226FB369E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000226FB369DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000226FB36BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000226FB2ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 185, in _process_decision
    return interrupt("Waiting for user input")  # Retourne une interruption au lieu de la lever
           â <function interrupt at 0x00000226800371A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.agent_manager:initialize_game:241 - Game initialization completed successfully
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:14:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:14:22 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:14:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:14:22 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:22 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '280b8954-4230-4b02-9a2d-20fe3b16f81b', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:22.273322', 'character_id': 'current'}
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b and section_number: 1
2024-12-30 18:14:22 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:22 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:22 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:22 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:22 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:22 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:22 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:22 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:22 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:22 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:22 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_decision:188 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:22 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_decision:212 - Decision processed: next_section=None
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:14:22 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 18:14:22 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 18:14:22 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 18:14:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:14:52 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:14:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:14:52 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 18, 14, 22, 328400)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:52 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:52 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 18, 14, 22, 328400)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:52 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ff33e322-9229-4d18-9c0f-bd720ea63262
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:52 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ff33e322-9229-4d18-9c0f-bd720ea63262', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:52.208295', 'character_id': 'current'}
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ff33e322-9229-4d18-9c0f-bd720ea63262 and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:52 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ff33e322-9229-4d18-9c0f-bd720ea63262 and section_number: 1
2024-12-30 18:14:52 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:52 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:52 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:52 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:52 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:52 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:52 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:52 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:52 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:52 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: At key 'decision': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-30 18:14:52 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: At key 'decision': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-30 18:18:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:18:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:18:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:43 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:43 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 18:19:43 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:19:43 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7902c210-2a5a-4d03-a2d8-913e32316317
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:19:43 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7902c210-2a5a-4d03-a2d8-913e32316317', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:19:43.922567', 'character_id': 'current'}
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:43 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:19:43 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 88716c40-b35a-4994-afd1-34ae829e258c
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:19:43 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '88716c40-b35a-4994-afd1-34ae829e258c', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:19:43.981478', 'character_id': 'current'}
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 88716c40-b35a-4994-afd1-34ae829e258c and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 88716c40-b35a-4994-afd1-34ae829e258c and section_number: 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:19:44 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:19:44 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:19:44 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:19:44 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:19:44 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:19:44 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:19:44 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:19:44 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:19:44 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:19:44 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:19:44 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 18:19:44 | ERROR    | agents.story_graph:_process_decision:221 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1500)
                                      â           â <function spawn_main at 0x00000226FAEC0860>
                                      â <function spawn_main at 0x00000226FAEC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 624
               â     â 3
               â <function _main at 0x00000226FAEC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 624
           â    â <function BaseProcess._bootstrap at 0x00000226FAE06A20>
           â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000226FAE05F80>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000226801AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â <function subprocess_started at 0x000002268060E480>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000226801AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002268060D760>
           â       â   â <uvicorn.server.Server object at 0x00000226801AF4D0>
           â       â <function run at 0x00000226FB3063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000022680602420>
           â      â <function Runner.run at 0x00000226FB3704A0>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000226FB369E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000226FB369DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000226FB36BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000226FB2ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 185, in _process_decision
    return interrupt("Waiting for user input")  # Retourne une interruption au lieu de la lever
           â <function interrupt at 0x00000226800371A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:19:44 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.agent_manager:initialize_game:241 - Game initialization completed successfully
2024-12-30 18:19:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:19:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:30:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:30:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:30:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:30:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:30:28 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:30:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:30:28 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:30:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:348 - Final game state saved successfully
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:350 - Game stopped successfully
2024-12-30 18:30:28 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:30:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:30:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:30:35 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:30:36 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:30:36 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:30:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:30:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:30:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:30:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:30:36 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:30:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:30:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:30:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:30:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:30:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:30:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:30:37 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:30:37 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:30:37 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:30:37 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:30:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:31:10 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:31:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:31:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:31:10 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:31:10 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:31:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:31:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:31:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:31:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:31:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:31:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:31:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:31:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:31:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:31:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:31:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:31:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:31:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:31:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:31:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:31:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:31:47 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:31:47 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:31:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:31:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:04 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:04 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:09 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:09 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:09 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:10 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:10 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:10 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:10 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:44 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:44 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:44 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:44 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:44 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:50 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:50 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:53 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:53 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:53 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:53 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:53 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:58 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:59 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:59 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:59 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:59 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:33:58 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:33:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:33:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:33:58 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:33:58 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:33:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:33:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:04 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:34:04 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:34:04 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:34:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:34:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:34:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:34:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:34:04 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:34:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:34:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:34:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:34:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:34:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:34:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:34:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:34:05 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:34:05 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:34:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:34:31 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:34:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:34:31 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:34:31 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:34:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:34:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:38 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:34:38 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:34:38 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:34:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:34:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:34:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:34:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:34:38 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:34:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:34:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:34:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:34:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:34:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:34:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:34:39 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:34:39 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:34:39 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:34:39 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:09 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:09 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:19 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:19 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:19 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:19 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:25 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:25 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:25 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:25 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:26 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:26 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:26 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:26 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:34 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:34 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:34 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:34 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:34 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:39 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:41 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:41 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:02 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:02 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:02 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:37:02 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:37:02 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:11 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:12 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:13 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:13 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:37:13 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:37:13 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:13 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 18:37:13 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 18:37:13 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:13 | INFO     | managers.agent_manager:stop_game:345 - Stopping game...
2024-12-30 18:37:13 | DEBUG    | managers.agent_manager:stop_game:350 - No game ID set, nothing to save
2024-12-30 18:37:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:18 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:19 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:19 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:19 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:37:19 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:37:19 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:32 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:32 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:32 | INFO     | managers.agent_manager:stop_game:345 - Stopping game...
2024-12-30 18:37:32 | DEBUG    | managers.agent_manager:stop_game:350 - No game ID set, nothing to save
2024-12-30 18:37:32 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:37 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:38 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:38 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:37:38 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:37:38 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:40 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:40 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:40 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:40 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:37:40 | DEBUG    | managers.agent_manager:stop_game:353 - No game ID set, nothing to save
2024-12-30 18:37:40 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:44 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:45 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:45 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:45 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:46 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:46 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:37:46 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:37:46 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:59 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:59 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:38:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:38:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:38:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:38:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:38:06 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:38:06 | DEBUG    | managers.agent_manager:stop_game:353 - No game ID set, nothing to save
2024-12-30 18:38:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:38:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:38:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:38:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:38:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:38:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:38:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:38:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:38:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:38:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:38:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:38:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:38:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:38:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:38:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:38:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:38:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:38:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:38:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:38:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:38:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:38:11 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:11 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | INFO     | managers.agent_manager:initialize_game:213 - Initializing game
2024-12-30 18:38:16 | INFO     | managers.agent_manager:get_story_workflow:276 - Getting story workflow
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_story_workflow:280 - Story graph not configured, configuring now
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_story_workflow:289 - Compiling workflow
2024-12-30 18:38:16 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:38:16 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 18:38:16 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\traces
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters
2024-12-30 18:38:16 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8391e3a4-2940-4cbd-a6f8-b1ad21e48bec
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8391e3a4-2940-4cbd-a6f8-b1ad21e48bec', 'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'last_update': '2024-12-30T18:38:16.859672', 'character_id': 'current'}
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:38:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c06b4684-c604-473c-8214-d4a26809e1f4
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c06b4684-c604-473c-8214-d4a26809e1f4', 'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'last_update': '2024-12-30T18:38:16.884661', 'character_id': 'current'}
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: c06b4684-c604-473c-8214-d4a26809e1f4 and game_id: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: c06b4684-c604-473c-8214-d4a26809e1f4 and section_number: 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:38:16 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:38:16 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:38:16 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:38:16 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:38:16 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:38:16 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:38:16 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:38:16 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:38:16 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:38:16 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:38:16 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:5cb1ebd9-b4c5-cda2-65d6-319c49c0330a'], when='during'),)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.agent_manager:initialize_game:252 - Game initialization completed successfully
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:38:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:38:33 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:38:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:38:33 | INFO     | managers.agent_manager:process_game_state:156 - Starting game state processing
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:process_game_state:157 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:process_game_state:165 - No state provided, getting current state
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:33 | INFO     | managers.agent_manager:get_story_workflow:276 - Getting story workflow
2024-12-30 18:38:33 | ERROR    | managers.agent_manager:process_game_state:189 - Error processing game state: Checkpointer requires one or more of the following 'configurable' keys: ['thread_id', 'checkpoint_ns', 'checkpoint_id']
2024-12-30 18:38:33 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Checkpointer requires one or more of the following 'configurable' keys: ['thread_id', 'checkpoint_ns', 'checkpoint_id']
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:45:20 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:45:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:45:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:45:20 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:45:20 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:360 - Final game state saved successfully
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:362 - Game stopped successfully
2024-12-30 18:45:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:45:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:39 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:46:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:44 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:46:44 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:46:44 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:46:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:46:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:46:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:46:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:46:44 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:46:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:46:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:46:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:46:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:46:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:46:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:46:45 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:46:45 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:46:45 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:46:45 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:46:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:47:52 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:47:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:47:52 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:47:52 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:47:52 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:47:52 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:47:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:02 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:02 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:02 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:05 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:05 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:08 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:48:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:48:08 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:48:08 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:48:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:48:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:14 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:14 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:38 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:48:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:38 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:48:38 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:48:38 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:48:38 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:48:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:47 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:47 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:48:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:01 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:49:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:01 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:49:01 | INFO     | managers.agent_manager:stop_game:350 - Stopping game...
2024-12-30 18:49:01 | DEBUG    | managers.agent_manager:stop_game:355 - No game ID set, nothing to save
2024-12-30 18:49:01 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:49:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:21 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:49:21 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:49:21 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:49:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:49:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:49:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:49:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:49:21 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:49:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:49:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:49:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:49:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:49:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:49:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:49:22 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:49:22 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:49:22 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:49:22 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:49 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:49 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:50:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:50:00 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:00 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:50:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:02 | INFO     | managers.agent_manager:initialize_game:215 - Initializing game
2024-12-30 18:50:02 | INFO     | managers.agent_manager:get_story_workflow:282 - Getting story workflow
2024-12-30 18:50:02 | DEBUG    | managers.agent_manager:get_story_workflow:286 - Story graph not configured, configuring now
2024-12-30 18:50:02 | DEBUG    | managers.agent_manager:get_story_workflow:295 - Compiling workflow
2024-12-30 18:50:02 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:50:02 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 18:50:02 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\traces
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters
2024-12-30 18:50:02 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8bccb1e2-43b7-465a-86f6-d79aadaa144a
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8bccb1e2-43b7-465a-86f6-d79aadaa144a', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:02.850849', 'character_id': 'current'}
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:50:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:02.908344', 'character_id': 'current'}
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b and game_id: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b and section_number: 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:50:02 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:50:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:50:02 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:50:02 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:50:02 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:50:02 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:50:02 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:50:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:50:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:50:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:50:02 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:e818c01d-b8cc-5bd4-24d7-77780b20397e'], when='during'),)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:03 | INFO     | managers.agent_manager:initialize_game:254 - Game initialization completed successfully
2024-12-30 18:50:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:50:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:50:13 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='06e586a5-7eee-411b-8909-532f848b3537' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:50:13 | INFO     | managers.agent_manager:process_game_state:145 - Starting game state processing
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:process_game_state:154 - No state provided, getting current state
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:13 | INFO     | managers.agent_manager:get_story_workflow:282 - Getting story workflow
2024-12-30 18:50:13 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:50:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8800558d-ee70-44c6-87be-8e4dda7b352d', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:13.281916', 'character_id': 'current'}
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d and game_id: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:13 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d and section_number: 1
2024-12-30 18:50:13 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: 2 validation errors for GameState
session_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
game_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2024-12-30 18:50:13 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: 2 validation errors for GameState
session_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
game_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:51:27 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:51:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:27 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:354 - Stopping game...
2024-12-30 18:51:27 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:51:27 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8800558d-ee70-44c6-87be-8e4dda7b352d' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:366 - Final game state saved successfully
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:368 - Game stopped successfully
2024-12-30 18:51:27 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:51:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:38 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:51:38 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:51:38 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:51:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:51:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:51:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:51:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:51:38 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:51:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:51:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:51:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:51:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:51:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:51:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:51:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:51:41 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:51:41 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:51:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:51:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:41 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 18:51:41 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 18:51:41 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:51:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:41 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:51:41 | INFO     | managers.agent_manager:stop_game:354 - Stopping game...
2024-12-30 18:51:41 | DEBUG    | managers.agent_manager:stop_game:359 - No game ID set, nothing to save
2024-12-30 18:51:41 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:51:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:47 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:51:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:51:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:51:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:51:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:51:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:51:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:51:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:51:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:51:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:51:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:51:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:51:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:51:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:51:49 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:51:49 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:51:49 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:51:49 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:51:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:34 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:58:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:34 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:58:34 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 18:58:34 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 18:58:34 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:58:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:40 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:58:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:58:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:58:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:58:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:58:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:58:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:58:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:58:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:58:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:58:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:58:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:58:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:58:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:58:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:58:41 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:58:41 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:58:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:58:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:58:47 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 18:58:47 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 18:58:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:58:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:58:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:58:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:58:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:58:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:58:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:58:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:58:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:58:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:58:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:58:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:58:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:58:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:58:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:58:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:58:51 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:58:51 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:58:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:01:18 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:01:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:01:18 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:01:18 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 19:01:18 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 19:01:18 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:01:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:01:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:01:28 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:01:28 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:01:28 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:01:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:01:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:01:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:01:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:01:28 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:01:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:01:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:01:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:01:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:01:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:01:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:01:30 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:01:30 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:01:30 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:01:30 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:01:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:04:24 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:04:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:04:24 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:04:24 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 19:04:24 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 19:04:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:04:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:04:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:04:36 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:04:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:04:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:04:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:04:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:04:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:04:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:04:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:04:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:04:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:04:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:04:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:04:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:04:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:04:39 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:04:39 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:04:39 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:04:39 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:04:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:37 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:06:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:37 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:06:37 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 19:06:37 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 19:06:37 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:06:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:06:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:06:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:06:49 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:06:49 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:06:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:06:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:06:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:06:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:06:49 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:06:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:06:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:06:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:06:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:06:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:06:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:06:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:06:51 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:06:51 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:06:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:06:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:06:52 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:52 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:06:52 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:52 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:06:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:54 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:06:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:06:55 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:06:55 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:07:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:07:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:07:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:07:06 | INFO     | managers.agent_manager:initialize_game:227 - Initializing game
2024-12-30 19:07:06 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_story_workflow:298 - Story graph not configured, configuring now
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_story_workflow:307 - Compiling workflow
2024-12-30 19:07:06 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 19:07:06 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 19:07:06 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 19:07:06 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 788ed749-8c7e-4605-b3bb-123ba9cdfd71
2024-12-30 19:07:06 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 788ed749-8c7e-4605-b3bb-123ba9cdfd71
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\traces
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters
2024-12-30 19:07:06 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 788ed749-8c7e-4605-b3bb-123ba9cdfd71
2024-12-30 19:07:06 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 15e65e90-7da9-4791-b355-29958ad78750
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:07:06 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '15e65e90-7da9-4791-b355-29958ad78750', 'game_id': '788ed749-8c7e-4605-b3bb-123ba9cdfd71', 'last_update': '2024-12-30T19:07:06.396228', 'character_id': 'current'}
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:06 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 19:07:06 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:07:06 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 19:07:06 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 19:07:06 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ff37f191-49fd-4a08-9e95-d0a535586f3b
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:07:06 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ff37f191-49fd-4a08-9e95-d0a535586f3b', 'game_id': '788ed749-8c7e-4605-b3bb-123ba9cdfd71', 'last_update': '2024-12-30T19:07:06.455807', 'character_id': 'current'}
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:06 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ff37f191-49fd-4a08-9e95-d0a535586f3b and game_id: 788ed749-8c7e-4605-b3bb-123ba9cdfd71
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:06 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ff37f191-49fd-4a08-9e95-d0a535586f3b and section_number: 1
2024-12-30 19:07:06 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 19:07:06 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 19:07:06 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 19:07:06 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 19:07:06 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 19:07:06 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 19:07:06 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 19:07:06 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 19:07:06 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 19:07:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 19:07:06 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 19:07:06 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 19:07:06 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 19:07:06 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 19:07:06 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 19:07:06 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 19:07:06 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 19:07:06 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 19:07:06 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 19:07:06 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 19:07:06 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 19:07:06 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:f55c105f-ae43-81bd-2910-18f6ac3f562c'], when='during'),)
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:06 | INFO     | managers.agent_manager:initialize_game:266 - Game initialization completed successfully
2024-12-30 19:07:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:07:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:07:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 7, 6, 551577), last_update=datetime.datetime(2024, 12, 30, 19, 7, 6, 551616)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:07:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:07:06 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 7, 6, 551577), last_update=datetime.datetime(2024, 12, 30, 19, 7, 6, 551616)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:07:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 19:07:15 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '788ed749-8c7e-4605-b3bb-123ba9cdfd71', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 19:07:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 19:07:15 | INFO     | managers.agent_manager:process_game_state:148 - Starting game state processing
2024-12-30 19:07:15 | DEBUG    | managers.agent_manager:process_game_state:157 - No state provided, getting current state
2024-12-30 19:07:15 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:07:15 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 7, 6, 551577), last_update=datetime.datetime(2024, 12, 30, 19, 7, 6, 551616)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:07:15 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 19:07:15 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 19:07:15 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 7, 6, 551577), last_update=datetime.datetime(2024, 12, 30, 19, 7, 6, 551616)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 19:07:15 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 19:07:15 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 19:07:15 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 021b1fba-5e78-4053-9067-bb598c6c81f6
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\characters\current.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:07:15 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '021b1fba-5e78-4053-9067-bb598c6c81f6', 'game_id': '788ed749-8c7e-4605-b3bb-123ba9cdfd71', 'last_update': '2024-12-30T19:07:15.657496', 'character_id': 'current'}
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:15 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 021b1fba-5e78-4053-9067-bb598c6c81f6 and game_id: 788ed749-8c7e-4605-b3bb-123ba9cdfd71
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:15 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 021b1fba-5e78-4053-9067-bb598c6c81f6 and section_number: 1
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:07:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:07:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:07:15 | INFO     | managers.agent_manager:process_game_state:186 - Game state processed successfully
2024-12-30 19:07:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 19:07:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:07:56 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:07:56 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:08:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:08:17 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:08:17 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:09:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:09:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:09:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:09:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:09:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:09:11 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 19:09:11 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:09:11 | DEBUG    | managers.agent_manager:get_state:211 - Current state: session_id='15e65e90-7da9-4791-b355-29958ad78750' game_id='788ed749-8c7e-4605-b3bb-123ba9cdfd71' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current in namespace state
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:09:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:09:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current.json
2024-12-30 19:09:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_current
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1 in namespace state
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:09:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:09:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:09:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\788ed749-8c7e-4605-b3bb-123ba9cdfd71\states\game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1.json
2024-12-30 19:09:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_788ed749-8c7e-4605-b3bb-123ba9cdfd71_section_1
2024-12-30 19:09:11 | INFO     | managers.agent_manager:stop_game:378 - Final game state saved successfully
2024-12-30 19:09:11 | INFO     | managers.agent_manager:stop_game:380 - Game stopped successfully
2024-12-30 19:09:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:09:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:09:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:09:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:10:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:10:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:10:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:11:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:11:01 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:11:01 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:11:01 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:11:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:11:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:11:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:11:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:01 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:11:01 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:11:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:11:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:11:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:11:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:11:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:11:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:11:03 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:11:03 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:11:03 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:11:03 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:11:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:11:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:11:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:11:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:11:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:11:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:11:09 | ERROR    | api.app:shutdown_event:65 - Failed to shutdown API: 'AgentManager' object has no attribute 'stop_game'
2024-12-30 19:11:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:11:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:11:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:11:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:11:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:11:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:11:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:11:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:11:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:11:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:11:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:11:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:11:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:11:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:11:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:11:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:11:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:11:23 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:11:23 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:11:23 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:11:23 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:11:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:11:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:11:23 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:23 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:11:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:11:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:11:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:11:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:11:27 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:27 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 19:11:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:30 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 19:11:30 | INFO     | managers.agent_manager:get_story_workflow:291 - Getting story workflow
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_story_workflow:295 - Story graph not configured, configuring now
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Compiling workflow
2024-12-30 19:11:30 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 19:11:30 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 19:11:30 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 19:11:30 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512
2024-12-30 19:11:30 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\traces
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters
2024-12-30 19:11:30 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512
2024-12-30 19:11:30 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 14a24c21-6909-42d8-aea5-b846e3b50acb
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:11:30 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '14a24c21-6909-42d8-aea5-b846e3b50acb', 'game_id': 'dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512', 'last_update': '2024-12-30T19:11:30.237180', 'character_id': 'current'}
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:30 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 19:11:30 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:11:30 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 19:11:30 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 19:11:30 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ecc751b0-2ac1-48e8-92e2-e2068c440427
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:11:30 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ecc751b0-2ac1-48e8-92e2-e2068c440427', 'game_id': 'dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512', 'last_update': '2024-12-30T19:11:30.292271', 'character_id': 'current'}
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:30 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ecc751b0-2ac1-48e8-92e2-e2068c440427 and game_id: dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:30 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ecc751b0-2ac1-48e8-92e2-e2068c440427 and section_number: 1
2024-12-30 19:11:30 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 19:11:30 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 19:11:30 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 19:11:30 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 19:11:30 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 19:11:30 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 19:11:30 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 19:11:30 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 19:11:30 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 19:11:30 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 19:11:30 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 19:11:30 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 19:11:30 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 19:11:30 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 19:11:30 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 19:11:30 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 19:11:30 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 19:11:30 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 19:11:30 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 19:11:30 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 19:11:30 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 19:11:30 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:03df5b8c-b716-b913-3fe8-a37b97f5a185'], when='during'),)
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:30 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 19:11:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:11:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='14a24c21-6909-42d8-aea5-b846e3b50acb' game_id='dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 11, 30, 373498), last_update=datetime.datetime(2024, 12, 30, 19, 11, 30, 373540)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:11:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='14a24c21-6909-42d8-aea5-b846e3b50acb' game_id='dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 11, 30, 373498), last_update=datetime.datetime(2024, 12, 30, 19, 11, 30, 373540)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:11:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 19:11:37 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512', 'choice_id': '398', 'choice_text': 'Continuer votre route', 'metadata': {'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 19:11:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512' choice_id='398' choice_text='Continuer votre route' metadata={'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 19:11:37 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 19:11:37 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 19:11:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 19:11:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='14a24c21-6909-42d8-aea5-b846e3b50acb' game_id='dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 11, 30, 373498), last_update=datetime.datetime(2024, 12, 30, 19, 11, 30, 373540)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 19:11:37 | INFO     | managers.agent_manager:get_story_workflow:291 - Getting story workflow
2024-12-30 19:11:37 | DEBUG    | managers.agent_manager:process_game_state:246 - Thread config: {'configurable': {'thread_id': '14a24c21-6909-42d8-aea5-b846e3b50acb'}}
2024-12-30 19:11:37 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 19:11:37 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 19, 11, 30, 373498), last_update=datetime.datetime(2024, 12, 30, 19, 11, 30, 373540)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input='Continuer votre route' content=None
2024-12-30 19:11:37 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 19:11:37 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 19:11:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 19bc809f-3f39-4d85-801e-f084d02bf72e
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\characters\current.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 19:11:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '19bc809f-3f39-4d85-801e-f084d02bf72e', 'game_id': 'dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512', 'last_update': '2024-12-30T19:11:37.894181', 'character_id': 'current'}
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:37 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 19bc809f-3f39-4d85-801e-f084d02bf72e and game_id: dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:37 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 19bc809f-3f39-4d85-801e-f084d02bf72e and section_number: 1
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_current
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1 in namespace state
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 19:11:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512\states\game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1.json
2024-12-30 19:11:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_dddf47fc-83e6-4cc0-ad44-8f8c7b6c5512_section_1
2024-12-30 19:11:37 | INFO     | managers.agent_manager:process_game_state:261 - Game state processed successfully
2024-12-30 19:11:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 21:34:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:34:06 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 21:34:06 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 21:34:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 21:34:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 21:34:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 21:34:06 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 21:34:06 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 21:34:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:34:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:34:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:35:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:35:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:35:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:35:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:35:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:35:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:35:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:35:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:35:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:35:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:35:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:35:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:35:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:35:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:35:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:35:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:35:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:35:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:35:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:35:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:35:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:35:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:35:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:35:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:35:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:35:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:35:43 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:35:43 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:35:43 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:35:43 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:35:43 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:35:43 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:35:43 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:35:43 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:35:43 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:35:43 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:35:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:35:43 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 21:35:43 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 21:35:43 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:35:43 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:35:43 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:35:43 | INFO     | managers.agent_manager:stop_game:363 - Stopping game...
2024-12-30 21:35:43 | DEBUG    | managers.agent_manager:stop_game:368 - No game ID set, nothing to save
2024-12-30 21:35:43 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:35:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:35:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:35:49 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:35:49 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:35:49 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:35:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:35:49 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:35:49 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:35:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:35:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:35:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:35:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:35:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:35:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:35:49 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:35:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:35:49 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:35:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:35:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:35:49 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:35:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:35:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:35:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:35:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:35:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:35:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:35:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:35:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:35:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:35:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:35:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:35:50 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:35:50 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:35:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:35:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:35:50 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:35:50 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:35:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:35:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:35:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:35:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:35:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:35:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:35:51 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:35:51 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:36:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:36:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:36:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:36:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:36:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:36:47 | INFO     | managers.agent_manager:stop_game:356 - Stopping game...
2024-12-30 21:36:47 | DEBUG    | managers.agent_manager:stop_game:361 - No game ID set, nothing to save
2024-12-30 21:36:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:36:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:36:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:36:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:36:51 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:36:51 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:36:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:36:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:36:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:36:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:36:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:36:51 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:36:51 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:36:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:36:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:36:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:36:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:36:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:36:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:36:52 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:36:52 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:36:52 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:36:52 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:36:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:36:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:36:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:36:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:36:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:36:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:36:59 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:36:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:36:59 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:36:59 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:36:59 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:36:59 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:37:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:37:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:37:03 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:37:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:37:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:37:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:37:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:37:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:37:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:37:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:37:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:37:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:37:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:37:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:37:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:37:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:37:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:37:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:37:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:37:04 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:37:04 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:37:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:37:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:37:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:37:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:37:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:37:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:37:10 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 21:37:10 | INFO     | managers.agent_manager:get_story_workflow:288 - Getting story workflow
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_story_workflow:292 - Story graph not configured, configuring now
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_story_workflow:301 - Compiling workflow
2024-12-30 21:37:10 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 21:37:10 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 21:37:10 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 21:37:10 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: d3317d86-ef21-4aaa-891b-3881dc1d2a43
2024-12-30 21:37:10 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d3317d86-ef21-4aaa-891b-3881dc1d2a43
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\traces
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters
2024-12-30 21:37:10 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: d3317d86-ef21-4aaa-891b-3881dc1d2a43
2024-12-30 21:37:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a4af8dcb-34a8-49e8-af27-e496ffdf642f
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:37:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a4af8dcb-34a8-49e8-af27-e496ffdf642f', 'game_id': 'd3317d86-ef21-4aaa-891b-3881dc1d2a43', 'last_update': '2024-12-30T21:37:10.410068', 'character_id': 'current'}
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:10 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:37:10 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:37:10 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:37:10 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:37:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9543c229-884c-41b1-8f5a-a60d6035e988
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:37:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9543c229-884c-41b1-8f5a-a60d6035e988', 'game_id': 'd3317d86-ef21-4aaa-891b-3881dc1d2a43', 'last_update': '2024-12-30T21:37:10.444558', 'character_id': 'current'}
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:10 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 9543c229-884c-41b1-8f5a-a60d6035e988 and game_id: d3317d86-ef21-4aaa-891b-3881dc1d2a43
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:10 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 9543c229-884c-41b1-8f5a-a60d6035e988 and section_number: 1
2024-12-30 21:37:10 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 21:37:10 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 21:37:10 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 21:37:10 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:37:10 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 21:37:10 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 21:37:10 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 21:37:10 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 21:37:10 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 21:37:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 21:37:10 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 21:37:10 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 21:37:10 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 21:37:10 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 21:37:10 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 21:37:10 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 21:37:10 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 21:37:10 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 21:37:10 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 21:37:10 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 21:37:10 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 21:37:10 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:23a3f998-61c1-4dd0-6375-db1d436bc410'], when='during'),)
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:10 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 21:37:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a4af8dcb-34a8-49e8-af27-e496ffdf642f' game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:37:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:37:10 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a4af8dcb-34a8-49e8-af27-e496ffdf642f' game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:37:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 21:37:13 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'd3317d86-ef21-4aaa-891b-3881dc1d2a43', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 21:37:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 21:37:13 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 21:37:13 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 21:37:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:37:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a4af8dcb-34a8-49e8-af27-e496ffdf642f' game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:37:13 | INFO     | managers.agent_manager:get_story_workflow:288 - Getting story workflow
2024-12-30 21:37:13 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:37:13 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 21:37:13 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:37:13 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:37:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fb9ffa0e-8de0-4ebe-b058-86f8d199d465
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\characters\current.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:37:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fb9ffa0e-8de0-4ebe-b058-86f8d199d465', 'game_id': 'd3317d86-ef21-4aaa-891b-3881dc1d2a43', 'last_update': '2024-12-30T21:37:13.298515', 'character_id': 'current'}
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:13 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fb9ffa0e-8de0-4ebe-b058-86f8d199d465 and game_id: d3317d86-ef21-4aaa-891b-3881dc1d2a43
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:13 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fb9ffa0e-8de0-4ebe-b058-86f8d199d465 and section_number: 1
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:37:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:37:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:37:13 | INFO     | managers.agent_manager:process_game_state:257 - Game state processed successfully
2024-12-30 21:37:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 21:39:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:39:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:39:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a4af8dcb-34a8-49e8-af27-e496ffdf642f' game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:47:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:47:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:47:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:47:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:47:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:47:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:47:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:47:06 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:47:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:47:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a4af8dcb-34a8-49e8-af27-e496ffdf642f' game_id='d3317d86-ef21-4aaa-891b-3881dc1d2a43' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 37, 10, 492932), last_update=datetime.datetime(2024, 12, 30, 21, 37, 10, 492965)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:47:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current in namespace state
2024-12-30 21:47:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:47:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:47:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:47:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:47:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current.json
2024-12-30 21:47:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_current
2024-12-30 21:47:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1 in namespace state
2024-12-30 21:47:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:47:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:47:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:47:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:47:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d3317d86-ef21-4aaa-891b-3881dc1d2a43\states\game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1.json
2024-12-30 21:47:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d3317d86-ef21-4aaa-891b-3881dc1d2a43_section_1
2024-12-30 21:47:07 | INFO     | managers.agent_manager:stop_game:372 - Final game state saved successfully
2024-12-30 21:47:07 | INFO     | managers.agent_manager:stop_game:374 - Game stopped successfully
2024-12-30 21:47:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:47:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:12 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:47:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:47:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:47:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:47:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:47:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:47:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:47:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:47:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:47:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:47:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:47:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:47:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:47:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:47:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:47:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:47:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:47:14 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:47:14 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:47:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:47:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:47:14 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 21:47:14 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 21:47:14 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:47:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:47:14 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:47:14 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:47:14 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:47:14 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:47:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:18 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:47:18 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:47:18 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:47:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:47:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:47:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:47:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:18 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:47:18 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:47:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:47:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:47:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:47:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:47:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:47:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:47:19 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:47:19 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:47:19 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:47:19 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:47:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:47:19 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 21:47:19 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 21:47:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:47:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:47:19 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:47:19 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:47:19 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:47:19 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:47:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:47:23 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:47:23 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:47:23 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:47:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:47:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:47:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:47:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:47:23 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:47:23 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:47:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:47:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:47:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:47:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:47:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:47:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:47:24 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:47:24 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:47:24 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:47:24 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:47:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:47:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:47:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:47:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:47:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:47:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:47:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:47:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:47:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:48:56 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:48:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:48:56 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:48:56 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:48:56 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:48:56 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:48:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:49:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:49:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:49:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:49:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:49:08 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:49:08 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:49:08 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:49:08 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:49:08 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:49:08 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:49:08 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:49:08 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:49:08 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:49:08 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:49:08 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:49:08 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:49:08 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:49:08 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:49:08 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:49:08 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:49:09 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:49:09 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:49:09 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:49:09 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:49:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:49:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:49:09 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:49:09 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:49:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:49:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:49:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:49:09 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:49:09 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:51:27 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:51:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:51:27 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:51:27 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:51:27 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:51:27 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:51:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:51:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:51:31 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:51:31 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:51:31 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:51:31 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:51:31 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:51:31 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:51:31 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:51:31 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:51:31 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:51:31 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:51:31 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:51:31 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:51:31 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:51:31 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:51:31 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:51:31 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:51:32 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:51:32 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:51:32 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:51:32 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:51:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:51:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:51:32 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:51:32 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:51:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:51:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:51:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:51:32 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:51:32 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:52:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:52:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:52:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:52:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:52:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:52:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:52:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:52:11 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:52:11 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:52:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:52:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:52:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:52:15 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:52:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:52:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:52:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:52:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:52:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:52:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:52:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:52:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:52:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:52:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:52:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:52:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:52:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:52:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:52:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:52:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:52:17 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:52:17 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:52:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:52:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:52:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:52:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:52:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:52:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:52:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:52:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:52:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:52:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:53:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:53:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:53:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:53:11 | INFO     | managers.agent_manager:stop_game:356 - Stopping game...
2024-12-30 21:53:11 | DEBUG    | managers.agent_manager:stop_game:361 - No game ID set, nothing to save
2024-12-30 21:53:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:53:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:53:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:53:15 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:53:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:53:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:53:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:53:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:53:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:53:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:53:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:53:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:53:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:53:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:53:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:53:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:53:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:53:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:53:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:53:16 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:53:16 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:53:16 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:53:16 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:53:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:53:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:53:16 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:53:16 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:53:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:53:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:53:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:53:16 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:53:16 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:54:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:54:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:54:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:54:02 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:54:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:02 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:54:02 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:54:02 | DEBUG    | managers.agent_manager:stop_game:365 - No game ID set, nothing to save
2024-12-30 21:54:02 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:54:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:54:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:54:05 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:54:05 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:54:05 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:54:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:54:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:54:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:54:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:54:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:54:05 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:54:05 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:54:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:54:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:54:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:54:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:54:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:54:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:54:06 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:54:06 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:54:06 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:54:06 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:54:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:54:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:54:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:54:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:54:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:54:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:54:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:54:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:54:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:54:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:54:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:54:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:54:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:54:16 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:16 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:54:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:17 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 21:54:17 | INFO     | managers.agent_manager:get_story_workflow:288 - Getting story workflow
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_story_workflow:292 - Story graph not configured, configuring now
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_story_workflow:301 - Compiling workflow
2024-12-30 21:54:17 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 21:54:17 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 21:54:17 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 21:54:17 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 4c822a83-ace1-40b9-88cc-b25559e008ac
2024-12-30 21:54:17 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 4c822a83-ace1-40b9-88cc-b25559e008ac
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\traces
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters
2024-12-30 21:54:17 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 4c822a83-ace1-40b9-88cc-b25559e008ac
2024-12-30 21:54:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9eb88bc0-ce8d-4fea-a404-4c05e187fd37
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:54:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9eb88bc0-ce8d-4fea-a404-4c05e187fd37', 'game_id': '4c822a83-ace1-40b9-88cc-b25559e008ac', 'last_update': '2024-12-30T21:54:17.444777', 'character_id': 'current'}
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:17 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:54:17 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:54:17 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:54:17 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:54:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 891d4ff6-d010-4623-ba36-1ae77b45184e
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:54:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '891d4ff6-d010-4623-ba36-1ae77b45184e', 'game_id': '4c822a83-ace1-40b9-88cc-b25559e008ac', 'last_update': '2024-12-30T21:54:17.498150', 'character_id': 'current'}
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:17 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 891d4ff6-d010-4623-ba36-1ae77b45184e and game_id: 4c822a83-ace1-40b9-88cc-b25559e008ac
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:17 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 891d4ff6-d010-4623-ba36-1ae77b45184e and section_number: 1
2024-12-30 21:54:17 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 21:54:17 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 21:54:17 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 21:54:17 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:54:17 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 21:54:17 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 21:54:17 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 21:54:17 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 21:54:17 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 21:54:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 21:54:17 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 21:54:17 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 21:54:17 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 21:54:17 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 21:54:17 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 21:54:17 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 21:54:17 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 21:54:17 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 21:54:17 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 21:54:17 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 21:54:17 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 21:54:17 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:d4534f85-ee73-259c-c03a-afe954a7271b'], when='during'),)
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:17 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 21:54:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:54:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9eb88bc0-ce8d-4fea-a404-4c05e187fd37' game_id='4c822a83-ace1-40b9-88cc-b25559e008ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 54, 17, 617648), last_update=datetime.datetime(2024, 12, 30, 21, 54, 17, 617883)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:54:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9eb88bc0-ce8d-4fea-a404-4c05e187fd37' game_id='4c822a83-ace1-40b9-88cc-b25559e008ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 54, 17, 617648), last_update=datetime.datetime(2024, 12, 30, 21, 54, 17, 617883)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:54:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 21:54:20 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '4c822a83-ace1-40b9-88cc-b25559e008ac', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 21:54:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='4c822a83-ace1-40b9-88cc-b25559e008ac' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 21:54:20 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 21:54:20 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 21:54:20 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:54:20 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9eb88bc0-ce8d-4fea-a404-4c05e187fd37' game_id='4c822a83-ace1-40b9-88cc-b25559e008ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 54, 17, 617648), last_update=datetime.datetime(2024, 12, 30, 21, 54, 17, 617883)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:54:20 | INFO     | managers.agent_manager:get_story_workflow:288 - Getting story workflow
2024-12-30 21:54:20 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:54:20 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 54, 17, 617648), last_update=datetime.datetime(2024, 12, 30, 21, 54, 17, 617883)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 21:54:20 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:54:20 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:54:20 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1290d414-9e51-4af3-8bb1-43a8cc8c177a
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\characters\current.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:54:20 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1290d414-9e51-4af3-8bb1-43a8cc8c177a', 'game_id': '4c822a83-ace1-40b9-88cc-b25559e008ac', 'last_update': '2024-12-30T21:54:20.108595', 'character_id': 'current'}
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:20 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 1290d414-9e51-4af3-8bb1-43a8cc8c177a and game_id: 4c822a83-ace1-40b9-88cc-b25559e008ac
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:20 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 1290d414-9e51-4af3-8bb1-43a8cc8c177a and section_number: 1
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:54:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:54:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:54:20 | INFO     | managers.agent_manager:process_game_state:257 - Game state processed successfully
2024-12-30 21:54:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 21:58:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:58:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:58:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:58:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:58:36 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:58:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:58:36 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:58:36 | INFO     | managers.agent_manager:stop_game:360 - Stopping game...
2024-12-30 21:58:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:58:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9eb88bc0-ce8d-4fea-a404-4c05e187fd37' game_id='4c822a83-ace1-40b9-88cc-b25559e008ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 54, 17, 617648), last_update=datetime.datetime(2024, 12, 30, 21, 54, 17, 617883)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_current in namespace state
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:58:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:58:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_current.json
2024-12-30 21:58:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_current
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1 in namespace state
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:58:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:58:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:58:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\4c822a83-ace1-40b9-88cc-b25559e008ac\states\game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1.json
2024-12-30 21:58:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_4c822a83-ace1-40b9-88cc-b25559e008ac_section_1
2024-12-30 21:58:36 | INFO     | managers.agent_manager:stop_game:372 - Final game state saved successfully
2024-12-30 21:58:36 | INFO     | managers.agent_manager:stop_game:374 - Game stopped successfully
2024-12-30 21:58:36 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:58:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:58:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:58:42 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:58:42 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:58:42 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:58:42 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:58:42 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:58:42 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:58:42 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:58:42 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:58:42 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:58:42 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:58:42 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:58:42 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:58:42 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:58:42 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:58:42 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:58:42 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:58:43 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:58:43 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:58:43 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:58:43 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:58:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:58:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:58:44 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:58:44 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:58:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:58:44 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:58:44 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:58:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:58:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:58:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:58:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:58:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 21:58:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:58:55 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 21:58:55 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 21:58:55 | DEBUG    | managers.agent_manager:stop_game:369 - No game ID set, nothing to save
2024-12-30 21:58:55 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 21:58:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:59:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 21:59:00 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 21:59:00 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 21:59:00 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 21:59:00 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 21:59:00 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:59:00 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 21:59:00 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 21:59:00 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 21:59:00 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 21:59:00 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 21:59:00 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 21:59:00 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 21:59:00 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 21:59:00 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 21:59:00 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 21:59:00 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 21:59:01 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 21:59:01 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 21:59:01 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 21:59:01 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 21:59:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:59:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:59:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:59:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:59:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:59:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:59:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:59:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:59:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:59:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:33 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 21:59:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 21:59:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:59:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 21:59:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:34 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 21:59:34 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_story_workflow:296 - Story graph not configured, configuring now
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_story_workflow:305 - Compiling workflow
2024-12-30 21:59:34 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 21:59:34 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 21:59:34 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 21:59:34 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 21:59:34 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\traces
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters
2024-12-30 21:59:34 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 21:59:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 01209256-6ff9-4cd7-907b-40ce5ec49e9f
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:59:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '01209256-6ff9-4cd7-907b-40ce5ec49e9f', 'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'last_update': '2024-12-30T21:59:34.767336', 'character_id': 'current'}
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:34 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:59:34 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:59:34 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:59:34 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:59:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 4fe9b246-3c2d-4d06-aa47-5c6f01100872
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:59:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '4fe9b246-3c2d-4d06-aa47-5c6f01100872', 'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'last_update': '2024-12-30T21:59:34.798241', 'character_id': 'current'}
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:34 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 4fe9b246-3c2d-4d06-aa47-5c6f01100872 and game_id: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:34 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 4fe9b246-3c2d-4d06-aa47-5c6f01100872 and section_number: 1
2024-12-30 21:59:34 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 21:59:34 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 21:59:34 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 21:59:34 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 21:59:34 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 21:59:34 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 21:59:34 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 21:59:34 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 21:59:34 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 21:59:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 21:59:34 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 21:59:34 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 21:59:34 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 21:59:34 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 21:59:34 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 21:59:34 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 21:59:34 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 21:59:34 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 21:59:34 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 21:59:34 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 21:59:34 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 21:59:34 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:f26d8712-5526-eae1-af91-fd819b366656'], when='during'),)
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:34 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 21:59:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 21:59:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='01209256-6ff9-4cd7-907b-40ce5ec49e9f' game_id='7a26723b-281c-4af4-b823-edc672ff1a18' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:59:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:34 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='01209256-6ff9-4cd7-907b-40ce5ec49e9f' game_id='7a26723b-281c-4af4-b823-edc672ff1a18' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 21:59:36 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 21:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='7a26723b-281c-4af4-b823-edc672ff1a18' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 21:59:36 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 21:59:36 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 21:59:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 21:59:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='01209256-6ff9-4cd7-907b-40ce5ec49e9f' game_id='7a26723b-281c-4af4-b823-edc672ff1a18' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 21:59:36 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 21:59:36 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 21:59:36 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 21:59:36 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 21:59:36 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 21:59:36 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fac81b15-b171-4a6d-9e6d-6531930f983d
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 21:59:36 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fac81b15-b171-4a6d-9e6d-6531930f983d', 'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'last_update': '2024-12-30T21:59:36.880205', 'character_id': 'current'}
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:36 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fac81b15-b171-4a6d-9e6d-6531930f983d and game_id: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:36 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fac81b15-b171-4a6d-9e6d-6531930f983d and section_number: 1
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 21:59:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 21:59:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 21:59:36 | INFO     | managers.agent_manager:process_game_state:261 - Game state processed successfully
2024-12-30 21:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:00:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:00:31 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:00:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='7a26723b-281c-4af4-b823-edc672ff1a18' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:00:31 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:00:31 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:00:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:00:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='01209256-6ff9-4cd7-907b-40ce5ec49e9f' game_id='7a26723b-281c-4af4-b823-edc672ff1a18' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:00:31 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 22:00:31 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:00:31 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:00:31 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:00:31 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:00:31 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d2129d0d-c32f-4a8f-b679-8cce492642e2
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\characters\current.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:00:31 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd2129d0d-c32f-4a8f-b679-8cce492642e2', 'game_id': '7a26723b-281c-4af4-b823-edc672ff1a18', 'last_update': '2024-12-30T22:00:31.136426', 'character_id': 'current'}
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 22:00:31 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d2129d0d-c32f-4a8f-b679-8cce492642e2 and game_id: 7a26723b-281c-4af4-b823-edc672ff1a18
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 22:00:31 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d2129d0d-c32f-4a8f-b679-8cce492642e2 and section_number: 1
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:00:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:00:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 22:00:31 | INFO     | managers.agent_manager:process_game_state:261 - Game state processed successfully
2024-12-30 22:00:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:05:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:05:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:05:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:05:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:05:30 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:05:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:05:30 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:05:30 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:05:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:05:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='01209256-6ff9-4cd7-907b-40ce5ec49e9f' game_id='7a26723b-281c-4af4-b823-edc672ff1a18' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 21, 59, 34, 849059), last_update=datetime.datetime(2024, 12, 30, 21, 59, 34, 849076)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_current in namespace state
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:05:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:05:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_current.json
2024-12-30 22:05:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_current
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1 in namespace state
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:05:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:05:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:05:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7a26723b-281c-4af4-b823-edc672ff1a18\states\game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1.json
2024-12-30 22:05:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_7a26723b-281c-4af4-b823-edc672ff1a18_section_1
2024-12-30 22:05:30 | INFO     | managers.agent_manager:stop_game:376 - Final game state saved successfully
2024-12-30 22:05:30 | INFO     | managers.agent_manager:stop_game:378 - Game stopped successfully
2024-12-30 22:05:30 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:05:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:05:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:05:37 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:05:38 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:05:38 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:05:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:05:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:05:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:05:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:05:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:05:38 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:05:38 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:05:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:05:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:05:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:05:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:05:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:05:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:05:39 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:05:39 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:05:39 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:05:39 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:05:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:05:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:05:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:05:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:05:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:05:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:05:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:05:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:05:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:06:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:06:04 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:06:04 | DEBUG    | managers.agent_manager:stop_game:369 - No game ID set, nothing to save
2024-12-30 22:06:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:06:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:06:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:06:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:06:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:06:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:06:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:06:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:06:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:06:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:06:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:06:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:06:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:06:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:06:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:06:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:06:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:06:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:06:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:06:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:06:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:06:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:31 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:06:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:06:31 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:06:31 | DEBUG    | managers.agent_manager:stop_game:369 - No game ID set, nothing to save
2024-12-30 22:06:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:06:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:06:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:06:36 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:06:36 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:06:36 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:06:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:06:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:06:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:06:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:06:36 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:06:36 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:06:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:06:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:06:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:06:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:06:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:06:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:06:37 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:06:37 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:06:37 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:06:37 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:42 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:06:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:06:43 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:43 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:43 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:06:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:45 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:06:45 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 22:06:45 | DEBUG    | managers.agent_manager:get_story_workflow:296 - Story graph not configured, configuring now
2024-12-30 22:06:45 | DEBUG    | managers.agent_manager:get_story_workflow:305 - Compiling workflow
2024-12-30 22:06:45 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:06:45 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:06:45 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:06:45 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 943344f2-f3d2-4a02-88b0-5cec31385d70
2024-12-30 22:06:45 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 943344f2-f3d2-4a02-88b0-5cec31385d70
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\traces
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters
2024-12-30 22:06:45 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 943344f2-f3d2-4a02-88b0-5cec31385d70
2024-12-30 22:06:45 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e1f5d856-45e4-4ddd-b168-e0d14a38c02a
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:06:45 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e1f5d856-45e4-4ddd-b168-e0d14a38c02a', 'game_id': '943344f2-f3d2-4a02-88b0-5cec31385d70', 'last_update': '2024-12-30T22:06:45.967843', 'character_id': 'current'}
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:06:46 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:06:46 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:06:46 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:06:46 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:06:46 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7d6370ac-c207-43e9-b245-8a52dca6bbcc
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:06:46 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7d6370ac-c207-43e9-b245-8a52dca6bbcc', 'game_id': '943344f2-f3d2-4a02-88b0-5cec31385d70', 'last_update': '2024-12-30T22:06:46.036193', 'character_id': 'current'}
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:06:46 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: 7d6370ac-c207-43e9-b245-8a52dca6bbcc and game_id: 943344f2-f3d2-4a02-88b0-5cec31385d70
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:06:46 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: 7d6370ac-c207-43e9-b245-8a52dca6bbcc and section_number: 1
2024-12-30 22:06:46 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:06:46 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:06:46 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:06:46 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:06:46 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:06:46 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:06:46 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:06:46 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:06:46 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:06:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:06:46 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:06:46 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:06:46 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:06:46 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:06:46 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:06:46 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:06:46 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:06:46 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:06:46 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:06:46 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:06:46 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 22:06:46 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:726c6f10-e6a8-9ec0-d786-93c5bdf311b5'], when='during'),)
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:06:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:06:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:06:46 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:06:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:06:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:06:46 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:46 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='e1f5d856-45e4-4ddd-b168-e0d14a38c02a' game_id='943344f2-f3d2-4a02-88b0-5cec31385d70' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 6, 46, 148826), last_update=datetime.datetime(2024, 12, 30, 22, 6, 46, 148873)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:06:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:06:46 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:06:46 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='e1f5d856-45e4-4ddd-b168-e0d14a38c02a' game_id='943344f2-f3d2-4a02-88b0-5cec31385d70' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 6, 46, 148826), last_update=datetime.datetime(2024, 12, 30, 22, 6, 46, 148873)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:07:05 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '943344f2-f3d2-4a02-88b0-5cec31385d70', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:07:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='943344f2-f3d2-4a02-88b0-5cec31385d70' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:07:05 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:07:05 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:07:05 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:05 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='e1f5d856-45e4-4ddd-b168-e0d14a38c02a' game_id='943344f2-f3d2-4a02-88b0-5cec31385d70' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 6, 46, 148826), last_update=datetime.datetime(2024, 12, 30, 22, 6, 46, 148873)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:05 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 22:07:05 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:07:05 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 6, 46, 148826), last_update=datetime.datetime(2024, 12, 30, 22, 6, 46, 148873)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:07:05 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:07:05 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:07:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c60b695b-1c29-44ac-abf4-db7c39ce2c7a
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\characters\current.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:07:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c60b695b-1c29-44ac-abf4-db7c39ce2c7a', 'game_id': '943344f2-f3d2-4a02-88b0-5cec31385d70', 'last_update': '2024-12-30T22:07:05.044328', 'character_id': 'current'}
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:07:05 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: c60b695b-1c29-44ac-abf4-db7c39ce2c7a and game_id: 943344f2-f3d2-4a02-88b0-5cec31385d70
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:07:05 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: c60b695b-1c29-44ac-abf4-db7c39ce2c7a and section_number: 1
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:07:05 | INFO     | managers.agent_manager:process_game_state:261 - Game state processed successfully
2024-12-30 22:07:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:07:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:07:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:07:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:07:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:07:27 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:07:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:27 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:07:27 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:07:27 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:27 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='e1f5d856-45e4-4ddd-b168-e0d14a38c02a' game_id='943344f2-f3d2-4a02-88b0-5cec31385d70' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 6, 46, 148826), last_update=datetime.datetime(2024, 12, 30, 22, 6, 46, 148873)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_current in namespace state
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_current.json
2024-12-30 22:07:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_current
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1 in namespace state
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\943344f2-f3d2-4a02-88b0-5cec31385d70\states\game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1.json
2024-12-30 22:07:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_943344f2-f3d2-4a02-88b0-5cec31385d70_section_1
2024-12-30 22:07:27 | INFO     | managers.agent_manager:stop_game:376 - Final game state saved successfully
2024-12-30 22:07:27 | INFO     | managers.agent_manager:stop_game:378 - Game stopped successfully
2024-12-30 22:07:27 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:07:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:07:33 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 22:07:33 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 22:07:33 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 22:07:33 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 22:07:33 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 22:07:33 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 22:07:33 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 22:07:33 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:07:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:07:36 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:07:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:07:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:07:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:07:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:07:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:07:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:07:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:07:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:07:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:07:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:07:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:07:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:07:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:07:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:07:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:07:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:07:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:07:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:07:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:07:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:07:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:07:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:07:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:07:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:07:38 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:07:38 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:07:38 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:07:38 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:07:38 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:38 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:07:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:38 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:38 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:07:38 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:07:38 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:07:38 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:07:38 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:07:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:07:38 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 22:07:38 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 22:07:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:07:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:07:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:07:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:48 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:07:48 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_story_workflow:296 - Story graph not configured, configuring now
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_story_workflow:305 - Compiling workflow
2024-12-30 22:07:48 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:07:48 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:07:48 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:07:48 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 420fb7d9-0b7b-4f2f-ac8c-e79455e81a23
2024-12-30 22:07:48 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 420fb7d9-0b7b-4f2f-ac8c-e79455e81a23
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\traces
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters
2024-12-30 22:07:48 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 420fb7d9-0b7b-4f2f-ac8c-e79455e81a23
2024-12-30 22:07:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 55ed6b31-e942-41ad-adfb-44c96c0840c9
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:07:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '55ed6b31-e942-41ad-adfb-44c96c0840c9', 'game_id': '420fb7d9-0b7b-4f2f-ac8c-e79455e81a23', 'last_update': '2024-12-30T22:07:48.812100', 'character_id': 'current'}
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:48 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:07:48 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:48 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:07:48 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:07:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: bc8c5d11-bfed-4d15-8072-aa5f206cf0f4
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:07:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'bc8c5d11-bfed-4d15-8072-aa5f206cf0f4', 'game_id': '420fb7d9-0b7b-4f2f-ac8c-e79455e81a23', 'last_update': '2024-12-30T22:07:48.836190', 'character_id': 'current'}
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:48 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: bc8c5d11-bfed-4d15-8072-aa5f206cf0f4 and game_id: 420fb7d9-0b7b-4f2f-ac8c-e79455e81a23
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:48 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: bc8c5d11-bfed-4d15-8072-aa5f206cf0f4 and section_number: 1
2024-12-30 22:07:48 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:07:48 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:07:48 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:07:48 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:07:48 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:07:48 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:07:48 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:07:48 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:07:48 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:07:48 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:07:48 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:07:48 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:07:48 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:07:48 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:07:48 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:07:48 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:07:48 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:07:48 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:07:48 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:07:48 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 22:07:48 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:53aee958-5f35-cdf8-568e-5113c7e40c92'], when='during'),)
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:48 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:07:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:07:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='55ed6b31-e942-41ad-adfb-44c96c0840c9' game_id='420fb7d9-0b7b-4f2f-ac8c-e79455e81a23' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 7, 48, 876819), last_update=datetime.datetime(2024, 12, 30, 22, 7, 48, 876836)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='55ed6b31-e942-41ad-adfb-44c96c0840c9' game_id='420fb7d9-0b7b-4f2f-ac8c-e79455e81a23' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 7, 48, 876819), last_update=datetime.datetime(2024, 12, 30, 22, 7, 48, 876836)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:07:52 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '420fb7d9-0b7b-4f2f-ac8c-e79455e81a23', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='420fb7d9-0b7b-4f2f-ac8c-e79455e81a23' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:07:52 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:07:52 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:07:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:07:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='55ed6b31-e942-41ad-adfb-44c96c0840c9' game_id='420fb7d9-0b7b-4f2f-ac8c-e79455e81a23' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 7, 48, 876819), last_update=datetime.datetime(2024, 12, 30, 22, 7, 48, 876836)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:07:52 | INFO     | managers.agent_manager:get_story_workflow:292 - Getting story workflow
2024-12-30 22:07:52 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:07:52 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 7, 48, 876819), last_update=datetime.datetime(2024, 12, 30, 22, 7, 48, 876836)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:07:52 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:07:52 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:07:52 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 27cb9a2a-a8d2-4a8d-b4fd-ea2213894334
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\characters\current.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:07:52 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '27cb9a2a-a8d2-4a8d-b4fd-ea2213894334', 'game_id': '420fb7d9-0b7b-4f2f-ac8c-e79455e81a23', 'last_update': '2024-12-30T22:07:52.134403', 'character_id': 'current'}
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:52 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: 27cb9a2a-a8d2-4a8d-b4fd-ea2213894334 and game_id: 420fb7d9-0b7b-4f2f-ac8c-e79455e81a23
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:52 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: 27cb9a2a-a8d2-4a8d-b4fd-ea2213894334 and section_number: 1
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:07:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:07:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:07:52 | INFO     | managers.agent_manager:process_game_state:261 - Game state processed successfully
2024-12-30 22:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:10:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:10:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:10:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:10:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:10:57 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:10:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:10:57 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:10:57 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:10:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:10:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='55ed6b31-e942-41ad-adfb-44c96c0840c9' game_id='420fb7d9-0b7b-4f2f-ac8c-e79455e81a23' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 7, 48, 876819), last_update=datetime.datetime(2024, 12, 30, 22, 7, 48, 876836)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current in namespace state
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:10:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:10:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current.json
2024-12-30 22:10:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_current
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1 in namespace state
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:10:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:10:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:10:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\420fb7d9-0b7b-4f2f-ac8c-e79455e81a23\states\game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1.json
2024-12-30 22:10:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_420fb7d9-0b7b-4f2f-ac8c-e79455e81a23_section_1
2024-12-30 22:10:57 | INFO     | managers.agent_manager:stop_game:376 - Final game state saved successfully
2024-12-30 22:10:57 | INFO     | managers.agent_manager:stop_game:378 - Game stopped successfully
2024-12-30 22:10:57 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:10:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:04 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:11:04 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:11:04 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:11:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:11:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:11:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:11:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:04 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:11:04 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:11:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:11:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:11:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:11:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:11:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:11:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:11:06 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:11:06 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:11:06 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:11:06 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:11:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:13 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:11:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:11:13 | INFO     | managers.agent_manager:stop_game:364 - Stopping game...
2024-12-30 22:11:13 | DEBUG    | managers.agent_manager:stop_game:369 - No game ID set, nothing to save
2024-12-30 22:11:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:11:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:25 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:11:25 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:11:25 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:11:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:11:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:11:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:11:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:25 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:11:25 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:11:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:11:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:11:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:11:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:11:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:11:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:11:26 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:11:26 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:11:26 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:11:26 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:45 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:11:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:45 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:11:45 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:11:45 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 22:11:45 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:11:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:11:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:11:51 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:11:51 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:11:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:11:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:11:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:11:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:11:51 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:11:51 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:11:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:11:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:11:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:11:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:11:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:11:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:11:52 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:11:52 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:11:52 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:11:52 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:11:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:11:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:11:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:11:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:11:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:11:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:12:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:12:00 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:12:00 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 22:12:00 | DEBUG    | managers.agent_manager:get_story_workflow:298 - Story graph not configured, configuring now
2024-12-30 22:12:00 | DEBUG    | managers.agent_manager:get_story_workflow:307 - Compiling workflow
2024-12-30 22:12:00 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:12:00 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:12:00 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:12:00 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: fc383f38-c984-45b7-904b-9757feb6eb52
2024-12-30 22:12:00 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: fc383f38-c984-45b7-904b-9757feb6eb52
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\traces
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters
2024-12-30 22:12:00 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: fc383f38-c984-45b7-904b-9757feb6eb52
2024-12-30 22:12:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 456a4650-93b5-496c-8e57-0aa8f630d87b
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:12:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '456a4650-93b5-496c-8e57-0aa8f630d87b', 'game_id': 'fc383f38-c984-45b7-904b-9757feb6eb52', 'last_update': '2024-12-30T22:12:00.971789', 'character_id': 'current'}
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:00 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:12:00 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:12:00 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:12:00 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:12:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2751f93f-61a2-4da4-bad3-f1dda6f875e5
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:12:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2751f93f-61a2-4da4-bad3-f1dda6f875e5', 'game_id': 'fc383f38-c984-45b7-904b-9757feb6eb52', 'last_update': '2024-12-30T22:12:00.999322', 'character_id': 'current'}
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:01 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: 2751f93f-61a2-4da4-bad3-f1dda6f875e5 and game_id: fc383f38-c984-45b7-904b-9757feb6eb52
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:01 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: 2751f93f-61a2-4da4-bad3-f1dda6f875e5 and section_number: 1
2024-12-30 22:12:01 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:12:01 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:12:01 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:12:01 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:12:01 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:12:01 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:12:01 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:12:01 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:12:01 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:12:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:12:01 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:12:01 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:12:01 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:12:01 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:12:01 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:12:01 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:12:01 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:12:01 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:12:01 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:12:01 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:12:01 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:12:01 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:12:01 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:c581b8c1-0b44-157b-da7b-250e9cea3eaa'], when='during'),)
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:01 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:12:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:12:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:12:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='456a4650-93b5-496c-8e57-0aa8f630d87b' game_id='fc383f38-c984-45b7-904b-9757feb6eb52' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 12, 1, 59911), last_update=datetime.datetime(2024, 12, 30, 22, 12, 1, 59944)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:12:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:12:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:12:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='456a4650-93b5-496c-8e57-0aa8f630d87b' game_id='fc383f38-c984-45b7-904b-9757feb6eb52' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 12, 1, 59911), last_update=datetime.datetime(2024, 12, 30, 22, 12, 1, 59944)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:12:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:12:09 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'fc383f38-c984-45b7-904b-9757feb6eb52', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:12:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='fc383f38-c984-45b7-904b-9757feb6eb52' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:12:09 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:12:09 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:12:09 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:12:09 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='456a4650-93b5-496c-8e57-0aa8f630d87b' game_id='fc383f38-c984-45b7-904b-9757feb6eb52' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 12, 1, 59911), last_update=datetime.datetime(2024, 12, 30, 22, 12, 1, 59944)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:12:09 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 22:12:09 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:12:09 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 12, 1, 59911), last_update=datetime.datetime(2024, 12, 30, 22, 12, 1, 59944)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:12:09 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:12:09 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:12:09 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a353e343-1c2b-41e5-ab3a-d3f999d449cd
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\characters\current.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:12:09 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a353e343-1c2b-41e5-ab3a-d3f999d449cd', 'game_id': 'fc383f38-c984-45b7-904b-9757feb6eb52', 'last_update': '2024-12-30T22:12:09.674878', 'character_id': 'current'}
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:09 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: a353e343-1c2b-41e5-ab3a-d3f999d449cd and game_id: fc383f38-c984-45b7-904b-9757feb6eb52
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:09 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: a353e343-1c2b-41e5-ab3a-d3f999d449cd and section_number: 1
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:12:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:12:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:12:09 | INFO     | managers.agent_manager:process_game_state:263 - Game state processed successfully
2024-12-30 22:12:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:15:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:15:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:15:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:15:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:15:36 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:15:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:15:36 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:15:36 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:15:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:15:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='456a4650-93b5-496c-8e57-0aa8f630d87b' game_id='fc383f38-c984-45b7-904b-9757feb6eb52' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 12, 1, 59911), last_update=datetime.datetime(2024, 12, 30, 22, 12, 1, 59944)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_current in namespace state
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:15:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:15:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_current.json
2024-12-30 22:15:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_current
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1 in namespace state
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:15:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:15:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:15:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fc383f38-c984-45b7-904b-9757feb6eb52\states\game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1.json
2024-12-30 22:15:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_fc383f38-c984-45b7-904b-9757feb6eb52_section_1
2024-12-30 22:15:36 | INFO     | managers.agent_manager:stop_game:378 - Final game state saved successfully
2024-12-30 22:15:36 | INFO     | managers.agent_manager:stop_game:380 - Game stopped successfully
2024-12-30 22:15:36 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:15:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:15:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:15:42 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:15:43 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:15:43 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:15:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:15:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:15:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:15:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:15:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:15:43 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:15:43 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:15:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:15:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:15:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:15:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:15:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:15:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:15:44 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:15:44 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:15:44 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:15:44 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:15:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:15:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:15:44 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:15:44 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:15:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:15:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:15:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:15:44 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:15:44 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:16:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:16:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:16:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:16:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:16:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:16:06 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:16:06 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 22:16:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:16:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:16:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:16:11 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:16:11 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:16:11 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:16:11 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:16:11 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:16:11 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:16:11 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:16:11 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:16:11 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:16:11 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:16:11 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:16:11 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:16:11 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:16:11 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:16:11 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:16:11 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:16:12 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:16:12 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:16:12 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:16:12 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:16:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:16:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:16:12 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:12 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:16:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:16:12 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:12 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:16:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:16:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:16:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:16:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:16:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:16:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:16:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:16:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:16:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:16:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:21 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:16:21 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_story_workflow:298 - Story graph not configured, configuring now
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_story_workflow:307 - Compiling workflow
2024-12-30 22:16:21 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:16:21 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:16:21 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:16:21 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: d41b4e36-6c49-4126-a38d-4def8e3cb9af
2024-12-30 22:16:21 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d41b4e36-6c49-4126-a38d-4def8e3cb9af
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\traces
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters
2024-12-30 22:16:21 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: d41b4e36-6c49-4126-a38d-4def8e3cb9af
2024-12-30 22:16:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 52d902a3-a129-44a8-abd1-a91854ef0eca
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:16:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '52d902a3-a129-44a8-abd1-a91854ef0eca', 'game_id': 'd41b4e36-6c49-4126-a38d-4def8e3cb9af', 'last_update': '2024-12-30T22:16:21.156820', 'character_id': 'current'}
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:16:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:16:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:16:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:16:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b885e54b-188b-4df7-aebc-e91bc0d4e7d8
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:16:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b885e54b-188b-4df7-aebc-e91bc0d4e7d8', 'game_id': 'd41b4e36-6c49-4126-a38d-4def8e3cb9af', 'last_update': '2024-12-30T22:16:21.180833', 'character_id': 'current'}
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:21 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: b885e54b-188b-4df7-aebc-e91bc0d4e7d8 and game_id: d41b4e36-6c49-4126-a38d-4def8e3cb9af
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:21 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: b885e54b-188b-4df7-aebc-e91bc0d4e7d8 and section_number: 1
2024-12-30 22:16:21 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:16:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:16:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:16:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:16:21 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:16:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:16:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:16:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:16:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:16:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:16:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:16:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:16:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:16:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:16:21 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:16:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:16:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:16:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:16:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:16:21 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:16:21 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:16:21 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:16:21 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bacc9a9c-6a8c-b2af-74da-4f3c7d7239ad'], when='during'),)
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:21 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:16:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:16:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='52d902a3-a129-44a8-abd1-a91854ef0eca' game_id='d41b4e36-6c49-4126-a38d-4def8e3cb9af' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 16, 21, 213583), last_update=datetime.datetime(2024, 12, 30, 22, 16, 21, 213597)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:16:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='52d902a3-a129-44a8-abd1-a91854ef0eca' game_id='d41b4e36-6c49-4126-a38d-4def8e3cb9af' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 16, 21, 213583), last_update=datetime.datetime(2024, 12, 30, 22, 16, 21, 213597)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:16:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:16:50 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'd41b4e36-6c49-4126-a38d-4def8e3cb9af', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:16:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='d41b4e36-6c49-4126-a38d-4def8e3cb9af' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:16:50 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:16:50 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:16:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:16:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='52d902a3-a129-44a8-abd1-a91854ef0eca' game_id='d41b4e36-6c49-4126-a38d-4def8e3cb9af' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 16, 21, 213583), last_update=datetime.datetime(2024, 12, 30, 22, 16, 21, 213597)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:16:50 | INFO     | managers.agent_manager:get_story_workflow:294 - Getting story workflow
2024-12-30 22:16:50 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 22:16:50 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 16, 21, 213583), last_update=datetime.datetime(2024, 12, 30, 22, 16, 21, 213597)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:16:50 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 22:16:50 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 22:16:50 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e771575c-9d13-4b5c-85e9-7941d030eedc
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\characters\current.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:16:50 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e771575c-9d13-4b5c-85e9-7941d030eedc', 'game_id': 'd41b4e36-6c49-4126-a38d-4def8e3cb9af', 'last_update': '2024-12-30T22:16:50.690751', 'character_id': 'current'}
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:50 | DEBUG    | managers.workflow_manager:start_workflow:91 - Validated state session_id: e771575c-9d13-4b5c-85e9-7941d030eedc and game_id: d41b4e36-6c49-4126-a38d-4def8e3cb9af
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:50 | INFO     | managers.workflow_manager:start_workflow:102 - Successfully created and saved output with session_id: e771575c-9d13-4b5c-85e9-7941d030eedc and section_number: 1
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:16:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:16:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:16:50 | INFO     | managers.agent_manager:process_game_state:263 - Game state processed successfully
2024-12-30 22:16:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:20:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:20:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:20:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:20:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:20:29 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:20:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:20:29 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:20:29 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:20:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:20:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='52d902a3-a129-44a8-abd1-a91854ef0eca' game_id='d41b4e36-6c49-4126-a38d-4def8e3cb9af' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 16, 21, 213583), last_update=datetime.datetime(2024, 12, 30, 22, 16, 21, 213597)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current in namespace state
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current.json
2024-12-30 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_current
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1 in namespace state
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d41b4e36-6c49-4126-a38d-4def8e3cb9af\states\game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1.json
2024-12-30 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d41b4e36-6c49-4126-a38d-4def8e3cb9af_section_1
2024-12-30 22:20:29 | INFO     | managers.agent_manager:stop_game:378 - Final game state saved successfully
2024-12-30 22:20:29 | INFO     | managers.agent_manager:stop_game:380 - Game stopped successfully
2024-12-30 22:20:29 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:20:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:20:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:20:35 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:20:35 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:20:35 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:20:35 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:20:35 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:20:35 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:20:35 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:20:35 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:20:35 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:20:35 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:20:35 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:20:35 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:20:35 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:20:35 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:20:35 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:20:35 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:20:36 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:20:36 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:20:36 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:20:36 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:20:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:20:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:20:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:20:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:20:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:20:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:20:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:20:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:20:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:26:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:26:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:26:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:26:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:26:07 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:26:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:26:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:26:07 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:26:07 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 22:26:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:26:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:26:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:26:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:26:14 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:26:14 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:26:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:26:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:26:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:26:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:14 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:26:14 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:26:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:26:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:26:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:26:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:26:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:26:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:26:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:26:15 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:26:15 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:26:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:26:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:26:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:26:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:26:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:26:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:26:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:26:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:26:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:26:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:26:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:26:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:26:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:26:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:26:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:26:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:26:19 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:26:19 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 22:26:19 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 22:26:19 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:26:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:26:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:26:24 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:26:24 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:26:24 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:26:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:26:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:26:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:26:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:26:24 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:26:24 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:26:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:26:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:26:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:26:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:26:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:26:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:26:26 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:26:26 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:26:26 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:26:26 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:26:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:26:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:26:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:26:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:26:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:26:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:26:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:26:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:26:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:29:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:29:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:29:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:29:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:29:42 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:29:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:29:42 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:29:42 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:29:42 | DEBUG    | managers.agent_manager:stop_game:375 - No game ID set, nothing to save
2024-12-30 22:29:42 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:29:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:29:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:29:47 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:29:47 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:29:47 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:29:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:29:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:29:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:29:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:29:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:29:47 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:29:47 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:29:47 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:29:47 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:29:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:29:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:29:47 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:29:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:29:48 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:29:48 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:29:48 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:29:48 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:29:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:29:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:29:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:29:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:29:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:29:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:29:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:29:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:29:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:30:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:30:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:30:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:30:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:30:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:30:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:30:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:30:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:30:02 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:02 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:03 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:30:03 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:30:03 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:30:03 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:30:03 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:30:03 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 85ec3b5c-f3d3-44c9-a259-7c30af8fd173
2024-12-30 22:30:03 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 85ec3b5c-f3d3-44c9-a259-7c30af8fd173
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\traces
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters
2024-12-30 22:30:03 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 85ec3b5c-f3d3-44c9-a259-7c30af8fd173
2024-12-30 22:30:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 4ed84266-2868-478b-905e-11e338975352
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:30:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '4ed84266-2868-478b-905e-11e338975352', 'game_id': '85ec3b5c-f3d3-44c9-a259-7c30af8fd173', 'last_update': '2024-12-30T22:30:03.670895', 'character_id': 'current'}
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:03 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:30:03 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:30:03 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:30:03 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:30:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6ebd150b-0ec7-4838-a73a-b1fd7b84e16f
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:30:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6ebd150b-0ec7-4838-a73a-b1fd7b84e16f', 'game_id': '85ec3b5c-f3d3-44c9-a259-7c30af8fd173', 'last_update': '2024-12-30T22:30:03.729292', 'character_id': 'current'}
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:03 | DEBUG    | managers.workflow_manager:start_workflow:84 - Using state with session_id: 6ebd150b-0ec7-4838-a73a-b1fd7b84e16f and game_id: 85ec3b5c-f3d3-44c9-a259-7c30af8fd173
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:03 | INFO     | managers.workflow_manager:start_workflow:92 - Successfully created and saved output with session_id: 6ebd150b-0ec7-4838-a73a-b1fd7b84e16f and section_number: 1
2024-12-30 22:30:03 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:30:03 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:30:03 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:30:03 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:30:03 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:30:03 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:30:03 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:30:03 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:30:03 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:30:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:30:03 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:30:03 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:30:03 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:30:03 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:30:03 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:30:03 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:30:03 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:30:03 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:30:03 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:30:03 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:30:03 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:30:03 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:30:03 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:72d82830-50e2-5436-c4ba-c2a406f0d040'], when='during'),)
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:03 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:30:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:30:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='4ed84266-2868-478b-905e-11e338975352' game_id='85ec3b5c-f3d3-44c9-a259-7c30af8fd173' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 30, 3, 842896), last_update=datetime.datetime(2024, 12, 30, 22, 30, 3, 842961)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:30:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='4ed84266-2868-478b-905e-11e338975352' game_id='85ec3b5c-f3d3-44c9-a259-7c30af8fd173' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 30, 3, 842896), last_update=datetime.datetime(2024, 12, 30, 22, 30, 3, 842961)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:30:19 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '85ec3b5c-f3d3-44c9-a259-7c30af8fd173', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='85ec3b5c-f3d3-44c9-a259-7c30af8fd173' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:30:19 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:30:19 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:30:19 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:19 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='4ed84266-2868-478b-905e-11e338975352' game_id='85ec3b5c-f3d3-44c9-a259-7c30af8fd173' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 30, 3, 842896), last_update=datetime.datetime(2024, 12, 30, 22, 30, 3, 842961)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:30:19 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:30:19 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:30:19 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 30, 3, 842896), last_update=datetime.datetime(2024, 12, 30, 22, 30, 3, 842961)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:30:19 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:30:19 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:30:19 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 225e5095-ff31-40bc-9e8f-74961b22b845
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\characters\current.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:30:19 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '225e5095-ff31-40bc-9e8f-74961b22b845', 'game_id': '85ec3b5c-f3d3-44c9-a259-7c30af8fd173', 'last_update': '2024-12-30T22:30:19.490483', 'character_id': 'current'}
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:19 | DEBUG    | managers.workflow_manager:start_workflow:84 - Using state with session_id: 225e5095-ff31-40bc-9e8f-74961b22b845 and game_id: 85ec3b5c-f3d3-44c9-a259-7c30af8fd173
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:19 | INFO     | managers.workflow_manager:start_workflow:92 - Successfully created and saved output with session_id: 225e5095-ff31-40bc-9e8f-74961b22b845 and section_number: 1
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_current
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1 in namespace state
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:30:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\85ec3b5c-f3d3-44c9-a259-7c30af8fd173\states\game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1.json
2024-12-30 22:30:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_85ec3b5c-f3d3-44c9-a259-7c30af8fd173_section_1
2024-12-30 22:30:19 | INFO     | managers.agent_manager:process_game_state:267 - Game state processed successfully
2024-12-30 22:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:30:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:30:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:30:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:30:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:30:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:30:51 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 22:30:51 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 22:30:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 22:30:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 22:30:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 22:30:51 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 22:30:51 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 22:30:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:30:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:30:54 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:30:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:30:54 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:30:54 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:30:54 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:30:54 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:30:54 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:30:54 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:30:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:30:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:30:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:30:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:30:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:30:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:30:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:30:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:30:55 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:30:55 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:30:55 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:30:55 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:30:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:30:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:30:55 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:55 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:30:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:30:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:30:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:30:58 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:30:58 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:31:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:31:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:31:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:31:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:31:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:31:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:31:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:31:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:31:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:31:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:31:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:31:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:31:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:31:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:26 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:31:26 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:31:26 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:31:26 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:31:26 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:31:26 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 52841303-477a-4278-a828-e3e273f0df17
2024-12-30 22:31:26 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 52841303-477a-4278-a828-e3e273f0df17
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\52841303-477a-4278-a828-e3e273f0df17\traces
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters
2024-12-30 22:31:26 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 52841303-477a-4278-a828-e3e273f0df17
2024-12-30 22:31:26 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 53b7fbeb-4279-44e1-99f1-cc69c3ea84ac
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:31:26 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '53b7fbeb-4279-44e1-99f1-cc69c3ea84ac', 'game_id': '52841303-477a-4278-a828-e3e273f0df17', 'last_update': '2024-12-30T22:31:26.124333', 'character_id': 'current'}
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:26 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:31:26 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:31:26 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:31:26 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:31:26 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a88f7e66-3e0e-4a3a-b8cf-d3083036896e
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:31:26 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a88f7e66-3e0e-4a3a-b8cf-d3083036896e', 'game_id': '52841303-477a-4278-a828-e3e273f0df17', 'last_update': '2024-12-30T22:31:26.176561', 'character_id': 'current'}
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:26 | DEBUG    | managers.workflow_manager:start_workflow:84 - Using state with session_id: a88f7e66-3e0e-4a3a-b8cf-d3083036896e and game_id: 52841303-477a-4278-a828-e3e273f0df17
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:26 | INFO     | managers.workflow_manager:start_workflow:92 - Successfully created and saved output with session_id: a88f7e66-3e0e-4a3a-b8cf-d3083036896e and section_number: 1
2024-12-30 22:31:26 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:31:26 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:31:26 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:31:26 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:31:26 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:31:26 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:31:26 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:31:26 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:31:26 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:31:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:31:26 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:31:26 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:31:26 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:31:26 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:31:26 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:31:26 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:31:26 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:31:26 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:31:26 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:31:26 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:31:26 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:31:26 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:31:26 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:75571cc7-197b-667e-9679-d3c759628a30'], when='during'),)
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:26 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:31:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:31:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='53b7fbeb-4279-44e1-99f1-cc69c3ea84ac' game_id='52841303-477a-4278-a828-e3e273f0df17' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 31, 26, 261217), last_update=datetime.datetime(2024, 12, 30, 22, 31, 26, 261247)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:31:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='53b7fbeb-4279-44e1-99f1-cc69c3ea84ac' game_id='52841303-477a-4278-a828-e3e273f0df17' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 31, 26, 261217), last_update=datetime.datetime(2024, 12, 30, 22, 31, 26, 261247)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:31:30 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '52841303-477a-4278-a828-e3e273f0df17', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='52841303-477a-4278-a828-e3e273f0df17' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:31:30 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:31:30 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:31:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:31:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='53b7fbeb-4279-44e1-99f1-cc69c3ea84ac' game_id='52841303-477a-4278-a828-e3e273f0df17' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 31, 26, 261217), last_update=datetime.datetime(2024, 12, 30, 22, 31, 26, 261247)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:31:30 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:31:30 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:31:30 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 31, 26, 261217), last_update=datetime.datetime(2024, 12, 30, 22, 31, 26, 261247)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:31:30 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:31:30 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:31:30 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b714b163-1a41-4dcc-bedc-14c03582afcd
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\characters\current.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:31:30 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b714b163-1a41-4dcc-bedc-14c03582afcd', 'game_id': '52841303-477a-4278-a828-e3e273f0df17', 'last_update': '2024-12-30T22:31:30.557972', 'character_id': 'current'}
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:30 | DEBUG    | managers.workflow_manager:start_workflow:84 - Using state with session_id: b714b163-1a41-4dcc-bedc-14c03582afcd and game_id: 52841303-477a-4278-a828-e3e273f0df17
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:30 | INFO     | managers.workflow_manager:start_workflow:92 - Successfully created and saved output with session_id: b714b163-1a41-4dcc-bedc-14c03582afcd and section_number: 1
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:31:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:31:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:31:30 | INFO     | managers.agent_manager:process_game_state:267 - Game state processed successfully
2024-12-30 22:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:35:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:35:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:35:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:35:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:35:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:35:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:35:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:35:11 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:35:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:35:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='53b7fbeb-4279-44e1-99f1-cc69c3ea84ac' game_id='52841303-477a-4278-a828-e3e273f0df17' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 31, 26, 261217), last_update=datetime.datetime(2024, 12, 30, 22, 31, 26, 261247)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_current in namespace state
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:35:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:35:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_current.json
2024-12-30 22:35:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_current
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_52841303-477a-4278-a828-e3e273f0df17_section_1 in namespace state
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:35:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:35:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:35:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\52841303-477a-4278-a828-e3e273f0df17\states\game_52841303-477a-4278-a828-e3e273f0df17_section_1.json
2024-12-30 22:35:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_52841303-477a-4278-a828-e3e273f0df17_section_1
2024-12-30 22:35:11 | INFO     | managers.agent_manager:stop_game:382 - Final game state saved successfully
2024-12-30 22:35:11 | INFO     | managers.agent_manager:stop_game:384 - Game stopped successfully
2024-12-30 22:35:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:35:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:35:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:35:21 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:35:21 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:35:21 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:35:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:35:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:35:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:35:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:21 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:35:21 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:35:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:35:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:35:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:35:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:35:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:35:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:35:23 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:35:23 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:35:23 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:35:23 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:35:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:35:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:35:23 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:35:23 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:35:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:35:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:35:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:35:23 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:35:23 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:35:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:35:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:35:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:35:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:35:40 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:35:40 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:35:40 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:35:40 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:35:40 | DEBUG    | managers.agent_manager:stop_game:375 - No game ID set, nothing to save
2024-12-30 22:35:40 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:35:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:35:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:35:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:35:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:35:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:35:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:35:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:35:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:35:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:35:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:35:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:35:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:35:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:35:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:35:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:35:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:35:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:35:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:35:47 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:35:47 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:35:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:35:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:35:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:35:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:35:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:35:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:35:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:35:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:35:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:35:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:36:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:36:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:36:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:36:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:36:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:36:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:36:38 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:38 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:36:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:38 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:36:38 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:36:38 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:36:38 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:36:38 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:36:38 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:36:38 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:36:38 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: de8d9f9f-062c-462b-b958-66a80f33aefa
2024-12-30 22:36:38 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: de8d9f9f-062c-462b-b958-66a80f33aefa
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\traces
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters
2024-12-30 22:36:39 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: de8d9f9f-062c-462b-b958-66a80f33aefa
2024-12-30 22:36:39 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a6b9c1be-e74e-4f00-9261-2de7536959de
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:36:39 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a6b9c1be-e74e-4f00-9261-2de7536959de', 'game_id': 'de8d9f9f-062c-462b-b958-66a80f33aefa', 'last_update': '2024-12-30T22:36:39.017138', 'character_id': 'current'}
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:39 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:36:39 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:36:39 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:36:39 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:36:39 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1f12f3cc-3fc3-4a9b-8b6f-86ace3dca377
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:36:39 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1f12f3cc-3fc3-4a9b-8b6f-86ace3dca377', 'game_id': 'de8d9f9f-062c-462b-b958-66a80f33aefa', 'last_update': '2024-12-30T22:36:39.060357', 'character_id': 'current'}
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:39 | DEBUG    | managers.workflow_manager:start_workflow:87 - Preserved section_number: 1 from input state
2024-12-30 22:36:39 | DEBUG    | managers.workflow_manager:start_workflow:88 - Using state with session_id: 1f12f3cc-3fc3-4a9b-8b6f-86ace3dca377, game_id: de8d9f9f-062c-462b-b958-66a80f33aefa, section_number: 1
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:39 | INFO     | managers.workflow_manager:start_workflow:96 - Successfully created and saved output with session_id: 1f12f3cc-3fc3-4a9b-8b6f-86ace3dca377 and section_number: 1
2024-12-30 22:36:39 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:36:39 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:36:39 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:36:39 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:36:39 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:36:39 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:36:39 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:36:39 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:36:39 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:36:39 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:36:39 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:36:39 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:36:39 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:36:39 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:36:39 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:36:39 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:36:39 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:36:39 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:36:39 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:36:39 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:36:39 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:36:39 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:36:39 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:ee05c629-24cd-1d2a-a917-cd415687dcaf'], when='during'),)
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:39 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:39 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:36:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:36:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:36:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a6b9c1be-e74e-4f00-9261-2de7536959de' game_id='de8d9f9f-062c-462b-b958-66a80f33aefa' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 36, 39, 129932), last_update=datetime.datetime(2024, 12, 30, 22, 36, 39, 129955)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:36:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:36:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a6b9c1be-e74e-4f00-9261-2de7536959de' game_id='de8d9f9f-062c-462b-b958-66a80f33aefa' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 36, 39, 129932), last_update=datetime.datetime(2024, 12, 30, 22, 36, 39, 129955)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:36:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:36:41 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'de8d9f9f-062c-462b-b958-66a80f33aefa', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:36:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='de8d9f9f-062c-462b-b958-66a80f33aefa' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:36:41 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:36:41 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:36:41 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:36:41 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a6b9c1be-e74e-4f00-9261-2de7536959de' game_id='de8d9f9f-062c-462b-b958-66a80f33aefa' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 36, 39, 129932), last_update=datetime.datetime(2024, 12, 30, 22, 36, 39, 129955)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:36:41 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:36:41 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:36:41 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 36, 39, 129932), last_update=datetime.datetime(2024, 12, 30, 22, 36, 39, 129955)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:36:41 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:36:41 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:36:41 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3bd7a0b2-82cd-48d2-9123-da01167baef6
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\characters\current.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:36:41 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3bd7a0b2-82cd-48d2-9123-da01167baef6', 'game_id': 'de8d9f9f-062c-462b-b958-66a80f33aefa', 'last_update': '2024-12-30T22:36:41.353218', 'character_id': 'current'}
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:41 | DEBUG    | managers.workflow_manager:start_workflow:87 - Preserved section_number: 1 from input state
2024-12-30 22:36:41 | DEBUG    | managers.workflow_manager:start_workflow:88 - Using state with session_id: 3bd7a0b2-82cd-48d2-9123-da01167baef6, game_id: de8d9f9f-062c-462b-b958-66a80f33aefa, section_number: 1
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:41 | INFO     | managers.workflow_manager:start_workflow:96 - Successfully created and saved output with session_id: 3bd7a0b2-82cd-48d2-9123-da01167baef6 and section_number: 1
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:36:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:36:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:36:41 | INFO     | managers.agent_manager:process_game_state:267 - Game state processed successfully
2024-12-30 22:36:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:39:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:39:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:39:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:39:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:39:18 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:39:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:39:18 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:39:18 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:39:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:39:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='a6b9c1be-e74e-4f00-9261-2de7536959de' game_id='de8d9f9f-062c-462b-b958-66a80f33aefa' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 36, 39, 129932), last_update=datetime.datetime(2024, 12, 30, 22, 36, 39, 129955)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_current in namespace state
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:39:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:39:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_current.json
2024-12-30 22:39:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_current
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1 in namespace state
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:39:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:39:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:39:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\de8d9f9f-062c-462b-b958-66a80f33aefa\states\game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1.json
2024-12-30 22:39:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_de8d9f9f-062c-462b-b958-66a80f33aefa_section_1
2024-12-30 22:39:18 | INFO     | managers.agent_manager:stop_game:382 - Final game state saved successfully
2024-12-30 22:39:18 | INFO     | managers.agent_manager:stop_game:384 - Game stopped successfully
2024-12-30 22:39:18 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:39:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:39:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:39:24 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:39:24 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:39:24 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:39:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:39:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:39:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:39:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:39:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:39:24 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:39:24 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:39:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:39:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:39:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:39:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:39:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:39:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:39:25 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:39:25 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:39:25 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:39:25 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:39:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:39:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:39:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:39:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:39:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:39:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:39:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:39:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:39:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:45:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:45:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:45:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:45:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:45:50 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:45:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:50 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:45:50 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:45:50 | DEBUG    | managers.agent_manager:stop_game:375 - No game ID set, nothing to save
2024-12-30 22:45:50 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:45:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:45:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:45:54 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:45:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:45:54 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:45:54 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:45:54 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:45:54 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:45:54 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:45:54 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:45:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:45:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:45:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:45:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:45:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:45:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:45:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:45:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:45:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:45:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:45:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:45:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:45:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:45:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:45:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:45:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:45:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:45:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:45:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:45:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:45:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:45:55 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:45:55 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:45:55 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:45:55 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:45:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:45:55 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 22:45:55 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 22:45:56 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:45:56 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:45:56 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:45:56 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:45:56 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:45:56 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:45:56 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:45:56 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:45:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:45:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:45:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:45:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:45:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:45:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:45:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:45:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:57 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:45:57 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:45:57 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:45:57 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:45:57 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:45:57 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 5b30950e-36da-4388-95b2-2eef77ece5a7
2024-12-30 22:45:57 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 5b30950e-36da-4388-95b2-2eef77ece5a7
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\traces
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters
2024-12-30 22:45:57 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 5b30950e-36da-4388-95b2-2eef77ece5a7
2024-12-30 22:45:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 50a19925-2c64-437f-a139-545e89320610
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:45:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '50a19925-2c64-437f-a139-545e89320610', 'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'last_update': '2024-12-30T22:45:57.693989', 'character_id': 'current'}
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:57 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:45:57 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:45:57 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:45:57 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:45:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3ca2bf93-bfe8-40ba-b729-317e77de1a5a
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:45:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3ca2bf93-bfe8-40ba-b729-317e77de1a5a', 'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'last_update': '2024-12-30T22:45:57.730411', 'character_id': 'current'}
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:57 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=3ca2bf93-bfe8-40ba-b729-317e77de1a5a, game_id=5b30950e-36da-4388-95b2-2eef77ece5a7, section_number=1
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:57 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 3ca2bf93-bfe8-40ba-b729-317e77de1a5a and section_number: 1
2024-12-30 22:45:57 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:45:57 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:45:57 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:45:57 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:45:57 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:45:57 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:45:57 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:45:57 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:45:57 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:45:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:45:57 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:45:57 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:45:57 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:45:57 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:45:57 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:45:57 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:45:57 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:45:57 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:45:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:45:57 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:45:57 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:45:57 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:45:57 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:5f2d3bf2-792b-b23f-f4de-211b71e4796b'], when='during'),)
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:57 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:45:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:45:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='50a19925-2c64-437f-a139-545e89320610' game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 45, 57, 780375), last_update=datetime.datetime(2024, 12, 30, 22, 45, 57, 780385)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:45:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='50a19925-2c64-437f-a139-545e89320610' game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 45, 57, 780375), last_update=datetime.datetime(2024, 12, 30, 22, 45, 57, 780385)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:45:59 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:45:59 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:45:59 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:45:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:45:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='50a19925-2c64-437f-a139-545e89320610' game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 45, 57, 780375), last_update=datetime.datetime(2024, 12, 30, 22, 45, 57, 780385)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:45:59 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:45:59 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:45:59 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 45, 57, 780375), last_update=datetime.datetime(2024, 12, 30, 22, 45, 57, 780385)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:45:59 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:45:59 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:45:59 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a081da22-6e97-43ee-8492-c5d87e2f284b
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\characters\current.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:45:59 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a081da22-6e97-43ee-8492-c5d87e2f284b', 'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'last_update': '2024-12-30T22:45:59.893396', 'character_id': 'current'}
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:59 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=a081da22-6e97-43ee-8492-c5d87e2f284b, game_id=5b30950e-36da-4388-95b2-2eef77ece5a7, section_number=1
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:45:59 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: a081da22-6e97-43ee-8492-c5d87e2f284b and section_number: 1
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:45:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:45:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:46:00 | INFO     | managers.agent_manager:process_game_state:267 - Game state processed successfully
2024-12-30 22:46:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:46:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:46:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:46:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:46:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:46:10 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:46:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:46:10 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:46:10 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:10 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='50a19925-2c64-437f-a139-545e89320610' game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 45, 57, 780375), last_update=datetime.datetime(2024, 12, 30, 22, 45, 57, 780385)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_current in namespace state
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:46:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:46:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_current.json
2024-12-30 22:46:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_current
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1 in namespace state
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:46:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:46:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5b30950e-36da-4388-95b2-2eef77ece5a7\states\game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1.json
2024-12-30 22:46:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5b30950e-36da-4388-95b2-2eef77ece5a7_section_1
2024-12-30 22:46:10 | INFO     | managers.agent_manager:stop_game:382 - Final game state saved successfully
2024-12-30 22:46:10 | INFO     | managers.agent_manager:stop_game:384 - Game stopped successfully
2024-12-30 22:46:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:46:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:46:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:46:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:46:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:46:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:46:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:46:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:46:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:46:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:46:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:46:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:46:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:46:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:46:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:46:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:46:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:46:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:46:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:46:13 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:46:13 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:46:13 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:46:13 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:46:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:46:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:46:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:46:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:46:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:46:18 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:46:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:46:18 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:46:18 | ERROR    | managers.agent_manager:process_game_state:226 - Story graph not initialized
2024-12-30 22:46:18 | ERROR    | managers.agent_manager:process_game_state:279 - Error processing game state: Story graph not initialized
2024-12-30 22:46:18 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: Story graph not initialized
2024-12-30 22:46:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:46:43 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5b30950e-36da-4388-95b2-2eef77ece5a7', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:46:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5b30950e-36da-4388-95b2-2eef77ece5a7' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:46:43 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:46:43 | ERROR    | managers.agent_manager:process_game_state:226 - Story graph not initialized
2024-12-30 22:46:43 | ERROR    | managers.agent_manager:process_game_state:279 - Error processing game state: Story graph not initialized
2024-12-30 22:46:43 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: Story graph not initialized
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:46:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:50 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:46:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:46:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:46:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:46:51 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:51 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:46:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:52 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:46:52 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:46:52 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:46:52 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:46:52 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:46:52 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 09f9636b-cd09-486b-90d9-677fde984464
2024-12-30 22:46:52 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 09f9636b-cd09-486b-90d9-677fde984464
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\traces
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters
2024-12-30 22:46:52 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 09f9636b-cd09-486b-90d9-677fde984464
2024-12-30 22:46:52 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2198b674-8838-4a8d-8597-e0cd9b18729e
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:46:52 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2198b674-8838-4a8d-8597-e0cd9b18729e', 'game_id': '09f9636b-cd09-486b-90d9-677fde984464', 'last_update': '2024-12-30T22:46:52.513035', 'character_id': 'current'}
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_current in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_current
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_section_1 in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_section_1
2024-12-30 22:46:52 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:46:52 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:46:52 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:46:52 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:46:52 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: db6c0214-f436-46bf-a21a-716d17c7d3b7
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\characters\current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:46:52 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'db6c0214-f436-46bf-a21a-716d17c7d3b7', 'game_id': '09f9636b-cd09-486b-90d9-677fde984464', 'last_update': '2024-12-30T22:46:52.533983', 'character_id': 'current'}
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_current in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_current
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_section_1 in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_section_1
2024-12-30 22:46:52 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=db6c0214-f436-46bf-a21a-716d17c7d3b7, game_id=09f9636b-cd09-486b-90d9-677fde984464, section_number=1
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_current in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_current
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_section_1 in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_section_1
2024-12-30 22:46:52 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: db6c0214-f436-46bf-a21a-716d17c7d3b7 and section_number: 1
2024-12-30 22:46:52 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:46:52 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:46:52 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:46:52 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:46:52 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:46:52 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:46:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:46:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:46:52 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:46:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:46:52 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:46:52 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:46:52 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:46:52 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:46:52 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:46:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:46:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:46:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:46:52 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:46:52 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:46:52 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:46:52 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:46:52 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:82641b86-9c8c-92d2-6be0-40db59beee3d'], when='during'),)
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_current in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_current
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_section_1 in namespace state
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:46:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:46:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_section_1
2024-12-30 22:46:52 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:46:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:46:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='2198b674-8838-4a8d-8597-e0cd9b18729e' game_id='09f9636b-cd09-486b-90d9-677fde984464' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 46, 52, 570195), last_update=datetime.datetime(2024, 12, 30, 22, 46, 52, 570218)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:46:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='2198b674-8838-4a8d-8597-e0cd9b18729e' game_id='09f9636b-cd09-486b-90d9-677fde984464' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 46, 52, 570195), last_update=datetime.datetime(2024, 12, 30, 22, 46, 52, 570218)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:46:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:46:54 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '09f9636b-cd09-486b-90d9-677fde984464', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:46:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='09f9636b-cd09-486b-90d9-677fde984464' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:46:54 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:46:54 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:46:54 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:46:54 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='2198b674-8838-4a8d-8597-e0cd9b18729e' game_id='09f9636b-cd09-486b-90d9-677fde984464' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 46, 52, 570195), last_update=datetime.datetime(2024, 12, 30, 22, 46, 52, 570218)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:46:54 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:46:54 | ERROR    | managers.agent_manager:process_game_state:279 - Error processing game state: 'async for' requires an object with __aiter__ method, got coroutine
2024-12-30 22:46:54 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: 'async for' requires an object with __aiter__ method, got coroutine
2024-12-30 22:50:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:50:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:50:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:50:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:50:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:50:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:50:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:50:06 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:50:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:50:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='2198b674-8838-4a8d-8597-e0cd9b18729e' game_id='09f9636b-cd09-486b-90d9-677fde984464' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 46, 52, 570195), last_update=datetime.datetime(2024, 12, 30, 22, 46, 52, 570218)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_current in namespace state
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:50:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:50:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_current.json
2024-12-30 22:50:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_current
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_09f9636b-cd09-486b-90d9-677fde984464_section_1 in namespace state
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:50:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:50:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:50:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\09f9636b-cd09-486b-90d9-677fde984464\states\game_09f9636b-cd09-486b-90d9-677fde984464_section_1.json
2024-12-30 22:50:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_09f9636b-cd09-486b-90d9-677fde984464_section_1
2024-12-30 22:50:06 | INFO     | managers.agent_manager:stop_game:382 - Final game state saved successfully
2024-12-30 22:50:06 | INFO     | managers.agent_manager:stop_game:384 - Game stopped successfully
2024-12-30 22:50:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:50:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:50:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:50:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:50:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:50:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:50:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:50:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:50:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:50:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:50:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:50:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:50:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:50:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:50:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:50:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:50:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:50:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:50:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:50:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:50:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:50:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:50:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:50:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:50:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:50:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:50:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:50:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:50:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:50:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:50:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:50:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:50:55 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:50:55 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:50:55 | DEBUG    | managers.agent_manager:stop_game:375 - No game ID set, nothing to save
2024-12-30 22:50:55 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:50:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:50:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:50:59 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:50:59 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:50:59 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:50:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:50:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:50:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:50:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:50:59 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:50:59 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:50:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:50:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:50:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:50:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:50:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:50:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:51:00 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:51:00 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:51:00 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:51:00 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:51:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:51:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:51:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:51:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:51:03 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:51:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:51:03 | ERROR    | api.app:shutdown_event:65 - Failed to shutdown API: 'AgentManager' object has no attribute 'stop_game'
2024-12-30 22:51:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:51:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:51:07 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:51:07 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:51:07 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:51:07 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:51:07 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:51:07 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:51:07 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:51:07 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:51:07 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:51:07 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:51:07 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:51:07 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:51:07 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:51:07 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:51:07 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:51:07 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:51:08 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:51:08 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:51:08 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:51:08 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:51:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:51:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:51:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:51:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:51:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:22 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:51:22 | INFO     | managers.agent_manager:get_story_workflow:287 - Getting story workflow
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_story_workflow:291 - Story graph not configured, configuring now
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_story_workflow:300 - Compiling workflow
2024-12-30 22:51:22 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:51:22 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:51:22 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:51:22 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 8f2a2a52-a1e3-47f1-a09a-96e3af460f9a
2024-12-30 22:51:22 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 8f2a2a52-a1e3-47f1-a09a-96e3af460f9a
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\traces
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters
2024-12-30 22:51:22 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 8f2a2a52-a1e3-47f1-a09a-96e3af460f9a
2024-12-30 22:51:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: afe6782d-fa5b-4f11-a260-eb464c4023da
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:51:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'afe6782d-fa5b-4f11-a260-eb464c4023da', 'game_id': '8f2a2a52-a1e3-47f1-a09a-96e3af460f9a', 'last_update': '2024-12-30T22:51:22.403523', 'character_id': 'current'}
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:22 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:51:22 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:51:22 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:51:22 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:51:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: bc34f25e-c54f-43db-875e-ecc6318f6871
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:51:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'bc34f25e-c54f-43db-875e-ecc6318f6871', 'game_id': '8f2a2a52-a1e3-47f1-a09a-96e3af460f9a', 'last_update': '2024-12-30T22:51:22.425720', 'character_id': 'current'}
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:22 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=bc34f25e-c54f-43db-875e-ecc6318f6871, game_id=8f2a2a52-a1e3-47f1-a09a-96e3af460f9a, section_number=1
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:22 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: bc34f25e-c54f-43db-875e-ecc6318f6871 and section_number: 1
2024-12-30 22:51:22 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:51:22 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:51:22 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:51:22 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:51:22 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:51:22 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:51:22 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:51:22 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:51:22 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:51:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:51:22 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:51:22 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:51:22 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:51:22 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:51:22 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:51:22 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:51:22 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:51:22 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:51:22 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:51:22 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:51:22 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:51:22 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:51:22 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:fd1d0e7a-af1b-161f-734c-707229ddf87d'], when='during'),)
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:22 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:51:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:51:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='afe6782d-fa5b-4f11-a260-eb464c4023da' game_id='8f2a2a52-a1e3-47f1-a09a-96e3af460f9a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 51, 22, 459740), last_update=datetime.datetime(2024, 12, 30, 22, 51, 22, 459757)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:51:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:22 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='afe6782d-fa5b-4f11-a260-eb464c4023da' game_id='8f2a2a52-a1e3-47f1-a09a-96e3af460f9a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 51, 22, 459740), last_update=datetime.datetime(2024, 12, 30, 22, 51, 22, 459757)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:51:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:51:24 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '8f2a2a52-a1e3-47f1-a09a-96e3af460f9a', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:51:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='8f2a2a52-a1e3-47f1-a09a-96e3af460f9a' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:51:24 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 22:51:24 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:51:24 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='afe6782d-fa5b-4f11-a260-eb464c4023da' game_id='8f2a2a52-a1e3-47f1-a09a-96e3af460f9a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 51, 22, 459740), last_update=datetime.datetime(2024, 12, 30, 22, 51, 22, 459757)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:51:24 | INFO     | managers.agent_manager:get_story_workflow:287 - Getting story workflow
2024-12-30 22:51:24 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:51:24 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 51, 22, 459740), last_update=datetime.datetime(2024, 12, 30, 22, 51, 22, 459757)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:51:24 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:51:24 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:51:24 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c777275b-f771-4ba2-a15b-e21332783f08
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\characters\current.json
2024-12-30 22:51:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:51:24 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c777275b-f771-4ba2-a15b-e21332783f08', 'game_id': '8f2a2a52-a1e3-47f1-a09a-96e3af460f9a', 'last_update': '2024-12-30T22:51:24.996131', 'character_id': 'current'}
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:25 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=c777275b-f771-4ba2-a15b-e21332783f08, game_id=8f2a2a52-a1e3-47f1-a09a-96e3af460f9a, section_number=1
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:25 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: c777275b-f771-4ba2-a15b-e21332783f08 and section_number: 1
2024-12-30 22:51:25 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:51:25 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:51:25 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:51:25 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:51:25 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:51:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:51:25 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:51:25 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:51:25 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:51:25 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:51:25 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:51:25 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:51:25 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:51:25 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:51:25 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 22:51:25 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:51:25 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:51:25 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:51:25 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:51:25 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:51:25 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:51:25 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 22:51:25 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 22:51:25 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 22:51:25 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=True, next_action=user_first
2024-12-30 22:51:25 | INFO     | agents.decision_agent:_process_decision:137 - Dice roll needed
2024-12-30 22:51:25 | INFO     | agents.decision_agent:ainvoke:191 - Decision processed successfully: next_section=None
2024-12-30 22:51:25 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=None
2024-12-30 22:51:25 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 22:51:25 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:25 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:51:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:51:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:51:25 | INFO     | managers.agent_manager:process_game_state:259 - Game state processed successfully
2024-12-30 22:51:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:52:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:52:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:52:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:52:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:52:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:52:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:52:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:52:47 | INFO     | managers.agent_manager:stop_game:359 - Stopping game...
2024-12-30 22:52:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:52:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='afe6782d-fa5b-4f11-a260-eb464c4023da' game_id='8f2a2a52-a1e3-47f1-a09a-96e3af460f9a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 51, 22, 459740), last_update=datetime.datetime(2024, 12, 30, 22, 51, 22, 459757)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 22, 51, 25, 120702)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current in namespace state
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:52:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:52:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current.json
2024-12-30 22:52:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_current
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1 in namespace state
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:52:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:52:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:52:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8f2a2a52-a1e3-47f1-a09a-96e3af460f9a\states\game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1.json
2024-12-30 22:52:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_8f2a2a52-a1e3-47f1-a09a-96e3af460f9a_section_1
2024-12-30 22:52:47 | INFO     | managers.agent_manager:stop_game:371 - Final game state saved successfully
2024-12-30 22:52:47 | INFO     | managers.agent_manager:stop_game:373 - Game stopped successfully
2024-12-30 22:52:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:52:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:52:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:52:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:52:52 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:52:52 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:52:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:52:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:52:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:52:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:52 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:52:52 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:52:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:52:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:52:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:52:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:52:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:52:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:52:53 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:52:53 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:52:53 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:52:53 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:52:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:52:53 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 22:52:53 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 22:52:53 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:52:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:52:53 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:52:53 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:52:53 | DEBUG    | managers.agent_manager:stop_game:375 - No game ID set, nothing to save
2024-12-30 22:52:53 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:52:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:52:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:52:56 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:52:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:52:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:52:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:52:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:52:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:52:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:52:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:52:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:52:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:52:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:52:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:52:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:52:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:52:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:52:57 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:52:57 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:52:57 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:52:57 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:52:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:52:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:52:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:52:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:52:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:52:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:52:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:52:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:52:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:53:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:53:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:53:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:53:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:53:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:53:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:05 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:53:05 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_story_workflow:302 - Story graph not configured, configuring now
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_story_workflow:311 - Compiling workflow
2024-12-30 22:53:05 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:53:05 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:53:05 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:53:05 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 5d232092-f974-4a16-b3ce-d73c6ba1b516
2024-12-30 22:53:05 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 5d232092-f974-4a16-b3ce-d73c6ba1b516
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\traces
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters
2024-12-30 22:53:05 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 5d232092-f974-4a16-b3ce-d73c6ba1b516
2024-12-30 22:53:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 483a4c92-c391-46ea-9224-3907e00a53dd
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:53:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '483a4c92-c391-46ea-9224-3907e00a53dd', 'game_id': '5d232092-f974-4a16-b3ce-d73c6ba1b516', 'last_update': '2024-12-30T22:53:05.697491', 'character_id': 'current'}
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:05 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:53:05 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:53:05 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:53:05 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:53:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ee54403c-7017-45b1-a8a0-6c0bc942e512
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:53:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ee54403c-7017-45b1-a8a0-6c0bc942e512', 'game_id': '5d232092-f974-4a16-b3ce-d73c6ba1b516', 'last_update': '2024-12-30T22:53:05.718120', 'character_id': 'current'}
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:05 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=ee54403c-7017-45b1-a8a0-6c0bc942e512, game_id=5d232092-f974-4a16-b3ce-d73c6ba1b516, section_number=1
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:05 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: ee54403c-7017-45b1-a8a0-6c0bc942e512 and section_number: 1
2024-12-30 22:53:05 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:53:05 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:53:05 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:53:05 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:53:05 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:53:05 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:53:05 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:53:05 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:53:05 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:53:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:53:05 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:53:05 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:53:05 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:53:05 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:53:05 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:53:05 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:53:05 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:53:05 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:53:05 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:53:05 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:53:05 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:53:05 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:53:05 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b4874817-7314-037d-fced-ff5ba3efa96c'], when='during'),)
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:05 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:53:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='483a4c92-c391-46ea-9224-3907e00a53dd' game_id='5d232092-f974-4a16-b3ce-d73c6ba1b516' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 53, 5, 752887), last_update=datetime.datetime(2024, 12, 30, 22, 53, 5, 752898)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:53:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:05 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='483a4c92-c391-46ea-9224-3907e00a53dd' game_id='5d232092-f974-4a16-b3ce-d73c6ba1b516' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 53, 5, 752887), last_update=datetime.datetime(2024, 12, 30, 22, 53, 5, 752898)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:53:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:53:07 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5d232092-f974-4a16-b3ce-d73c6ba1b516', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:53:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5d232092-f974-4a16-b3ce-d73c6ba1b516' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:53:07 | INFO     | managers.agent_manager:process_game_state:222 - Starting game state processing
2024-12-30 22:53:07 | DEBUG    | managers.agent_manager:process_game_state:231 - No state provided, getting current state
2024-12-30 22:53:07 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:07 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='483a4c92-c391-46ea-9224-3907e00a53dd' game_id='5d232092-f974-4a16-b3ce-d73c6ba1b516' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 53, 5, 752887), last_update=datetime.datetime(2024, 12, 30, 22, 53, 5, 752898)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:53:07 | INFO     | managers.agent_manager:get_story_workflow:298 - Getting story workflow
2024-12-30 22:53:07 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:53:07 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 53, 5, 752887), last_update=datetime.datetime(2024, 12, 30, 22, 53, 5, 752898)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 22:53:07 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:53:07 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:53:07 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 94c977f4-1c7d-4507-86a1-b7ee17b3a488
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\characters\current.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:53:07 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '94c977f4-1c7d-4507-86a1-b7ee17b3a488', 'game_id': '5d232092-f974-4a16-b3ce-d73c6ba1b516', 'last_update': '2024-12-30T22:53:07.432558', 'character_id': 'current'}
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:07 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=94c977f4-1c7d-4507-86a1-b7ee17b3a488, game_id=5d232092-f974-4a16-b3ce-d73c6ba1b516, section_number=1
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:07 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 94c977f4-1c7d-4507-86a1-b7ee17b3a488 and section_number: 1
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:07 | INFO     | managers.agent_manager:process_game_state:267 - Game state processed successfully
2024-12-30 22:53:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:53:43 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:53:43 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:43 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:53:43 | INFO     | managers.agent_manager:stop_game:370 - Stopping game...
2024-12-30 22:53:43 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:43 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='483a4c92-c391-46ea-9224-3907e00a53dd' game_id='5d232092-f974-4a16-b3ce-d73c6ba1b516' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 53, 5, 752887), last_update=datetime.datetime(2024, 12, 30, 22, 53, 5, 752898)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current in namespace state
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current.json
2024-12-30 22:53:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_current
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1 in namespace state
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5d232092-f974-4a16-b3ce-d73c6ba1b516\states\game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1.json
2024-12-30 22:53:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5d232092-f974-4a16-b3ce-d73c6ba1b516_section_1
2024-12-30 22:53:43 | INFO     | managers.agent_manager:stop_game:382 - Final game state saved successfully
2024-12-30 22:53:43 | INFO     | managers.agent_manager:stop_game:384 - Game stopped successfully
2024-12-30 22:53:43 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:53:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:53:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:53:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:53:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:53:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:53:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:53:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:53:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:53:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:53:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:53:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:53:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:53:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:53:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:53:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:53:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:53:49 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:53:49 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:53:49 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:53:49 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:53:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:49 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 22:53:49 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 22:53:49 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:53:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:49 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:53:49 | INFO     | managers.agent_manager:stop_game:359 - Stopping game...
2024-12-30 22:53:49 | DEBUG    | managers.agent_manager:stop_game:364 - No game ID set, nothing to save
2024-12-30 22:53:49 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:53:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:53:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:53:53 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:53:53 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:53:53 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:53:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:53:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:53:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:53:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:53:53 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:53:53 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:53:53 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:53:53 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:53:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:53:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:53:53 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:53:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:53:54 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:53:54 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:53:54 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:53:54 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:53:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:53:54 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:54 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:53:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:53:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:53:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:53:54 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:53:54 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:54:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:54:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:54:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:54:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:54:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:54:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:54:55 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:54:55 | INFO     | managers.agent_manager:stop_game:359 - Stopping game...
2024-12-30 22:54:55 | DEBUG    | managers.agent_manager:stop_game:364 - No game ID set, nothing to save
2024-12-30 22:54:55 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:54:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:54:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:54:59 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:54:59 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:54:59 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:54:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:54:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:54:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:54:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:54:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:54:59 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:54:59 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:54:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:54:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:54:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:54:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:54:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:54:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:54:59 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:54:59 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:54:59 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:55:00 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:55:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:55:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:55:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:55:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:55:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:55:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:55:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:55:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:55:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:55:12 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:12 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:55:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:12 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 22:55:12 | INFO     | managers.agent_manager:get_story_workflow:287 - Getting story workflow
2024-12-30 22:55:12 | DEBUG    | managers.agent_manager:get_story_workflow:291 - Story graph not configured, configuring now
2024-12-30 22:55:12 | DEBUG    | managers.agent_manager:get_story_workflow:300 - Compiling workflow
2024-12-30 22:55:12 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 22:55:12 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 22:55:12 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 22:55:12 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 54c86c99-a9ad-47fd-9473-181ca990073d
2024-12-30 22:55:12 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 54c86c99-a9ad-47fd-9473-181ca990073d
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\traces
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters
2024-12-30 22:55:12 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 54c86c99-a9ad-47fd-9473-181ca990073d
2024-12-30 22:55:12 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9a1c02ff-91bd-4294-8b79-35e5f6f31012
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:55:12 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9a1c02ff-91bd-4294-8b79-35e5f6f31012', 'game_id': '54c86c99-a9ad-47fd-9473-181ca990073d', 'last_update': '2024-12-30T22:55:12.997543', 'character_id': 'current'}
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:13 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:55:13 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:55:13 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:55:13 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:55:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0bf16559-c864-4122-b1f5-ad54d767b113
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:55:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0bf16559-c864-4122-b1f5-ad54d767b113', 'game_id': '54c86c99-a9ad-47fd-9473-181ca990073d', 'last_update': '2024-12-30T22:55:13.021144', 'character_id': 'current'}
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:13 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=0bf16559-c864-4122-b1f5-ad54d767b113, game_id=54c86c99-a9ad-47fd-9473-181ca990073d, section_number=1
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:13 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 0bf16559-c864-4122-b1f5-ad54d767b113 and section_number: 1
2024-12-30 22:55:13 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:55:13 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:55:13 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:55:13 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 22:55:13 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:55:13 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:55:13 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:55:13 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:55:13 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:55:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:55:13 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:55:13 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:55:13 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:55:13 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:55:13 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 22:55:13 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:55:13 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:55:13 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:55:13 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:55:13 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:55:13 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:55:13 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 22:55:13 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:f2b29431-94fa-bc52-a900-a4b21f2ae141'], when='during'),)
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:13 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 22:55:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:55:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:55:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9a1c02ff-91bd-4294-8b79-35e5f6f31012' game_id='54c86c99-a9ad-47fd-9473-181ca990073d' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 55, 13, 54659), last_update=datetime.datetime(2024, 12, 30, 22, 55, 13, 54670)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:55:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:55:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9a1c02ff-91bd-4294-8b79-35e5f6f31012' game_id='54c86c99-a9ad-47fd-9473-181ca990073d' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 55, 13, 54659), last_update=datetime.datetime(2024, 12, 30, 22, 55, 13, 54670)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:55:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 22:55:25 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '54c86c99-a9ad-47fd-9473-181ca990073d', 'choice_id': '398', 'choice_text': 'Continuer votre route', 'metadata': {'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 22:55:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='54c86c99-a9ad-47fd-9473-181ca990073d' choice_id='398' choice_text='Continuer votre route' metadata={'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 22:55:25 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 22:55:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:55:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9a1c02ff-91bd-4294-8b79-35e5f6f31012' game_id='54c86c99-a9ad-47fd-9473-181ca990073d' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 55, 13, 54659), last_update=datetime.datetime(2024, 12, 30, 22, 55, 13, 54670)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 22:55:25 | INFO     | managers.agent_manager:get_story_workflow:287 - Getting story workflow
2024-12-30 22:55:25 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 22:55:25 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 55, 13, 54659), last_update=datetime.datetime(2024, 12, 30, 22, 55, 13, 54670)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input='Continuer votre route' content=None
2024-12-30 22:55:25 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 22:55:25 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 22:55:25 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9099eed9-b6a8-4ae1-8194-5a9e8d8b12f5
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\characters\current.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 22:55:25 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9099eed9-b6a8-4ae1-8194-5a9e8d8b12f5', 'game_id': '54c86c99-a9ad-47fd-9473-181ca990073d', 'last_update': '2024-12-30T22:55:25.638321', 'character_id': 'current'}
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:25 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=9099eed9-b6a8-4ae1-8194-5a9e8d8b12f5, game_id=54c86c99-a9ad-47fd-9473-181ca990073d, section_number=1
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:25 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 9099eed9-b6a8-4ae1-8194-5a9e8d8b12f5 and section_number: 1
2024-12-30 22:55:25 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 22:55:25 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 22:55:25 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 22:55:25 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 22:55:25 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 22:55:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 22:55:25 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 22:55:25 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 22:55:25 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 22:55:25 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 22:55:25 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 22:55:25 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 22:55:25 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 22:55:25 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 22:55:25 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 22:55:25 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 22:55:25 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 22:55:25 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 22:55:25 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 22:55:25 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 22:55:25 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 22:55:25 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Continuer votre route
2024-12-30 22:55:25 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Continuer votre route
2024-12-30 22:55:25 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Continuer votre route
2024-12-30 22:55:25 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=True, next_action=user_first
2024-12-30 22:55:25 | INFO     | agents.decision_agent:_process_decision:137 - Dice roll needed
2024-12-30 22:55:25 | INFO     | agents.decision_agent:ainvoke:191 - Decision processed successfully: next_section=None
2024-12-30 22:55:25 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=None
2024-12-30 22:55:25 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 22:55:25 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:25 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:55:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:55:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:55:25 | INFO     | managers.agent_manager:process_game_state:259 - Game state processed successfully
2024-12-30 22:55:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 22:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:58:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:58:44 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:58:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:58:44 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:58:44 | INFO     | managers.agent_manager:stop_game:359 - Stopping game...
2024-12-30 22:58:44 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:58:44 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='9a1c02ff-91bd-4294-8b79-35e5f6f31012' game_id='54c86c99-a9ad-47fd-9473-181ca990073d' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 22, 55, 13, 54659), last_update=datetime.datetime(2024, 12, 30, 22, 55, 13, 54670)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 22, 55, 25, 747421)) error=None section_number=1 player_input='Continuer votre route' content=None
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_current in namespace state
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:58:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:58:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_current.json
2024-12-30 22:58:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_current
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1 in namespace state
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 22:58:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:58:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:58:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\54c86c99-a9ad-47fd-9473-181ca990073d\states\game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1.json
2024-12-30 22:58:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_54c86c99-a9ad-47fd-9473-181ca990073d_section_1
2024-12-30 22:58:44 | INFO     | managers.agent_manager:stop_game:371 - Final game state saved successfully
2024-12-30 22:58:44 | INFO     | managers.agent_manager:stop_game:373 - Game stopped successfully
2024-12-30 22:58:44 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:58:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:58:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:58:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:58:51 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:58:51 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:58:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:58:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:58:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:58:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:58:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:58:51 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:58:51 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:58:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:58:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:58:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:58:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:58:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:58:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:58:52 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:58:52 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:58:52 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:58:52 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:58:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:58:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:58:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:58:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:58:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:58:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:58:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:58:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:58:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 22:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 22:59:05 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 22:59:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:59:05 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 22:59:05 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 22:59:05 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 22:59:05 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 22:59:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:59:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 22:59:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 22:59:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 22:59:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 22:59:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 22:59:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:59:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 22:59:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 22:59:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 22:59:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 22:59:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 22:59:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 22:59:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 22:59:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 22:59:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 22:59:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 22:59:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 22:59:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 22:59:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 22:59:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 22:59:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 22:59:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:59:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:59:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:59:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 22:59:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 22:59:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 22:59:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 22:59:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 22:59:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:02:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:02:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:02:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:02:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:02:42 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:02:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:02:42 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:02:42 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:02:42 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:02:42 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:02:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:02:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:02:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:02:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:02:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:02:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:02:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:02:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:02:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:02:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:02:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:02:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:02:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:02:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:02:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:02:47 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:02:47 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:02:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:02:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:02:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:02:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:02:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:02:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:02:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:02:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:02:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:02:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:02:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:02:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:02:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:02:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:02:49 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:02:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:02:49 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:02:49 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:02:49 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:02:49 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:02:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:53 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:02:53 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:02:53 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:02:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:02:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:02:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:02:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:53 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:02:53 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:02:53 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:02:53 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:02:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:02:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:02:53 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:02:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:02:55 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:02:55 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:02:55 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:02:55 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:02:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:02:55 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 23:02:55 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 23:02:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:02:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:02:55 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:02:55 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:02:55 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:02:55 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:02:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:02:58 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:02:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:02:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:02:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:02:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:02:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:02:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:02:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:02:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:02:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:02:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:02:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:02:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:02:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:02:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:02:59 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:02:59 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:02:59 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:02:59 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:02:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:02:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:02:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:02:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:02:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:02:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:02:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:02:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:02:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:03:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:03:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:03:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:03:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:03:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:03:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:03:55 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:03:55 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:03:55 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:03:55 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:03:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:04:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:04:00 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:04:00 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:04:00 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:04:00 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:04:00 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:00 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:04:00 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:04:00 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:00 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:04:00 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:04:00 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:04:00 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:04:00 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:04:00 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:04:00 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:04:00 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:04:01 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:04:01 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:04:01 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:04:01 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:04:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:04:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:04:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:04:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:04:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:04:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:04:22 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:04:22 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:04:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:04:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:04:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:04:25 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:04:25 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:04:25 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:04:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:04:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:04:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:04:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:04:25 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:04:25 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:04:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:04:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:04:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:04:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:04:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:04:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:04:26 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:04:26 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:04:26 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:04:26 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:04:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:26 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:26 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:04:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:04:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:04:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:04:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:32 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:04:32 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:04:32 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:04:32 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:04:32 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:04:32 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:04:32 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:04:32 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: a2103b55-c78e-4b5f-83bd-23b2131929dd
2024-12-30 23:04:32 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a2103b55-c78e-4b5f-83bd-23b2131929dd
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\traces
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters
2024-12-30 23:04:32 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: a2103b55-c78e-4b5f-83bd-23b2131929dd
2024-12-30 23:04:32 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: cbcf451d-992a-4f82-a200-3b0404e9e200
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:04:32 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'cbcf451d-992a-4f82-a200-3b0404e9e200', 'game_id': 'a2103b55-c78e-4b5f-83bd-23b2131929dd', 'last_update': '2024-12-30T23:04:32.387387', 'character_id': 'current'}
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:04:32 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:04:32 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:04:32 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:04:32 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:04:32 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: da0313c5-9cc7-4b0a-b351-f4b6a7b0f4ae
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:04:32 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'da0313c5-9cc7-4b0a-b351-f4b6a7b0f4ae', 'game_id': 'a2103b55-c78e-4b5f-83bd-23b2131929dd', 'last_update': '2024-12-30T23:04:32.451109', 'character_id': 'current'}
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:04:32 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=da0313c5-9cc7-4b0a-b351-f4b6a7b0f4ae, game_id=a2103b55-c78e-4b5f-83bd-23b2131929dd, section_number=1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:04:32 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: da0313c5-9cc7-4b0a-b351-f4b6a7b0f4ae and section_number: 1
2024-12-30 23:04:32 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:04:32 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 23:04:32 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 23:04:32 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:04:32 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 1
2024-12-30 23:04:32 | DEBUG    | agents.rules_agent:_process_section_rules:61 - No content provided, fetching raw content
2024-12-30 23:04:32 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:04:32 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:04:32 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:04:32 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:04:32 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 1
2024-12-30 23:04:32 | DEBUG    | agents.narrator_agent:_process_section:58 - No raw content provided, fetching from manager
2024-12-30 23:04:32 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:04:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:04:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:04:32 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 1
2024-12-30 23:04:32 | INFO     | agents.rules_agent:_process_section_rules:73 - Analyzing rules for section 1 with LLM
2024-12-30 23:04:32 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:106 - Starting LLM extraction for section 1
2024-12-30 23:04:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:04:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:04:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:04:34 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:04:34 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 1
2024-12-30 23:04:34 | INFO     | agents.narrator_agent:_process_section:66 - Processing content for section 1 with LLM
2024-12-30 23:04:34 | DEBUG    | agents.narrator_agent:_process_content:98 - Starting content processing with LLM
2024-12-30 23:04:34 | DEBUG    | agents.narrator_agent:_process_content:99 - Preparing messages for LLM with section 1 and content length 2540
2024-12-30 23:04:34 | DEBUG    | agents.narrator_agent:_process_content:106 - Sending request to LLM
2024-12-30 23:04:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:185 - Processed choices: [{'text': "Engager la procÃ©dure d'Ã©vasion", 'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}, {'text': 'Continuer votre route', 'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}]
2024-12-30 23:04:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:189 - Created RulesModel: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=True needs_user_response=True next_action='user_first' conditions=[] choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)
2024-12-30 23:04:45 | DEBUG    | agents.rules_agent:_process_section_rules:78 - Analysis successful, saving to cache
2024-12-30 23:04:45 | INFO     | managers.rules_manager:save_rules:108 - Saving rules for section 1
2024-12-30 23:04:45 | DEBUG    | managers.rules_manager:_rules_to_markdown:136 - Converting rules to markdown for section 1
2024-12-30 23:04:45 | DEBUG    | managers.rules_manager:_format_choices:171 - Formatting 2 choices
2024-12-30 23:04:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1_rules in namespace rules
2024-12-30 23:04:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:04:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:04:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for rules/section_1_rules
2024-12-30 23:04:45 | DEBUG    | managers.rules_manager:save_rules:117 - Rules saved successfully for section 1
2024-12-30 23:04:45 | INFO     | agents.rules_agent:_process_section_rules:83 - Rules saved successfully
2024-12-30 23:04:45 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 23:04:45 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:_process_content:108 - Received response from LLM: {
    "content": "# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous exa...
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsing JSON response
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:_process_content:127 - Parsed JSON data: {'content': "# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': 'processed', 'error': None}
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:_process_content:145 - Creating NarratorModel
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:_process_content:152 - Successfully created NarratorModel: section_number=1 content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561) last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)
2024-12-30 23:04:48 | INFO     | managers.narrator_manager:save_content:108 - Saving content for section 1
2024-12-30 23:04:48 | DEBUG    | managers.narrator_manager:_narrator_to_markdown:183 - Converting NarratorModel to markdown for section 1
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace sections
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:04:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for sections/section_1
2024-12-30 23:04:48 | DEBUG    | managers.narrator_manager:save_content:125 - Content saved successfully for section 1
2024-12-30 23:04:48 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:04:48 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:04:48 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:04:48 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:04:48 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:e489e1cd-08e3-cd57-cd89-c11021b7d4ae'], when='during'),)
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:04:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:04:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:04:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:04:48 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:04:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:04:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:04:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='cbcf451d-992a-4f82-a200-3b0404e9e200' game_id='a2103b55-c78e-4b5f-83bd-23b2131929dd' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561), last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:04:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:04:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:04:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='cbcf451d-992a-4f82-a200-3b0404e9e200' game_id='a2103b55-c78e-4b5f-83bd-23b2131929dd' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561), last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 23:05:18 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'a2103b55-c78e-4b5f-83bd-23b2131929dd', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 23:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='a2103b55-c78e-4b5f-83bd-23b2131929dd' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 23:05:18 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 23:05:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:05:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='cbcf451d-992a-4f82-a200-3b0404e9e200' game_id='a2103b55-c78e-4b5f-83bd-23b2131929dd' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561), last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:05:18 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:05:18 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:05:18 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561), last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:05:18 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:05:18 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:05:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 852366dc-f039-4508-a6da-5528894c7314
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\characters\current.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:05:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '852366dc-f039-4508-a6da-5528894c7314', 'game_id': 'a2103b55-c78e-4b5f-83bd-23b2131929dd', 'last_update': '2024-12-30T23:05:18.142777', 'character_id': 'current'}
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:05:18 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=852366dc-f039-4508-a6da-5528894c7314, game_id=a2103b55-c78e-4b5f-83bd-23b2131929dd, section_number=1
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:05:18 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 852366dc-f039-4508-a6da-5528894c7314 and section_number: 1
2024-12-30 23:05:18 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:05:18 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 23:05:18 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 23:05:18 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:04:45.403025', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:05:18 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:05:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:05:18 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:05:18 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:05:18 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 23:05:18 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 23:05:18 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:05:18 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:05:18 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:05:18 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:05:18 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:05:18 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:05:18 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:05:18 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:05:18 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:05:18 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:05:18 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:05:18 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:05:18 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:05:18 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:05:18 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=True, next_action=user_first
2024-12-30 23:05:18 | INFO     | agents.decision_agent:_process_decision:137 - Dice roll needed
2024-12-30 23:05:18 | INFO     | agents.decision_agent:ainvoke:191 - Decision processed successfully: next_section=None
2024-12-30 23:05:18 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=None
2024-12-30 23:05:18 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 23:05:18 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:05:18 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:05:18 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-30 23:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 23:16:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:16:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:16:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:16:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:16:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:16:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:16:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:16:46 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:16:46 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:16:46 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='cbcf451d-992a-4f82-a200-3b0404e9e200' game_id='a2103b55-c78e-4b5f-83bd-23b2131929dd' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. \n\nIl ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. Le circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre. \n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es, car seul compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 4, 48, 416561), last_update=datetime.datetime(2024, 12, 30, 23, 4, 48, 416563)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 4, 45, 403025)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 23, 5, 18, 187547)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current in namespace state
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:16:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:16:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current.json
2024-12-30 23:16:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_current
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1 in namespace state
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:16:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:16:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:16:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a2103b55-c78e-4b5f-83bd-23b2131929dd\states\game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1.json
2024-12-30 23:16:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a2103b55-c78e-4b5f-83bd-23b2131929dd_section_1
2024-12-30 23:16:46 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:16:46 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:16:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:16:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:16:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:16:53 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:16:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:16:54 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:16:54 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:16:54 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:16:54 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:16:54 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:16:54 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:16:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:16:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:16:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:16:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:16:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:16:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:16:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:16:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:16:55 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:16:55 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:16:55 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:16:55 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:16:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:16:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:16:55 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:16:55 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:16:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:16:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:16:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:16:55 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:16:55 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:17:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:17:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:17:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:17:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:17:01 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:17:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:17:01 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:17:01 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:17:01 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:17:01 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:17:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:17:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:17:06 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:17:06 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:17:06 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:17:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:17:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:17:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:17:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:06 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:17:06 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:17:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:17:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:17:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:17:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:17:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:17:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:17:07 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:17:07 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:17:07 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:17:07 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:17:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:17:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:17:07 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:17:07 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:17:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:17:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:17:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:17:07 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:17:07 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:17:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:17:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:17:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:17:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:17:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:17:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:17:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:17:11 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:17:11 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:17:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:17:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:17:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:17:17 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:17:17 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:17:17 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:17:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:17:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:17:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:17:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:17:17 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:17:17 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:17:17 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:17:17 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:17:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:17:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:17:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:17:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:17:19 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:17:19 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:17:19 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:17:19 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:17:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:17:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:17:19 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:17:19 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:17:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:17:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:17:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:17:19 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:17:19 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:21:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:21:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:21:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:21:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:21:52 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:21:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:21:52 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:21:52 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:21:52 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:21:52 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:21:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:21:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:21:58 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:21:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:21:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:21:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:21:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:21:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:21:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:21:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:21:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:21:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:21:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:21:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:21:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:21:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:21:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:21:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:21:59 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:21:59 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:21:59 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:21:59 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:21:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:21:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:21:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:21:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:21:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:21:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:21:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:21:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:21:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:23:17 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:23:17 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:23:17 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:23:17 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:23:17 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:23:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:23:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:23:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:23:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:23:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:23:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:23:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:23:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:23:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:23:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:23:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:23:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:23:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:23:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:23:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:23:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:23:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:23:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:23:21 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:23:21 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:23:21 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:23:21 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:23:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:23:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:23:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:23:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:23:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:05 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:24:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:05 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:24:05 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:24:05 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:24:05 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:24:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:24:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:24:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:24:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:24:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:24:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:24:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:24:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:24:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:24:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:24:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:24:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:24:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:24:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:24:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:24:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:24:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:24:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:24:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:11 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 23:24:11 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 23:24:11 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:24:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:24:11 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:24:11 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:24:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:24:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:24:14 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:24:14 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:24:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:24:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:24:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:24:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:14 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:24:14 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:24:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:24:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:24:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:24:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:24:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:24:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:24:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:24:14 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:24:14 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:24:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:24:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:21 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:24:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:21 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:24:21 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:24:21 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:24:21 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:24:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:24 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:24:24 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:24:24 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:24:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:24:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:24:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:24:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:24 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:24:24 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:24:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:24:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:24:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:24:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:24:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:24:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:24:25 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:24:25 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:24:25 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:24:25 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:24:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:25 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:25 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:32 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:24:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:32 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:24:32 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:24:32 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:24:32 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:24:33 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:24:36 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:24:36 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:24:36 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:24:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:24:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:24:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:24:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:24:36 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:24:36 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:24:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:24:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:24:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:24:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:24:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:24:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:24:37 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:24:37 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:24:37 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:24:37 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:37 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:37 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:39 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:24:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:24:40 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:24:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:24:40 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:24:40 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:24:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:24:44 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:24:44 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:24:44 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:24:44 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:24:44 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:24:44 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:24:44 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:24:44 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 9e79d82d-066d-4778-a2ef-265ce1b0d9d5
2024-12-30 23:24:44 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 9e79d82d-066d-4778-a2ef-265ce1b0d9d5
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\traces
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters
2024-12-30 23:24:44 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 9e79d82d-066d-4778-a2ef-265ce1b0d9d5
2024-12-30 23:24:44 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7992ee92-1d45-40fe-814d-828f0e1be3c5
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:24:44 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7992ee92-1d45-40fe-814d-828f0e1be3c5', 'game_id': '9e79d82d-066d-4778-a2ef-265ce1b0d9d5', 'last_update': '2024-12-30T23:24:44.968501', 'character_id': 'current'}
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current in namespace state
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1 in namespace state
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1
2024-12-30 23:24:44 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:24:44 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:24:44 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:24:44 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:24:44 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 440e172f-195d-411f-8479-ca90635e2120
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\characters\current.json
2024-12-30 23:24:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:24:44 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '440e172f-195d-411f-8479-ca90635e2120', 'game_id': '9e79d82d-066d-4778-a2ef-265ce1b0d9d5', 'last_update': '2024-12-30T23:24:44.998065', 'character_id': 'current'}
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current in namespace state
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1 in namespace state
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1
2024-12-30 23:24:45 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=440e172f-195d-411f-8479-ca90635e2120, game_id=9e79d82d-066d-4778-a2ef-265ce1b0d9d5, section_number=1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current in namespace state
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:24:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1 in namespace state
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:24:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1
2024-12-30 23:24:45 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 440e172f-195d-411f-8479-ca90635e2120 and section_number: 1
2024-12-30 23:24:45 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:24:45 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:24:45 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:24:45 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:24:45 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 1
2024-12-30 23:24:45 | DEBUG    | agents.rules_agent:_process_section_rules:63 - No content provided, fetching raw content
2024-12-30 23:24:45 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:24:45 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:24:45 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:24:45 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:24:45 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 1
2024-12-30 23:24:45 | DEBUG    | agents.narrator_agent:_process_section:58 - No raw content provided, fetching from manager
2024-12-30 23:24:45 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:24:45 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:24:45 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:24:45 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 1
2024-12-30 23:24:45 | INFO     | agents.rules_agent:_process_section_rules:75 - Analyzing rules for section 1 with LLM
2024-12-30 23:24:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:108 - Starting LLM extraction for section 1
2024-12-30 23:24:46 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:24:46 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:24:46 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:24:46 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:24:46 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 1
2024-12-30 23:24:46 | INFO     | agents.narrator_agent:_process_section:66 - Processing content for section 1 with LLM
2024-12-30 23:24:46 | DEBUG    | agents.narrator_agent:_process_content:98 - Starting content processing with LLM
2024-12-30 23:24:46 | DEBUG    | agents.narrator_agent:_process_content:99 - Preparing messages for LLM with section 1 and content length 2540
2024-12-30 23:24:46 | DEBUG    | agents.narrator_agent:_process_content:106 - Sending request to LLM
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:_process_content:108 - Received response from LLM: {
    "content": "# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous exa...
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsing JSON response
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:_process_content:127 - Parsed JSON data: {'content': "# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': 'processed', 'error': None}
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:_process_content:145 - Creating NarratorModel
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:_process_content:152 - Successfully created NarratorModel: section_number=1 content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 30, 23, 24, 57, 503646) last_update=datetime.datetime(2024, 12, 30, 23, 24, 57, 503650)
2024-12-30 23:24:57 | INFO     | managers.narrator_manager:save_content:108 - Saving content for section 1
2024-12-30 23:24:57 | DEBUG    | managers.narrator_manager:_narrator_to_markdown:183 - Converting NarratorModel to markdown for section 1
2024-12-30 23:24:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace sections
2024-12-30 23:24:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:24:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:24:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:24:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for sections/section_1
2024-12-30 23:24:57 | DEBUG    | managers.narrator_manager:save_content:125 - Content saved successfully for section 1
2024-12-30 23:24:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:24:57 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:25:03 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:153 - Forced needs_dice to False because dice_type is none
2024-12-30 23:25:03 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:192 - Processed choices: [{'text': "Engager la procÃ©dure d'Ã©vasion", 'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}, {'text': 'Continuer votre route', 'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}]
2024-12-30 23:25:03 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:196 - Created RulesModel: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=True needs_user_response=True next_action='user_first' conditions=[] choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 30, 23, 25, 3, 205549)
2024-12-30 23:25:03 | DEBUG    | agents.rules_agent:_process_section_rules:80 - Analysis successful, saving to cache
2024-12-30 23:25:03 | INFO     | managers.rules_manager:save_rules:108 - Saving rules for section 1
2024-12-30 23:25:03 | DEBUG    | managers.rules_manager:_rules_to_markdown:136 - Converting rules to markdown for section 1
2024-12-30 23:25:03 | DEBUG    | managers.rules_manager:_format_choices:171 - Formatting 2 choices
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1_rules in namespace rules
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:25:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for rules/section_1_rules
2024-12-30 23:25:03 | DEBUG    | managers.rules_manager:save_rules:117 - Rules saved successfully for section 1
2024-12-30 23:25:03 | INFO     | agents.rules_agent:_process_section_rules:85 - Rules saved successfully
2024-12-30 23:25:03 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:25:03 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:25:03 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:25:03 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:25:03 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:216bc81e-5f79-74ec-9513-4d65348481dc'], when='during'),)
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current in namespace state
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1 in namespace state
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:25:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1
2024-12-30 23:25:03 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:25:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:25:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:25:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:25:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:25:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7992ee92-1d45-40fe-814d-828f0e1be3c5' game_id='9e79d82d-066d-4778-a2ef-265ce1b0d9d5' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 24, 57, 503646), last_update=datetime.datetime(2024, 12, 30, 23, 24, 57, 503650)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 25, 3, 205549)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:25:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:25:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:25:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7992ee92-1d45-40fe-814d-828f0e1be3c5' game_id='9e79d82d-066d-4778-a2ef-265ce1b0d9d5' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 24, 57, 503646), last_update=datetime.datetime(2024, 12, 30, 23, 24, 57, 503650)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 25, 3, 205549)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:25:36 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:25:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:25:36 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:25:36 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:25:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:25:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7992ee92-1d45-40fe-814d-828f0e1be3c5' game_id='9e79d82d-066d-4778-a2ef-265ce1b0d9d5' narrative=NarratorModel(section_number=1, content="# Section 1\n\nVous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 24, 57, 503646), last_update=datetime.datetime(2024, 12, 30, 23, 24, 57, 503650)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 25, 3, 205549)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current in namespace state
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current.json
2024-12-30 23:25:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_current
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1 in namespace state
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:25:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9e79d82d-066d-4778-a2ef-265ce1b0d9d5\states\game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1.json
2024-12-30 23:25:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9e79d82d-066d-4778-a2ef-265ce1b0d9d5_section_1
2024-12-30 23:25:36 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:25:36 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:25:36 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:25:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:25:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:25:40 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:25:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:25:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:25:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:25:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:25:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:25:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:25:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:25:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:25:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:25:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:25:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:25:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:25:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:25:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:25:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:25:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:25:41 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:25:41 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:25:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:25:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:25:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:25:41 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:25:41 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:25:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:25:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:25:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:25:41 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:25:41 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:27:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:27:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:27:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:27:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:27:59 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:27:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:27:59 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:27:59 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:27:59 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:27:59 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:28:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:28:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:28:04 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:28:05 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:28:05 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:28:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:28:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:28:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:28:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:28:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:28:05 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:28:05 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:28:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:28:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:28:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:28:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:28:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:28:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:28:06 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:28:06 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:28:06 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:28:06 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:28:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:28:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:28:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:28:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:28:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:28:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:28:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:28:06 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:28:06 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:29:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:29:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:29:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:29:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:29:30 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:29:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:29:30 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:29:30 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:29:30 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:29:30 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:29:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:29:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:29:34 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:29:34 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:29:34 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:29:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:29:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:29:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:29:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:29:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:29:34 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:29:34 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:29:34 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:29:34 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:29:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:29:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:29:34 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:29:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:29:35 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:29:35 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:29:35 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:29:35 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:29:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:29:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:29:35 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:29:35 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:29:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:29:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:29:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:29:35 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:29:35 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:30:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:30:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:30:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:30:15 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:30:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:15 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:30:15 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:30:15 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:30:15 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:30:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:30:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:30:18 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:30:18 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:30:18 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:30:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:30:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:30:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:30:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:30:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:30:18 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:30:18 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:30:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:30:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:30:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:30:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:30:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:30:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:30:19 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:30:19 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:30:19 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:30:19 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:30:19 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:19 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:30:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:30:19 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:19 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:30:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:20 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:30:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:30:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:30:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:30:21 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:21 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:30:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:23 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:30:23 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:30:23 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:30:23 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:30:23 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:30:23 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:30:23 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:30:23 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: d874ac5b-8f07-4aae-baba-065f8f8a44f2
2024-12-30 23:30:23 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d874ac5b-8f07-4aae-baba-065f8f8a44f2
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\traces
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters
2024-12-30 23:30:23 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: d874ac5b-8f07-4aae-baba-065f8f8a44f2
2024-12-30 23:30:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 36c9e13a-452c-46ff-975b-e5b2d7925484
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:30:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '36c9e13a-452c-46ff-975b-e5b2d7925484', 'game_id': 'd874ac5b-8f07-4aae-baba-065f8f8a44f2', 'last_update': '2024-12-30T23:30:23.920196', 'character_id': 'current'}
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1 in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1
2024-12-30 23:30:23 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:30:23 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:30:23 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:30:23 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:30:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0b0cda45-7f3e-4ded-b594-da76ac705bc5
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\characters\current.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:30:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0b0cda45-7f3e-4ded-b594-da76ac705bc5', 'game_id': 'd874ac5b-8f07-4aae-baba-065f8f8a44f2', 'last_update': '2024-12-30T23:30:23.951945', 'character_id': 'current'}
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1 in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1
2024-12-30 23:30:23 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=0b0cda45-7f3e-4ded-b594-da76ac705bc5, game_id=d874ac5b-8f07-4aae-baba-065f8f8a44f2, section_number=1
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1 in namespace state
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1
2024-12-30 23:30:23 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 0b0cda45-7f3e-4ded-b594-da76ac705bc5 and section_number: 1
2024-12-30 23:30:23 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:30:23 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:30:23 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:30:23 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:23 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:23 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:30:23 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 1
2024-12-30 23:30:23 | DEBUG    | agents.rules_agent:_process_section_rules:63 - No content provided, fetching raw content
2024-12-30 23:30:23 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 1
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:30:24 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:30:24 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:30:24 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:30:24 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:30:24 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:30:24 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:30:24 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:30:24 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:30:24 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:30:24 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:30:24 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:30:24 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 1
2024-12-30 23:30:24 | INFO     | agents.rules_agent:_process_section_rules:75 - Analyzing rules for section 1 with LLM
2024-12-30 23:30:24 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:108 - Starting LLM extraction for section 1
2024-12-30 23:30:31 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:153 - Forced needs_dice to False because dice_type is none
2024-12-30 23:30:31 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:192 - Processed choices: [{'text': "Engager la procÃ©dure d'Ã©vasion", 'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}, {'text': 'Continuer votre route', 'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}]
2024-12-30 23:30:31 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:196 - Created RulesModel: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=True needs_user_response=True next_action='user_first' conditions=[] choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 30, 23, 30, 31, 855175)
2024-12-30 23:30:31 | DEBUG    | agents.rules_agent:_process_section_rules:80 - Analysis successful, saving to cache
2024-12-30 23:30:31 | INFO     | managers.rules_manager:save_rules:108 - Saving rules for section 1
2024-12-30 23:30:31 | DEBUG    | managers.rules_manager:_rules_to_markdown:136 - Converting rules to markdown for section 1
2024-12-30 23:30:31 | DEBUG    | managers.rules_manager:_format_choices:171 - Formatting 2 choices
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1_rules in namespace rules
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:30:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for rules/section_1_rules
2024-12-30 23:30:31 | DEBUG    | managers.rules_manager:save_rules:117 - Rules saved successfully for section 1
2024-12-30 23:30:31 | INFO     | agents.rules_agent:_process_section_rules:85 - Rules saved successfully
2024-12-30 23:30:31 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:30:31 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:30:31 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:30:31 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:30:31 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:c9761372-aa4e-7dc2-8666-95428c11a52c'], when='during'),)
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current in namespace state
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:30:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1 in namespace state
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:30:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:30:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1
2024-12-30 23:30:31 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:30:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:30:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:30:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='36c9e13a-452c-46ff-975b-e5b2d7925484' game_id='d874ac5b-8f07-4aae-baba-065f8f8a44f2' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 30, 24, 19369), last_update=datetime.datetime(2024, 12, 30, 23, 30, 24, 20088)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 30, 31, 855175)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:30:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:30:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:30:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='36c9e13a-452c-46ff-975b-e5b2d7925484' game_id='d874ac5b-8f07-4aae-baba-065f8f8a44f2' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 30, 24, 19369), last_update=datetime.datetime(2024, 12, 30, 23, 30, 24, 20088)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 30, 31, 855175)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:33:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:33:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:33:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:33:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:33:23 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:33:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:33:23 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:33:23 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:33:23 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:33:23 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='36c9e13a-452c-46ff-975b-e5b2d7925484' game_id='d874ac5b-8f07-4aae-baba-065f8f8a44f2' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 30, 24, 19369), last_update=datetime.datetime(2024, 12, 30, 23, 30, 24, 20088)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 30, 31, 855175)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current in namespace state
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:33:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:33:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current.json
2024-12-30 23:33:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_current
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1 in namespace state
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:33:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:33:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:33:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d874ac5b-8f07-4aae-baba-065f8f8a44f2\states\game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1.json
2024-12-30 23:33:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d874ac5b-8f07-4aae-baba-065f8f8a44f2_section_1
2024-12-30 23:33:23 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:33:23 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:33:23 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:33:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:33:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:33:29 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:33:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:33:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:33:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:33:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:33:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:33:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:33:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:33:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:33:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:33:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:33:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:33:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:33:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:33:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:33:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:33:31 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:33:31 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:33:31 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:33:31 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:33:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:33:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:33:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:33:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:33:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:36:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:36:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:36:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:36:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:36:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:36:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:36:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:36:04 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:36:04 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:36:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:36:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:36:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:36:12 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:36:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:36:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:36:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:36:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:36:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:36:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:36:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:36:12 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:36:12 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:36:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:36:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:36:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:36:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:36:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:36:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:36:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:36:14 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:36:14 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:36:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:36:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:36:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:36:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:36:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:36:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:36:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:36:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:36:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:36:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:03 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:37:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:37:03 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:37:03 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:37:03 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:37:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:37:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:37:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:37:09 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:37:09 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:37:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:37:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:37:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:37:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:09 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:37:09 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:37:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:37:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:37:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:37:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:37:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:37:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:37:10 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:37:10 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:37:10 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:37:10 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:10 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:10 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:10 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:10 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:21 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:37:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:21 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:37:21 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:37:21 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:37:21 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:37:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:37:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:37:28 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:37:28 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:37:28 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:37:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:37:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:37:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:37:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:37:28 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:37:28 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:37:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:37:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:37:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:37:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:37:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:37:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:37:29 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:37:29 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:37:29 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:37:29 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:37:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:47 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:37:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:37:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:37:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:37:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:37:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:37:48 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:37:48 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:38:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:38:02 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:38:02 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:38:02 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:38:02 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:38:02 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:38:02 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:38:02 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:38:02 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 38fcddf7-fb44-4ff3-9d2f-49192f7628bc
2024-12-30 23:38:02 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 38fcddf7-fb44-4ff3-9d2f-49192f7628bc
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\traces
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters
2024-12-30 23:38:02 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 38fcddf7-fb44-4ff3-9d2f-49192f7628bc
2024-12-30 23:38:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7f31401c-3980-48d0-aa86-2b7744f896aa
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:38:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7f31401c-3980-48d0-aa86-2b7744f896aa', 'game_id': '38fcddf7-fb44-4ff3-9d2f-49192f7628bc', 'last_update': '2024-12-30T23:38:02.393883', 'character_id': 'current'}
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1 in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1
2024-12-30 23:38:02 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:38:02 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:38:02 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:38:02 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:38:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b94965ce-627c-46dd-95a4-990d0c1d08d9
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\characters\current.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:38:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b94965ce-627c-46dd-95a4-990d0c1d08d9', 'game_id': '38fcddf7-fb44-4ff3-9d2f-49192f7628bc', 'last_update': '2024-12-30T23:38:02.430308', 'character_id': 'current'}
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1 in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1
2024-12-30 23:38:02 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=b94965ce-627c-46dd-95a4-990d0c1d08d9, game_id=38fcddf7-fb44-4ff3-9d2f-49192f7628bc, section_number=1
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1 in namespace state
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1
2024-12-30 23:38:02 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: b94965ce-627c-46dd-95a4-990d0c1d08d9 and section_number: 1
2024-12-30 23:38:02 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:38:02 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:38:02 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:38:02 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:38:02 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 1
2024-12-30 23:38:02 | DEBUG    | agents.rules_agent:_process_section_rules:63 - No content provided, fetching raw content
2024-12-30 23:38:02 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 1
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:38:02 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:38:02 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:38:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:38:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:38:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:38:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:38:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:38:02 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:38:02 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:38:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:38:02 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:38:02 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 1
2024-12-30 23:38:02 | INFO     | agents.rules_agent:_process_section_rules:75 - Analyzing rules for section 1 with LLM
2024-12-30 23:38:02 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:108 - Starting LLM extraction for section 1
2024-12-30 23:38:11 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:153 - Forced needs_dice to False because dice_type is none
2024-12-30 23:38:11 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:192 - Processed choices: [{'text': "Engager la procÃ©dure d'Ã©vasion", 'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}, {'text': 'Continuer votre route', 'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}]
2024-12-30 23:38:11 | ERROR    | agents.rules_agent:_extract_rules_with_llm:219 - Error extracting rules with LLM: 2 validation errors for RulesModel
choices.0
  Value error, Direct choices cannot have dice type [type=value_error, input_value={'text': "Engager la proc...ne', 'dice_results': {}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
choices.1
  Value error, Direct choices cannot have dice type [type=value_error, input_value={'text': 'Continuer votre...ne', 'dice_results': {}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
2024-12-30 23:38:11 | ERROR    | agents.rules_agent:_extract_rules_with_llm:220 - Section content: {
    "needs_dice": false,
    "dice_type": "none",
    "needs_user_response": true,
    "next_action": "user_first",
    "conditions": [],
    "choices": [
        {
            "text": "Engager la procÃ©dure d'Ã©vasion",
            "type": "direct",
            "target_section": 48,
            "conditions": [],
            "dice_type": "none"
        },
        {
            "text": "Continuer votre route",
            "type": "direct",
            "target_section": 398,
            "conditions": [],
            "dice_type": "none"
        }
    ],
    "rules_summary": "Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s."
}
2024-12-30 23:38:11 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:38:11 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:38:11 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:38:11 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:38:11 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:94e9d024-2db6-2388-e52e-e319918be541'], when='during'),)
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current in namespace state
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1 in namespace state
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1
2024-12-30 23:38:11 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:38:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:38:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:38:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7f31401c-3980-48d0-aa86-2b7744f896aa' game_id='38fcddf7-fb44-4ff3-9d2f-49192f7628bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 38, 2, 489741), last_update=datetime.datetime(2024, 12, 30, 23, 38, 2, 490163)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[], rules_summary='{\n    "needs_dice": false,\n    "dice_type": "none",\n    "needs_user_response": true,\n    "next_action": "user_first",\n    "conditions": [],\n    "choices": [\n        {\n            "text": "Engager la procÃ©dure d\'Ã©vasion",\n            "type": "direct",\n            "target_section": 48,\n            "conditions": [],\n            "dice_type": "none"\n        },\n        {\n            "text": "Continuer votre route",\n            "type": "direct",\n            "target_section": 398,\n            "conditions": [],\n            "dice_type": "none"\n        }\n    ],\n    "rules_summary": "Le joueur doit choisir entre engager la procÃ©dure d\'Ã©vasion ou continuer sa route sans lancer de dÃ©s."\n}', error='Error in LLM analysis: 2 validation errors for RulesModel\nchoices.0\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': "Engager la proc...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error\nchoices.1\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': \'Continuer votre...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error', source='error', source_type=<SourceType.ERROR: 'error'>, last_update=datetime.datetime(2024, 12, 30, 23, 38, 11, 464931)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:38:11 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:38:11 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:38:11 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7f31401c-3980-48d0-aa86-2b7744f896aa' game_id='38fcddf7-fb44-4ff3-9d2f-49192f7628bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 38, 2, 489741), last_update=datetime.datetime(2024, 12, 30, 23, 38, 2, 490163)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[], rules_summary='{\n    "needs_dice": false,\n    "dice_type": "none",\n    "needs_user_response": true,\n    "next_action": "user_first",\n    "conditions": [],\n    "choices": [\n        {\n            "text": "Engager la procÃ©dure d\'Ã©vasion",\n            "type": "direct",\n            "target_section": 48,\n            "conditions": [],\n            "dice_type": "none"\n        },\n        {\n            "text": "Continuer votre route",\n            "type": "direct",\n            "target_section": 398,\n            "conditions": [],\n            "dice_type": "none"\n        }\n    ],\n    "rules_summary": "Le joueur doit choisir entre engager la procÃ©dure d\'Ã©vasion ou continuer sa route sans lancer de dÃ©s."\n}', error='Error in LLM analysis: 2 validation errors for RulesModel\nchoices.0\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': "Engager la proc...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error\nchoices.1\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': \'Continuer votre...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error', source='error', source_type=<SourceType.ERROR: 'error'>, last_update=datetime.datetime(2024, 12, 30, 23, 38, 11, 464931)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:38:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:38:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:38:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:38:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:38:59 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:38:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:38:59 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:38:59 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:38:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:38:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='7f31401c-3980-48d0-aa86-2b7744f896aa' game_id='38fcddf7-fb44-4ff3-9d2f-49192f7628bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 38, 2, 489741), last_update=datetime.datetime(2024, 12, 30, 23, 38, 2, 490163)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[], rules_summary='{\n    "needs_dice": false,\n    "dice_type": "none",\n    "needs_user_response": true,\n    "next_action": "user_first",\n    "conditions": [],\n    "choices": [\n        {\n            "text": "Engager la procÃ©dure d\'Ã©vasion",\n            "type": "direct",\n            "target_section": 48,\n            "conditions": [],\n            "dice_type": "none"\n        },\n        {\n            "text": "Continuer votre route",\n            "type": "direct",\n            "target_section": 398,\n            "conditions": [],\n            "dice_type": "none"\n        }\n    ],\n    "rules_summary": "Le joueur doit choisir entre engager la procÃ©dure d\'Ã©vasion ou continuer sa route sans lancer de dÃ©s."\n}', error='Error in LLM analysis: 2 validation errors for RulesModel\nchoices.0\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': "Engager la proc...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error\nchoices.1\n  Value error, Direct choices cannot have dice type [type=value_error, input_value={\'text\': \'Continuer votre...ne\', \'dice_results\': {}}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/value_error', source='error', source_type=<SourceType.ERROR: 'error'>, last_update=datetime.datetime(2024, 12, 30, 23, 38, 11, 464931)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current in namespace state
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current.json
2024-12-30 23:38:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_current
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1 in namespace state
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:38:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\38fcddf7-fb44-4ff3-9d2f-49192f7628bc\states\game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1.json
2024-12-30 23:38:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_38fcddf7-fb44-4ff3-9d2f-49192f7628bc_section_1
2024-12-30 23:38:59 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:38:59 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:38:59 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:39:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:39:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:39:03 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:39:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:39:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:39:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:39:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:39:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:39:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:39:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:39:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:39:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:39:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:39:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:39:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:39:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:39:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:39:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:39:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:39:04 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:39:04 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:39:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:39:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:39:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:39:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:39:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:39:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:39:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:39:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:39:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:39:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:41:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:41:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:41:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:41:46 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:41:46 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:41:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:41:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:41:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:41:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:41:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:41:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:41:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:41:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:41:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:41:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:41:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:41:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:41:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:41:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:41:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:41:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:41:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:41:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:41:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:41:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:41:51 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:41:51 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:41:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:41:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:41:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:41:51 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:41:51 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:41:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:41:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:41:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:41:51 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:41:51 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:46:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:46:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:46:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:46:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:46:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:46:32 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:32 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:46:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:34 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:46:34 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:46:34 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:46:34 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:46:34 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:46:34 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:46:34 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:46:34 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 967ef152-6b40-4590-92ee-884c0a7ba73b
2024-12-30 23:46:34 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 967ef152-6b40-4590-92ee-884c0a7ba73b
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\traces
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters
2024-12-30 23:46:34 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 967ef152-6b40-4590-92ee-884c0a7ba73b
2024-12-30 23:46:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 548cd939-4145-439a-bca0-5216d823e0ea
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:46:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '548cd939-4145-439a-bca0-5216d823e0ea', 'game_id': '967ef152-6b40-4590-92ee-884c0a7ba73b', 'last_update': '2024-12-30T23:46:34.643082', 'character_id': 'current'}
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:46:34 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:46:34 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:46:34 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:46:34 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:46:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 282062cb-6eca-47d0-b4c0-7d8bf93f3b34
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:46:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '282062cb-6eca-47d0-b4c0-7d8bf93f3b34', 'game_id': '967ef152-6b40-4590-92ee-884c0a7ba73b', 'last_update': '2024-12-30T23:46:34.772243', 'character_id': 'current'}
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:46:34 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=282062cb-6eca-47d0-b4c0-7d8bf93f3b34, game_id=967ef152-6b40-4590-92ee-884c0a7ba73b, section_number=1
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:46:34 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 282062cb-6eca-47d0-b4c0-7d8bf93f3b34 and section_number: 1
2024-12-30 23:46:34 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:46:34 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:46:34 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:46:34 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-30 23:46:34 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 1
2024-12-30 23:46:34 | DEBUG    | agents.rules_agent:_process_section_rules:63 - No content provided, fetching raw content
2024-12-30 23:46:34 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 1
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:46:34 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:46:34 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:46:34 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:46:34 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 1 in namespace raw_content
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:46:34 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:46:34 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:46:34 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:46:34 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:46:34 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:46:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\1.md (2540 characters)
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-30 23:46:34 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/1
2024-12-30 23:46:34 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 1
2024-12-30 23:46:34 | INFO     | agents.rules_agent:_process_section_rules:75 - Analyzing rules for section 1 with LLM
2024-12-30 23:46:34 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:108 - Starting LLM extraction for section 1
2024-12-30 23:46:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:153 - Forced needs_dice to False because dice_type is none
2024-12-30 23:46:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:192 - Processed choices: [{'text': "Engager la procÃ©dure d'Ã©vasion", 'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}, {'text': 'Continuer votre route', 'type': 'direct', 'target_section': 398, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}]
2024-12-30 23:46:45 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:196 - Created RulesModel: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action='user_first' conditions=[] choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)
2024-12-30 23:46:45 | DEBUG    | agents.rules_agent:_process_section_rules:80 - Analysis successful, saving to cache
2024-12-30 23:46:45 | INFO     | managers.rules_manager:save_rules:108 - Saving rules for section 1
2024-12-30 23:46:45 | DEBUG    | managers.rules_manager:_rules_to_markdown:136 - Converting rules to markdown for section 1
2024-12-30 23:46:45 | DEBUG    | managers.rules_manager:_format_choices:171 - Formatting 2 choices
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1_rules in namespace rules
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:46:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for rules/section_1_rules
2024-12-30 23:46:45 | DEBUG    | managers.rules_manager:save_rules:117 - Rules saved successfully for section 1
2024-12-30 23:46:45 | INFO     | agents.rules_agent:_process_section_rules:85 - Rules saved successfully
2024-12-30 23:46:45 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:46:45 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:46:45 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:46:45 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:46:45 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:17a19969-e71f-f1d7-1e69-36ae742e3aa2'], when='during'),)
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:46:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:46:45 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:45 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:46:45 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:46:45 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:46:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:46:45 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:45 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='548cd939-4145-439a-bca0-5216d823e0ea' game_id='967ef152-6b40-4590-92ee-884c0a7ba73b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 46, 34, 854621), last_update=datetime.datetime(2024, 12, 30, 23, 46, 34, 855661)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:46:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:46:45 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:46:45 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='548cd939-4145-439a-bca0-5216d823e0ea' game_id='967ef152-6b40-4590-92ee-884c0a7ba73b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 46, 34, 854621), last_update=datetime.datetime(2024, 12, 30, 23, 46, 34, 855661)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:47:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 23:47:02 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '967ef152-6b40-4590-92ee-884c0a7ba73b', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 23:47:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='967ef152-6b40-4590-92ee-884c0a7ba73b' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 23:47:02 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 23:47:02 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:47:02 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='548cd939-4145-439a-bca0-5216d823e0ea' game_id='967ef152-6b40-4590-92ee-884c0a7ba73b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 46, 34, 854621), last_update=datetime.datetime(2024, 12, 30, 23, 46, 34, 855661)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:47:02 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:47:02 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:47:02 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 46, 34, 854621), last_update=datetime.datetime(2024, 12, 30, 23, 46, 34, 855661)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:47:02 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:47:02 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:47:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 72d53e17-d741-4414-bc8d-be3f3ce4ba74
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\characters\current.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:47:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '72d53e17-d741-4414-bc8d-be3f3ce4ba74', 'game_id': '967ef152-6b40-4590-92ee-884c0a7ba73b', 'last_update': '2024-12-30T23:47:02.314343', 'character_id': 'current'}
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:47:02 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=72d53e17-d741-4414-bc8d-be3f3ce4ba74, game_id=967ef152-6b40-4590-92ee-884c0a7ba73b, section_number=1
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:47:02 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 72d53e17-d741-4414-bc8d-be3f3ce4ba74 and section_number: 1
2024-12-30 23:47:02 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:47:02 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:47:02 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:47:02 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:47:02 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:47:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:47:02 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:47:02 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:47:02 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:47:02 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:47:02 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:47:02 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:47:02 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:47:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:47:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:47:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:47:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:47:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:47:02 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:47:02 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:47:02 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:47:02 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:47:02 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:47:02 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:47:02 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=user_first
2024-12-30 23:47:02 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2024-12-30 23:47:02 | ERROR    | agents.decision_agent:analyze_response:92 - Error analyzing response: Object of type datetime is not JSON serializable
2024-12-30 23:47:02 | ERROR    | agents.decision_agent:_process_decision:164 - Error in decision processing: Failed to analyze response: Object of type datetime is not JSON serializable
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 68, in analyze_response
    RÃ¨gles: {json.dumps(rules, indent=2)}
             â    â     â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function dumps at 0x000002025B2D2480>
             â <module 'json' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\Lib\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
      â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
      â {}
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             â    â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function JSONEncoder.iterencode at 0x000002025B2D28E0>
             â <json.encoder.JSONEncoder object at 0x00000202602B1A30>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
           â           â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
           â <_json.Encoder object at 0x000002026032D300>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                                      â â         â <member '__name__' of 'getset_descriptor' objects>
                                      â â <attribute '__class__' of 'object' objects>
                                      â datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)

TypeError: Object of type datetime is not JSON serializable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=10464, pipe_handle=1584)
                                      â           â <function spawn_main at 0x000002025AAC0860>
                                      â <function spawn_main at 0x000002025AAC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 564
               â     â 3
               â <function _main at 0x000002025AAC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 564
           â    â <function BaseProcess._bootstrap at 0x000002025AA06A20>
           â <SpawnProcess name='SpawnProcess-40' parent=10464 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000002025AA05F80>
    â <SpawnProcess name='SpawnProcess-40' parent=10464 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000002025FE934D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-40' parent=10464 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-40' parent=10464 started>
    â    â <function subprocess_started at 0x000002025FF1F6A0>
    â <SpawnProcess name='SpawnProcess-40' parent=10464 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=1012, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000002025FE93620>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=1012, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002025FF1E980>
           â       â   â <uvicorn.server.Server object at 0x000002025FE93620>
           â       â <function run at 0x000002025AF063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000002025FF12A40>
           â      â <function Runner.run at 0x000002025AF704A0>
           â <asyncio.runners.Runner object at 0x000002025FF441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000002025AF69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000002025FF441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000002025AF69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000002025AF6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000002025AEED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000020260819000>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000020260819000>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000020260819000>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000020260819000>()>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 198, in _process_decision
    async for result in self.decision_agent.ainvoke({"state": input_data}):
                        â    â              â                 â GameState(session_id='', game_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement da...
                        â    â              â <function DecisionAgent.ainvoke at 0x000002025FDF62A0>
                        â    â <agents.decision_agent.DecisionAgent object at 0x000002025FFE6BA0>
                        â <agents.story_graph.StoryGraph object at 0x000002025FFE41A0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 175, in ainvoke
    decision = await self._process_decision(
                     â    â <function DecisionAgent._process_decision at 0x000002025FDF5620>
                     â <agents.decision_agent.DecisionAgent object at 0x000002025FFE6BA0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 147, in _process_decision
    analysis_result = await self.analyze_response(
                            â    â <function DecisionAgent.analyze_response at 0x000002025FDF4400>
                            â <agents.decision_agent.DecisionAgent object at 0x000002025FFE6BA0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 93, in analyze_response
    raise DecisionError(f"Failed to analyze response: {str(e)}")
          â <class 'models.errors_model.DecisionError'>

models.errors_model.DecisionError: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:47:02 | ERROR    | agents.decision_agent:ainvoke:182 - Decision processing error: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:47:02 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=1
2024-12-30 23:47:02 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 23:47:02 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:47:02 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:47:02 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-30 23:47:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 23:47:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:47:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:47:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:47:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:47:54 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:47:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:47:54 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:47:54 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:47:54 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:47:54 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='548cd939-4145-439a-bca0-5216d823e0ea' game_id='967ef152-6b40-4590-92ee-884c0a7ba73b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 46, 34, 854621), last_update=datetime.datetime(2024, 12, 30, 23, 46, 34, 855661)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=DecisionModel(section_number=1, next_section=1, error='Failed to analyze response: Object of type datetime is not JSON serializable', awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 23, 47, 2, 442318)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_current in namespace state
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_current.json
2024-12-30 23:47:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_current
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1 in namespace state
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:47:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\967ef152-6b40-4590-92ee-884c0a7ba73b\states\game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1.json
2024-12-30 23:47:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_967ef152-6b40-4590-92ee-884c0a7ba73b_section_1
2024-12-30 23:47:54 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:47:54 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:47:54 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:47:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:48:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:48:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:48:02 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:48:02 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:48:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:48:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:48:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:48:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:48:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:48:02 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:48:02 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:48:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:48:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:48:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:48:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:48:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:48:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:48:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:48:04 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:48:04 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:48:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:48:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:48:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:48:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:48:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:48:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:48:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:48:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:48:04 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:48:04 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:00 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:50:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:00 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:50:00 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:50:00 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:50:00 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:50:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:06 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:50:07 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:50:07 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:50:07 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:50:07 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:07 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:50:07 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:50:07 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:07 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:50:07 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:50:07 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:50:07 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:50:07 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:50:07 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:50:07 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:50:07 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:50:08 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:50:08 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:50:08 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:50:08 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:50:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:12 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:12 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:12 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:12 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:13 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:13 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:14 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:50:14 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:50:14 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:50:14 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:50:14 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:50:14 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: f287f4dc-625f-4d10-83ad-b1c18e2bca1e
2024-12-30 23:50:14 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: f287f4dc-625f-4d10-83ad-b1c18e2bca1e
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\traces
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters
2024-12-30 23:50:14 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: f287f4dc-625f-4d10-83ad-b1c18e2bca1e
2024-12-30 23:50:14 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0afca6eb-affd-4530-8879-3589f8875676
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:50:14 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0afca6eb-affd-4530-8879-3589f8875676', 'game_id': 'f287f4dc-625f-4d10-83ad-b1c18e2bca1e', 'last_update': '2024-12-30T23:50:14.539266', 'character_id': 'current'}
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:14 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:50:14 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:50:14 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:50:14 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:50:14 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1c246130-36b7-49de-b71d-cf06d570d5a0
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:50:14 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1c246130-36b7-49de-b71d-cf06d570d5a0', 'game_id': 'f287f4dc-625f-4d10-83ad-b1c18e2bca1e', 'last_update': '2024-12-30T23:50:14.588364', 'character_id': 'current'}
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:14 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=1c246130-36b7-49de-b71d-cf06d570d5a0, game_id=f287f4dc-625f-4d10-83ad-b1c18e2bca1e, section_number=1
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:14 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 1c246130-36b7-49de-b71d-cf06d570d5a0 and section_number: 1
2024-12-30 23:50:14 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:50:14 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:50:14 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:50:14 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:50:14 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:50:14 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:50:14 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:50:14 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:50:14 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:50:14 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:50:14 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:50:14 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:50:14 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:50:14 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:50:14 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:50:14 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:50:14 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:50:14 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:50:14 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:50:14 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:50:14 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:50:14 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:50:14 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:410aa32a-d0e9-755b-3258-c6545cb75d1d'], when='during'),)
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:14 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:14 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:50:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='0afca6eb-affd-4530-8879-3589f8875676' game_id='f287f4dc-625f-4d10-83ad-b1c18e2bca1e' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 50, 14, 661171), last_update=datetime.datetime(2024, 12, 30, 23, 50, 14, 661190)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:50:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:14 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='0afca6eb-affd-4530-8879-3589f8875676' game_id='f287f4dc-625f-4d10-83ad-b1c18e2bca1e' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 50, 14, 661171), last_update=datetime.datetime(2024, 12, 30, 23, 50, 14, 661190)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:50:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 23:50:18 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f287f4dc-625f-4d10-83ad-b1c18e2bca1e', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 23:50:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f287f4dc-625f-4d10-83ad-b1c18e2bca1e' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 23:50:18 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 23:50:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='0afca6eb-affd-4530-8879-3589f8875676' game_id='f287f4dc-625f-4d10-83ad-b1c18e2bca1e' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 50, 14, 661171), last_update=datetime.datetime(2024, 12, 30, 23, 50, 14, 661190)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:50:18 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:50:18 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:50:18 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 50, 14, 661171), last_update=datetime.datetime(2024, 12, 30, 23, 50, 14, 661190)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:50:18 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:50:18 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:50:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 5a4c6c60-cde4-4e98-bc4b-de7f6805fa20
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\characters\current.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:50:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '5a4c6c60-cde4-4e98-bc4b-de7f6805fa20', 'game_id': 'f287f4dc-625f-4d10-83ad-b1c18e2bca1e', 'last_update': '2024-12-30T23:50:18.625443', 'character_id': 'current'}
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:18 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=5a4c6c60-cde4-4e98-bc4b-de7f6805fa20, game_id=f287f4dc-625f-4d10-83ad-b1c18e2bca1e, section_number=1
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:18 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 5a4c6c60-cde4-4e98-bc4b-de7f6805fa20 and section_number: 1
2024-12-30 23:50:18 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:50:18 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:50:18 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:50:18 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:50:18 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:50:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:50:18 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:50:18 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:50:18 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:50:18 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:50:18 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:50:18 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:50:18 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:50:18 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:50:18 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:50:18 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:50:18 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:50:18 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:50:18 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:50:18 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:50:18 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:50:18 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:50:18 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:50:18 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:50:18 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=user_first
2024-12-30 23:50:18 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2024-12-30 23:50:18 | ERROR    | agents.decision_agent:analyze_response:92 - Error analyzing response: Object of type datetime is not JSON serializable
2024-12-30 23:50:18 | ERROR    | agents.decision_agent:_process_decision:164 - Error in decision processing: Failed to analyze response: Object of type datetime is not JSON serializable
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 68, in analyze_response
    RÃ¨gles: {json.dumps(rules.model_dump() if hasattr(rules, 'model_dump') else rules, indent=2)}
             â    â     â                             â                         â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â                             â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function dumps at 0x00000272D1DD2480>
             â <module 'json' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\Lib\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
      â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
      â {}
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             â    â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function JSONEncoder.iterencode at 0x00000272D1DD28E0>
             â <json.encoder.JSONEncoder object at 0x00000272D6B84910>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
           â           â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
           â <_json.Encoder object at 0x00000272D72CD900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                                      â â         â <member '__name__' of 'getset_descriptor' objects>
                                      â â <attribute '__class__' of 'object' objects>
                                      â datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)

TypeError: Object of type datetime is not JSON serializable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=10464, pipe_handle=2328)
                                      â           â <function spawn_main at 0x00000272D16C0860>
                                      â <function spawn_main at 0x00000272D16C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x00000272D16C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x00000272D1606A20>
           â <SpawnProcess name='SpawnProcess-42' parent=10464 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000272D1605F80>
    â <SpawnProcess name='SpawnProcess-42' parent=10464 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000272D6B8F4D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-42' parent=10464 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-42' parent=10464 started>
    â    â <function subprocess_started at 0x00000272D6E1B6A0>
    â <SpawnProcess name='SpawnProcess-42' parent=10464 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=724, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000272D6B8F620>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=724, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x00000272D6E1A980>
           â       â   â <uvicorn.server.Server object at 0x00000272D6B8F620>
           â       â <function run at 0x00000272D1C063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x00000272D6E0E960>
           â      â <function Runner.run at 0x00000272D1C704A0>
           â <asyncio.runners.Runner object at 0x00000272D6E401A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000272D1C69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x00000272D6E401A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000272D1C69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000272D1C6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000272D1BED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000272D72A6B30>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000272D72A6B30>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000272D72A6B30>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000272D72A6B30>()>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 198, in _process_decision
    async for result in self.decision_agent.ainvoke({"state": input_data}):
                        â    â              â                 â GameState(session_id='', game_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement da...
                        â    â              â <function DecisionAgent.ainvoke at 0x00000272D6B122A0>
                        â    â <agents.decision_agent.DecisionAgent object at 0x00000272D6EDEBA0>
                        â <agents.story_graph.StoryGraph object at 0x00000272D6EDC1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 175, in ainvoke
    decision = await self._process_decision(
                     â    â <function DecisionAgent._process_decision at 0x00000272D6B11620>
                     â <agents.decision_agent.DecisionAgent object at 0x00000272D6EDEBA0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 147, in _process_decision
    analysis_result = await self.analyze_response(
                            â    â <function DecisionAgent.analyze_response at 0x00000272D6B10400>
                            â <agents.decision_agent.DecisionAgent object at 0x00000272D6EDEBA0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 93, in analyze_response
    raise DecisionError(f"Failed to analyze response: {str(e)}")
          â <class 'models.errors_model.DecisionError'>

models.errors_model.DecisionError: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:50:18 | ERROR    | agents.decision_agent:ainvoke:182 - Decision processing error: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:50:18 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=1
2024-12-30 23:50:18 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 23:50:18 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:18 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:18 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-30 23:50:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 23:50:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:31 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:50:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:50:31 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:50:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='0afca6eb-affd-4530-8879-3589f8875676' game_id='f287f4dc-625f-4d10-83ad-b1c18e2bca1e' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 50, 14, 661171), last_update=datetime.datetime(2024, 12, 30, 23, 50, 14, 661190)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=DecisionModel(section_number=1, next_section=1, error='Failed to analyze response: Object of type datetime is not JSON serializable', awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 23, 50, 18, 726516)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current in namespace state
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current.json
2024-12-30 23:50:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_current
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1 in namespace state
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:50:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f287f4dc-625f-4d10-83ad-b1c18e2bca1e\states\game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1.json
2024-12-30 23:50:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f287f4dc-625f-4d10-83ad-b1c18e2bca1e_section_1
2024-12-30 23:50:31 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:50:31 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:50:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:50:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:35 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:50:35 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:50:35 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:50:35 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:50:35 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:35 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:50:35 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:50:35 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:35 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:50:35 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:50:35 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:50:35 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:50:35 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:50:35 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:50:35 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:50:35 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:50:36 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:50:36 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:50:36 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:50:36 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:50:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:36 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:36 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:50:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:50:46 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:50:46 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-30 23:50:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:50:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:52 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 23:50:52 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 23:50:52 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 23:50:52 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 23:50:52 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 23:50:52 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 23:50:52 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 23:50:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:50:54 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:50:54 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:50:54 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:50:54 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:50:54 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:54 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:50:54 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:50:54 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:50:54 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:50:54 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:50:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:50:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:50:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:50:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:50:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:50:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:50:55 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:50:55 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:50:55 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:50:55 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:55 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:55 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:50:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:50:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:50:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:50:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:50:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:50:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:54:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:54:00 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:54:00 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:54:00 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:54:00 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:54:00 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:54:00 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 3c92268b-5b00-4a8f-bdaa-548da927c789
2024-12-30 23:54:00 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 3c92268b-5b00-4a8f-bdaa-548da927c789
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\traces
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters
2024-12-30 23:54:00 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 3c92268b-5b00-4a8f-bdaa-548da927c789
2024-12-30 23:54:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d77aa85a-be60-488c-aa4b-c1e4f5759b80
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:54:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd77aa85a-be60-488c-aa4b-c1e4f5759b80', 'game_id': '3c92268b-5b00-4a8f-bdaa-548da927c789', 'last_update': '2024-12-30T23:54:00.710404', 'character_id': 'current'}
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:00 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:54:00 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:54:00 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:54:00 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:54:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f6bc1271-1780-405c-8082-c6931f955991
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:54:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f6bc1271-1780-405c-8082-c6931f955991', 'game_id': '3c92268b-5b00-4a8f-bdaa-548da927c789', 'last_update': '2024-12-30T23:54:00.751568', 'character_id': 'current'}
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:00 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=f6bc1271-1780-405c-8082-c6931f955991, game_id=3c92268b-5b00-4a8f-bdaa-548da927c789, section_number=1
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:00 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: f6bc1271-1780-405c-8082-c6931f955991 and section_number: 1
2024-12-30 23:54:00 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:54:00 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:54:00 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:54:00 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:54:00 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:54:00 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:54:00 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:54:00 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:54:00 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:54:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:54:00 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:54:00 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:54:00 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:54:00 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:54:00 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:54:00 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:54:00 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:54:00 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:54:00 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:54:00 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:54:00 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:54:00 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:54:00 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:a5e83862-6b09-3094-fd86-5229e9e65d2d'], when='during'),)
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:00 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:54:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:54:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:54:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='d77aa85a-be60-488c-aa4b-c1e4f5759b80' game_id='3c92268b-5b00-4a8f-bdaa-548da927c789' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 54, 0, 815248), last_update=datetime.datetime(2024, 12, 30, 23, 54, 0, 815271)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:54:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:54:00 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='d77aa85a-be60-488c-aa4b-c1e4f5759b80' game_id='3c92268b-5b00-4a8f-bdaa-548da927c789' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 54, 0, 815248), last_update=datetime.datetime(2024, 12, 30, 23, 54, 0, 815271)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:54:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 23:54:09 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '3c92268b-5b00-4a8f-bdaa-548da927c789', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 23:54:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='3c92268b-5b00-4a8f-bdaa-548da927c789' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 23:54:09 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 23:54:09 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:54:09 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='d77aa85a-be60-488c-aa4b-c1e4f5759b80' game_id='3c92268b-5b00-4a8f-bdaa-548da927c789' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 54, 0, 815248), last_update=datetime.datetime(2024, 12, 30, 23, 54, 0, 815271)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:54:09 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:54:09 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:54:09 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 54, 0, 815248), last_update=datetime.datetime(2024, 12, 30, 23, 54, 0, 815271)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:54:09 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:54:09 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:54:09 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1a7ee834-a34b-462f-8126-806e7a6fc335
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\characters\current.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:54:09 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1a7ee834-a34b-462f-8126-806e7a6fc335', 'game_id': '3c92268b-5b00-4a8f-bdaa-548da927c789', 'last_update': '2024-12-30T23:54:09.477668', 'character_id': 'current'}
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:09 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=1a7ee834-a34b-462f-8126-806e7a6fc335, game_id=3c92268b-5b00-4a8f-bdaa-548da927c789, section_number=1
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:09 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 1a7ee834-a34b-462f-8126-806e7a6fc335 and section_number: 1
2024-12-30 23:54:09 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:54:09 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:54:09 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:54:09 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:54:09 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:54:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:54:09 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:54:09 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:54:09 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:54:09 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:54:09 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:54:09 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:54:09 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:54:09 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:54:09 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:54:09 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:54:09 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:54:09 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:54:09 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:54:09 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:54:09 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:54:09 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:54:09 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:54:09 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:54:09 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=user_first
2024-12-30 23:54:09 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2024-12-30 23:54:09 | ERROR    | agents.decision_agent:analyze_response:92 - Error analyzing response: Object of type datetime is not JSON serializable
2024-12-30 23:54:09 | ERROR    | agents.decision_agent:_process_decision:164 - Error in decision processing: Failed to analyze response: Object of type datetime is not JSON serializable
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 68, in analyze_response
    RÃ¨gles: {json.dumps(rules.model_dump() if hasattr(rules, 'model_dump') else rules, indent=2)}
             â    â     â                             â                         â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â                             â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function dumps at 0x0000028F27ED2480>
             â <module 'json' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\Lib\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
      â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
      â {}
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             â    â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function JSONEncoder.iterencode at 0x0000028F27ED28E0>
             â <json.encoder.JSONEncoder object at 0x0000028F2CED5590>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
           â           â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
           â <_json.Encoder object at 0x0000028F2CFE26E0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                                      â â         â <member '__name__' of 'getset_descriptor' objects>
                                      â â <attribute '__class__' of 'object' objects>
                                      â datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)

TypeError: Object of type datetime is not JSON serializable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=8060, pipe_handle=1088)
                                      â           â <function spawn_main at 0x0000028F276C0860>
                                      â <function spawn_main at 0x0000028F276C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 600
               â     â 3
               â <function _main at 0x0000028F276C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 600
           â    â <function BaseProcess._bootstrap at 0x0000028F27606A20>
           â <SpawnProcess name='SpawnProcess-1' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000028F27605F80>
    â <SpawnProcess name='SpawnProcess-1' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000028F2CA8F4D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=8060 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=8060 started>
    â    â <function subprocess_started at 0x0000028F2CE176A0>
    â <SpawnProcess name='SpawnProcess-1' parent=8060 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=736, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000028F2CA8F620>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=736, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000028F2CE16980>
           â       â   â <uvicorn.server.Server object at 0x0000028F2CA8F620>
           â       â <function run at 0x0000028F27B063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000028F2CE0A960>
           â      â <function Runner.run at 0x0000028F27B704A0>
           â <asyncio.runners.Runner object at 0x0000028F2CE3C1A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000028F27B69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000028F2CE3C1A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000028F27B69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000028F27B6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000028F27AED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028F2CFA7D00>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028F2CFA7D00>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028F2CFA7D00>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028F2CFA7D00>()>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 198, in _process_decision
    async for result in self.decision_agent.ainvoke({"state": input_data}):
                        â    â              â                 â GameState(session_id='', game_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement da...
                        â    â              â <function DecisionAgent.ainvoke at 0x0000028F2C7F62A0>
                        â    â <agents.decision_agent.DecisionAgent object at 0x0000028F2CEDEBA0>
                        â <agents.story_graph.StoryGraph object at 0x0000028F2CEDC1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 175, in ainvoke
    decision = await self._process_decision(
                     â    â <function DecisionAgent._process_decision at 0x0000028F2C7F5620>
                     â <agents.decision_agent.DecisionAgent object at 0x0000028F2CEDEBA0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 147, in _process_decision
    analysis_result = await self.analyze_response(
                            â    â <function DecisionAgent.analyze_response at 0x0000028F2C7F4400>
                            â <agents.decision_agent.DecisionAgent object at 0x0000028F2CEDEBA0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 93, in analyze_response
    raise DecisionError(f"Failed to analyze response: {str(e)}")
          â <class 'models.errors_model.DecisionError'>

models.errors_model.DecisionError: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:54:09 | ERROR    | agents.decision_agent:ainvoke:182 - Decision processing error: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:54:09 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=1
2024-12-30 23:54:09 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 23:54:09 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:09 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:54:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:54:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:54:09 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-30 23:54:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-30 23:57:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:57:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:57:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:57:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:57:07 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 23:57:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:57:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 23:57:07 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-30 23:57:07 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:57:07 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='d77aa85a-be60-488c-aa4b-c1e4f5759b80' game_id='3c92268b-5b00-4a8f-bdaa-548da927c789' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 54, 0, 815248), last_update=datetime.datetime(2024, 12, 30, 23, 54, 0, 815271)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=DecisionModel(section_number=1, next_section=1, error='Failed to analyze response: Object of type datetime is not JSON serializable', awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 23, 54, 9, 576311)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_current in namespace state
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:57:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:57:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_current.json
2024-12-30 23:57:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_current
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1 in namespace state
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:57:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:57:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:57:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3c92268b-5b00-4a8f-bdaa-548da927c789\states\game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1.json
2024-12-30 23:57:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_3c92268b-5b00-4a8f-bdaa-548da927c789_section_1
2024-12-30 23:57:07 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-30 23:57:07 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-30 23:57:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 23:57:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:57:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 23:57:15 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 23:57:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 23:57:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 23:57:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 23:57:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:57:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 23:57:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 23:57:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 23:57:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 23:57:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 23:57:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 23:57:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 23:57:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 23:57:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 23:57:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 23:57:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 23:57:18 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 23:57:18 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 23:57:18 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 23:57:18 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 23:57:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:57:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:57:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:57:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:57:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:57:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:57:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:57:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:57:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:58:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:58:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:58:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:58:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:58:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:58:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:58:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:58:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:58:58 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:58:58 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:58:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 23:58:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 23:58:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:58:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:58:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:58:59 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:58:59 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-30 23:59:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:59:03 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-30 23:59:03 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-30 23:59:03 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 23:59:03 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 23:59:03 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 23:59:03 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: ce48dfad-76d4-40f2-835a-8e7ec692290a
2024-12-30 23:59:03 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: ce48dfad-76d4-40f2-835a-8e7ec692290a
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\traces
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters
2024-12-30 23:59:03 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: ce48dfad-76d4-40f2-835a-8e7ec692290a
2024-12-30 23:59:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 30bd781e-e7e2-41b8-a24d-765dc6c5c657
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:59:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '30bd781e-e7e2-41b8-a24d-765dc6c5c657', 'game_id': 'ce48dfad-76d4-40f2-835a-8e7ec692290a', 'last_update': '2024-12-30T23:59:03.079655', 'character_id': 'current'}
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:03 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:59:03 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:59:03 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:59:03 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:59:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9f375c87-6a8c-4061-b9fb-3564c0e83d8c
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:59:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9f375c87-6a8c-4061-b9fb-3564c0e83d8c', 'game_id': 'ce48dfad-76d4-40f2-835a-8e7ec692290a', 'last_update': '2024-12-30T23:59:03.118049', 'character_id': 'current'}
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:03 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=9f375c87-6a8c-4061-b9fb-3564c0e83d8c, game_id=ce48dfad-76d4-40f2-835a-8e7ec692290a, section_number=1
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:03 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 9f375c87-6a8c-4061-b9fb-3564c0e83d8c and section_number: 1
2024-12-30 23:59:03 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:59:03 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:59:03 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:59:03 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 23:59:03 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:59:03 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:59:03 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:59:03 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:59:03 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:59:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:59:03 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:59:03 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:59:03 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:59:03 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:59:03 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 23:59:03 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:59:03 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:59:03 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:59:03 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:59:03 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:59:03 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:59:03 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-30 23:59:03 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:8fa1a1c8-ef51-9314-1d47-39802c402c8d'], when='during'),)
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:03 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-30 23:59:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 23:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='30bd781e-e7e2-41b8-a24d-765dc6c5c657' game_id='ce48dfad-76d4-40f2-835a-8e7ec692290a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 59, 3, 173864), last_update=datetime.datetime(2024, 12, 30, 23, 59, 3, 173885)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:59:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:59:03 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='30bd781e-e7e2-41b8-a24d-765dc6c5c657' game_id='ce48dfad-76d4-40f2-835a-8e7ec692290a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 59, 3, 173864), last_update=datetime.datetime(2024, 12, 30, 23, 59, 3, 173885)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 23:59:05 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'ce48dfad-76d4-40f2-835a-8e7ec692290a', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 23:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='ce48dfad-76d4-40f2-835a-8e7ec692290a' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 23:59:05 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-30 23:59:05 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-30 23:59:05 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='30bd781e-e7e2-41b8-a24d-765dc6c5c657' game_id='ce48dfad-76d4-40f2-835a-8e7ec692290a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 59, 3, 173864), last_update=datetime.datetime(2024, 12, 30, 23, 59, 3, 173885)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 23:59:05 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-30 23:59:05 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-30 23:59:05 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 59, 3, 173864), last_update=datetime.datetime(2024, 12, 30, 23, 59, 3, 173885)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 23:59:05 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-30 23:59:05 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-30 23:59:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f5e58013-5901-41c8-9701-d0ff19edba81
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\characters\current.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 23:59:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f5e58013-5901-41c8-9701-d0ff19edba81', 'game_id': 'ce48dfad-76d4-40f2-835a-8e7ec692290a', 'last_update': '2024-12-30T23:59:05.183598', 'character_id': 'current'}
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:05 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=f5e58013-5901-41c8-9701-d0ff19edba81, game_id=ce48dfad-76d4-40f2-835a-8e7ec692290a, section_number=1
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:05 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: f5e58013-5901-41c8-9701-d0ff19edba81 and section_number: 1
2024-12-30 23:59:05 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 23:59:05 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-30 23:59:05 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-30 23:59:05 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 23:59:05 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 23:59:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 23:59:05 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 23:59:05 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 23:59:05 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-30 23:59:05 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-30 23:59:05 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 23:59:05 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 23:59:05 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 23:59:05 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 23:59:05 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 23:59:05 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 23:59:05 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 23:59:05 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 23:59:05 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 23:59:05 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 23:59:05 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-30 23:59:05 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:59:05 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:59:05 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 23:59:05 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=user_first
2024-12-30 23:59:05 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2024-12-30 23:59:05 | ERROR    | agents.decision_agent:analyze_response:92 - Error analyzing response: Object of type datetime is not JSON serializable
2024-12-30 23:59:05 | ERROR    | agents.decision_agent:_process_decision:164 - Error in decision processing: Failed to analyze response: Object of type datetime is not JSON serializable
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 68, in analyze_response
    RÃ¨gles: {json.dumps(rules.model_dump() if hasattr(rules, 'model_dump') else rules, indent=2)}
             â    â     â                             â                         â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â                             â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â     â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function dumps at 0x000001C78AED2480>
             â <module 'json' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\Lib\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
      â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
      â {}
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             â    â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function JSONEncoder.iterencode at 0x000001C78AED28E0>
             â <json.encoder.JSONEncoder object at 0x000001C78FB32490>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
           â           â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
           â <_json.Encoder object at 0x000001C790242140>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                                      â â         â <member '__name__' of 'getset_descriptor' objects>
                                      â â <attribute '__class__' of 'object' objects>
                                      â datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)

TypeError: Object of type datetime is not JSON serializable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=8060, pipe_handle=1088)
                                      â           â <function spawn_main at 0x000001C78A5C0860>
                                      â <function spawn_main at 0x000001C78A5C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 608
               â     â 3
               â <function _main at 0x000001C78A5C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 608
           â    â <function BaseProcess._bootstrap at 0x000001C78A506A20>
           â <SpawnProcess name='SpawnProcess-2' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000001C78A505F80>
    â <SpawnProcess name='SpawnProcess-2' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000001C78FA934D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-2' parent=8060 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-2' parent=8060 started>
    â    â <function subprocess_started at 0x000001C78FB1F880>
    â <SpawnProcess name='SpawnProcess-2' parent=8060 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=728, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000001C78FA93620>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=728, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000001C78FB1EB60>
           â       â   â <uvicorn.server.Server object at 0x000001C78FA93620>
           â       â <function run at 0x000001C78AA063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000001C78FB12960>
           â      â <function Runner.run at 0x000001C78AA704A0>
           â <asyncio.runners.Runner object at 0x000001C78FB441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000001C78AA69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000001C78FB441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000001C78AA69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000001C78AA6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000001C78A9ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001C7901E13C0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001C7901E13C0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001C7901E13C0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001C7901E13C0>()>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 198, in _process_decision
    async for result in self.decision_agent.ainvoke({"state": input_data}):
                        â    â              â                 â GameState(session_id='', game_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement da...
                        â    â              â <function DecisionAgent.ainvoke at 0x000001C78F9F6520>
                        â    â <agents.decision_agent.DecisionAgent object at 0x000001C78FBEABA0>
                        â <agents.story_graph.StoryGraph object at 0x000001C78FBE81A0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 175, in ainvoke
    decision = await self._process_decision(
                     â    â <function DecisionAgent._process_decision at 0x000001C78F9F58A0>
                     â <agents.decision_agent.DecisionAgent object at 0x000001C78FBEABA0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 147, in _process_decision
    analysis_result = await self.analyze_response(
                            â    â <function DecisionAgent.analyze_response at 0x000001C78F9F4220>
                            â <agents.decision_agent.DecisionAgent object at 0x000001C78FBEABA0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 93, in analyze_response
    raise DecisionError(f"Failed to analyze response: {str(e)}")
          â <class 'models.errors_model.DecisionError'>

models.errors_model.DecisionError: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:59:05 | ERROR    | agents.decision_agent:ainvoke:182 - Decision processing error: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-30 23:59:05 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=1
2024-12-30 23:59:05 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-30 23:59:05 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:05 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 23:59:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-30 23:59:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-30 23:59:05 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-30 23:59:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-31 00:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:05:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:05:18 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:05:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:05:18 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:05:18 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:05:18 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:05:18 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='30bd781e-e7e2-41b8-a24d-765dc6c5c657' game_id='ce48dfad-76d4-40f2-835a-8e7ec692290a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 23, 59, 3, 173864), last_update=datetime.datetime(2024, 12, 30, 23, 59, 3, 173885)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=DecisionModel(section_number=1, next_section=1, error='Failed to analyze response: Object of type datetime is not JSON serializable', awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 23, 59, 5, 323532)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current in namespace state
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-31 00:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-31 00:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current.json
2024-12-31 00:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_current
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1 in namespace state
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:05:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-31 00:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-31 00:05:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ce48dfad-76d4-40f2-835a-8e7ec692290a\states\game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1.json
2024-12-31 00:05:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_ce48dfad-76d4-40f2-835a-8e7ec692290a_section_1
2024-12-31 00:05:18 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-31 00:05:18 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-31 00:05:18 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:05:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:05:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:05:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:05:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:05:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:05:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:05:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:05:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:05:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:05:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:05:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:05:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:05:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:05:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:05:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:05:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:05:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:05:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:05:29 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:05:29 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:05:29 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:05:29 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:05:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:05:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:05:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:05:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:05:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:05:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:05:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:05:29 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:05:29 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:06:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:06:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:06:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:06:23 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:06:23 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:06:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:06:23 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:06:23 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:06:23 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:06:23 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:06:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:06:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:06:30 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:06:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:06:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:06:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:06:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:06:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:06:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:06:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:06:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:06:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:06:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:06:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:06:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:06:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:06:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:06:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:06:31 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:06:31 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:06:31 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:06:31 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:06:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:06:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:06:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:06:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:06:31 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:06:31 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:07:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:07:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:07:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:07:13 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:07:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:07:13 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:07:13 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:07:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:07:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:07:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:07:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:07:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:07:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:07:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:07:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:07:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:07:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:07:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:07:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:07:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:07:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:07:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:07:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:07:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:07:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:07:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:07:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:07:17 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:07:17 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:07:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:07:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:07:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:07:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:07:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:07:17 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:17 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:07:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:07:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:07:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:07:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:52 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:07:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:07:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:07:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:07:53 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:53 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:07:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:56 | INFO     | managers.agent_manager:initialize_game:166 - Initializing game
2024-12-31 00:07:56 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_story_workflow:304 - Story graph not configured, configuring now
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_story_workflow:313 - Compiling workflow
2024-12-31 00:07:56 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-31 00:07:56 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-31 00:07:56 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-31 00:07:56 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 28959ebf-82b9-416c-9272-c3ae551ebf04
2024-12-31 00:07:56 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 28959ebf-82b9-416c-9272-c3ae551ebf04
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\traces
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters
2024-12-31 00:07:56 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 28959ebf-82b9-416c-9272-c3ae551ebf04
2024-12-31 00:07:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1c27e4fe-18e9-43cb-a657-3eb726028bb1
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-31 00:07:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1c27e4fe-18e9-43cb-a657-3eb726028bb1', 'game_id': '28959ebf-82b9-416c-9272-c3ae551ebf04', 'last_update': '2024-12-31T00:07:56.322613', 'character_id': 'current'}
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:07:56 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-31 00:07:56 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-31 00:07:56 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-31 00:07:56 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-31 00:07:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a3ebcbf9-d53c-4cbf-b42c-848062747d91
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-31 00:07:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a3ebcbf9-d53c-4cbf-b42c-848062747d91', 'game_id': '28959ebf-82b9-416c-9272-c3ae551ebf04', 'last_update': '2024-12-31T00:07:56.345680', 'character_id': 'current'}
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:07:56 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=a3ebcbf9-d53c-4cbf-b42c-848062747d91, game_id=28959ebf-82b9-416c-9272-c3ae551ebf04, section_number=1
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:07:56 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: a3ebcbf9-d53c-4cbf-b42c-848062747d91 and section_number: 1
2024-12-31 00:07:56 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-31 00:07:56 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-31 00:07:56 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-31 00:07:56 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-31 00:07:56 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-31 00:07:56 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-31 00:07:56 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-31 00:07:56 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-31 00:07:56 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-31 00:07:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-31 00:07:56 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-31 00:07:56 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-31 00:07:56 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-31 00:07:56 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-31 00:07:56 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2546 characters)
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-31 00:07:56 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-31 00:07:56 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-31 00:07:56 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-31 00:07:56 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-31 00:07:56 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-31 00:07:56 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-31 00:07:56 | INFO     | agents.story_graph:_process_decision:192 - Waiting for user input in section 1
2024-12-31 00:07:56 | INFO     | agents.story_graph:_process_decision:225 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:f2486ab9-30e0-e628-2dc9-83fd1faec3b0'], when='during'),)
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:07:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:07:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:07:56 | INFO     | managers.agent_manager:initialize_game:205 - Game initialization completed successfully
2024-12-31 00:07:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:07:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='1c27e4fe-18e9-43cb-a657-3eb726028bb1' game_id='28959ebf-82b9-416c-9272-c3ae551ebf04' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 31, 0, 7, 56, 390659), last_update=datetime.datetime(2024, 12, 31, 0, 7, 56, 390676)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-31 00:07:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:07:56 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='1c27e4fe-18e9-43cb-a657-3eb726028bb1' game_id='28959ebf-82b9-416c-9272-c3ae551ebf04' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 31, 0, 7, 56, 390659), last_update=datetime.datetime(2024, 12, 31, 0, 7, 56, 390676)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-31 00:08:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-31 00:08:01 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '28959ebf-82b9-416c-9272-c3ae551ebf04', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-31 00:08:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='28959ebf-82b9-416c-9272-c3ae551ebf04' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-31 00:08:01 | INFO     | managers.agent_manager:process_game_state:221 - Starting game state processing
2024-12-31 00:08:01 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:08:01 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='1c27e4fe-18e9-43cb-a657-3eb726028bb1' game_id='28959ebf-82b9-416c-9272-c3ae551ebf04' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 31, 0, 7, 56, 390659), last_update=datetime.datetime(2024, 12, 31, 0, 7, 56, 390676)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-31 00:08:01 | INFO     | managers.agent_manager:get_story_workflow:300 - Getting story workflow
2024-12-31 00:08:01 | INFO     | managers.workflow_manager:start_workflow:59 - Starting workflow node
2024-12-31 00:08:01 | DEBUG    | managers.workflow_manager:start_workflow:60 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 31, 0, 7, 56, 390659), last_update=datetime.datetime(2024, 12, 31, 0, 7, 56, 390676)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-31 00:08:01 | DEBUG    | managers.workflow_manager:start_workflow:71 - Input data is already a GameState
2024-12-31 00:08:01 | DEBUG    | managers.workflow_manager:start_workflow:78 - Creating initial state with session_id and game_id
2024-12-31 00:08:01 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 09d79f84-237d-449f-8c25-a53c4861dd26
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\characters\current.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-31 00:08:01 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '09d79f84-237d-449f-8c25-a53c4861dd26', 'game_id': '28959ebf-82b9-416c-9272-c3ae551ebf04', 'last_update': '2024-12-31T00:08:01.267004', 'character_id': 'current'}
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:08:01 | DEBUG    | managers.workflow_manager:start_workflow:82 - State merged with initial state: session_id=09d79f84-237d-449f-8c25-a53c4861dd26, game_id=28959ebf-82b9-416c-9272-c3ae551ebf04, section_number=1
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:08:01 | INFO     | managers.workflow_manager:start_workflow:90 - Successfully created and saved output with session_id: 09d79f84-237d-449f-8c25-a53c4861dd26 and section_number: 1
2024-12-31 00:08:01 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-31 00:08:01 | DEBUG    | agents.rules_agent:ainvoke:241 - Processing rules for state: session=, section=1
2024-12-31 00:08:01 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2024-12-31 00:08:01 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-30T23:46:45.147710', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-31 00:08:01 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-31 00:08:01 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-31 00:08:01 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-31 00:08:01 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-31 00:08:01 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2024-12-31 00:08:01 | DEBUG    | agents.rules_agent:ainvoke:261 - Rules processed successfully
2024-12-31 00:08:01 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-31 00:08:01 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-31 00:08:01 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-31 00:08:01 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-31 00:08:01 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-31 00:08:01 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-31 00:08:01 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-31 00:08:01 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-31 00:08:01 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-31 00:08:01 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-31 00:08:01 | INFO     | agents.story_graph:_process_decision:181 - Processing decision for section 1
2024-12-31 00:08:01 | DEBUG    | agents.story_graph:_process_decision:197 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-31 00:08:01 | INFO     | agents.decision_agent:ainvoke:171 - Starting decision processing: session=, section=1, input=Engager la procÃ©dure d'Ã©vasion
2024-12-31 00:08:01 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procÃ©dure d'Ã©vasion
2024-12-31 00:08:01 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=user_first
2024-12-31 00:08:01 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2024-12-31 00:08:01 | ERROR    | agents.decision_agent:analyze_response:92 - Error analyzing response: Object of type datetime is not JSON serializable
2024-12-31 00:08:01 | ERROR    | agents.decision_agent:_process_decision:164 - Error in decision processing: Failed to analyze response: Object of type datetime is not JSON serializable
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 68, in analyze_response
    RÃ¨gles: {json.dumps(rules, indent=2)}
             â    â     â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function dumps at 0x0000024B325D2480>
             â <module 'json' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\Lib\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
      â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
      â {}
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             â    â          â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
             â    â <function JSONEncoder.iterencode at 0x0000024B325D28E0>
             â <json.encoder.JSONEncoder object at 0x0000024B37A78410>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
           â           â {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': ...
           â <_json.Encoder object at 0x0000024B37AC8760>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                                      â â         â <member '__name__' of 'getset_descriptor' objects>
                                      â â <attribute '__class__' of 'object' objects>
                                      â datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)

TypeError: Object of type datetime is not JSON serializable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=8060, pipe_handle=1812)
                                      â           â <function spawn_main at 0x0000024B31FC0860>
                                      â <function spawn_main at 0x0000024B31FC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 596
               â     â 3
               â <function _main at 0x0000024B31FC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 596
           â    â <function BaseProcess._bootstrap at 0x0000024B31F06A20>
           â <SpawnProcess name='SpawnProcess-5' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000024B31F05F80>
    â <SpawnProcess name='SpawnProcess-5' parent=8060 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000024B373934D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-5' parent=8060 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-5' parent=8060 started>
    â    â <function subprocess_started at 0x0000024B3761FA60>
    â <SpawnProcess name='SpawnProcess-5' parent=8060 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=688, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000024B37393620>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=688, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000024B3761ED40>
           â       â   â <uvicorn.server.Server object at 0x0000024B37393620>
           â       â <function run at 0x0000024B324063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000024B37612960>
           â      â <function Runner.run at 0x0000024B324704A0>
           â <asyncio.runners.Runner object at 0x0000024B376441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000024B32469E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000024B376441A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000024B32469DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000024B3246BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000024B323ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024B37A6FD00>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024B37A6FD00>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024B37A6FD00>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024B37A6FD00>()>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 198, in _process_decision
    async for result in self.decision_agent.ainvoke({"state": input_data}):
                        â    â              â                 â GameState(session_id='', game_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement da...
                        â    â              â <function DecisionAgent.ainvoke at 0x0000024B373027A0>
                        â    â <agents.decision_agent.DecisionAgent object at 0x0000024B376EABA0>
                        â <agents.story_graph.StoryGraph object at 0x0000024B376E81A0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 175, in ainvoke
    decision = await self._process_decision(
                     â    â <function DecisionAgent._process_decision at 0x0000024B37301B20>
                     â <agents.decision_agent.DecisionAgent object at 0x0000024B376EABA0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 147, in _process_decision
    analysis_result = await self.analyze_response(
                            â    â <function DecisionAgent.analyze_response at 0x0000024B373004A0>
                            â <agents.decision_agent.DecisionAgent object at 0x0000024B376EABA0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 93, in analyze_response
    raise DecisionError(f"Failed to analyze response: {str(e)}")
          â <class 'models.errors_model.DecisionError'>

models.errors_model.DecisionError: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-31 00:08:01 | ERROR    | agents.decision_agent:ainvoke:182 - Decision processing error: Failed to analyze response: Object of type datetime is not JSON serializable
2024-12-31 00:08:01 | INFO     | agents.story_graph:_process_decision:215 - Decision processed: current_section=1, next_section=1
2024-12-31 00:08:01 | INFO     | managers.workflow_manager:end_workflow:111 - Ending workflow with output: session=, section=1
2024-12-31 00:08:01 | DEBUG    | managers.workflow_manager:end_workflow:116 - Saving final state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:08:01 | INFO     | managers.workflow_manager:end_workflow:119 - Workflow ended successfully
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:01 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:08:01 | INFO     | managers.agent_manager:process_game_state:272 - Game state processed successfully
2024-12-31 00:08:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2024-12-31 00:08:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:08:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:08:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:08:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:08:30 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:08:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:08:30 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:08:30 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:08:30 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:08:30 | DEBUG    | managers.agent_manager:get_state:150 - Current state: session_id='1c27e4fe-18e9-43cb-a657-3eb726028bb1' game_id='28959ebf-82b9-416c-9272-c3ae551ebf04' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans. \n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â» \n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et vous pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique. \n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 31, 0, 7, 56, 390659), last_update=datetime.datetime(2024, 12, 31, 0, 7, 56, 390676)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 30, 23, 46, 45, 147710)) trace=None character=None decision=DecisionModel(section_number=1, next_section=1, error='Failed to analyze response: Object of type datetime is not JSON serializable', awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2024, 12, 31, 0, 8, 1, 501986)) error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_current in namespace state
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_current.json
2024-12-31 00:08:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_current
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1 in namespace state
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-31 00:08:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\28959ebf-82b9-416c-9272-c3ae551ebf04\states\game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1.json
2024-12-31 00:08:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_28959ebf-82b9-416c-9272-c3ae551ebf04_section_1
2024-12-31 00:08:30 | INFO     | managers.agent_manager:stop_game:384 - Final game state saved successfully
2024-12-31 00:08:30 | INFO     | managers.agent_manager:stop_game:386 - Game stopped successfully
2024-12-31 00:08:30 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:08:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:08:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:08:37 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:08:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:08:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:08:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:08:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:08:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:08:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:08:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:08:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:08:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:08:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:08:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:08:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:08:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:08:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:08:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:08:40 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:08:40 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:08:40 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:08:40 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:08:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:08:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:08:40 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:08:40 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:08:40 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:08:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:08:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:08:40 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:08:40 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:11:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:11:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:11:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:11:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:11:08 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:11:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:11:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:11:08 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:11:08 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:11:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:11:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:11:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:11:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:11:14 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:11:14 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:11:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:11:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:11:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:11:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:14 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:11:14 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:11:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:11:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:11:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:11:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:11:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:11:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:11:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:11:15 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:11:15 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:11:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:11:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:11:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:11:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:11:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:11:15 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:11:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:11:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:11:15 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:11:15 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:11:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:11:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:11:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:11:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:11:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:11:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:11:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:11:47 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:11:47 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:11:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:11:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:11:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:11:55 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:11:56 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:11:56 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:11:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:11:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:11:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:11:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:11:56 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:11:56 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:11:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:11:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:11:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:11:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:11:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:11:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:11:57 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:11:57 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:11:57 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:11:57 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:11:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:11:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:11:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:11:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:11:57 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:11:57 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:12:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:12:01 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:12:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:12:01 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:12:01 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:12:01 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:12:01 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:12:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:12:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:12:07 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:12:07 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:12:07 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:12:07 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:12:07 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:07 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:12:07 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:12:07 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:07 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:12:07 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:12:07 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:12:07 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:12:07 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:12:07 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:12:07 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:12:07 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:12:08 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:12:08 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:12:08 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:12:08 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:12:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:12:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:12:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:12:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:12:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:12:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:12:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:12:08 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:12:08 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:12:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:12:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:12:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:12:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:12:13 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:12:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:12:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:12:13 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:12:13 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:12:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:12:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:12:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:12:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:12:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:12:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:12:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:12:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:12:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:12:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:12:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:12:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:12:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:12:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:12:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:12:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:12:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:12:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-31 00:12:22 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-31 00:12:22 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-31 00:12:22 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-31 00:12:22 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-31 00:12:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:12:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:12:22 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:12:22 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:12:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:12:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-31 00:12:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-31 00:12:22 | DEBUG    | managers.agent_manager:get_state:148 - Fetching current game state
2024-12-31 00:12:22 | DEBUG    | managers.agent_manager:get_state:150 - Current state: None
2024-12-31 00:13:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:13:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:13:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-31 00:13:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-31 00:13:10 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-31 00:13:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-31 00:13:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-31 00:13:10 | INFO     | managers.agent_manager:stop_game:372 - Stopping game...
2024-12-31 00:13:10 | DEBUG    | managers.agent_manager:stop_game:377 - No game ID set, nothing to save
2024-12-31 00:13:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-31 00:13:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:13:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-31 00:13:19 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-31 00:13:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-31 00:13:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-31 00:13:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-31 00:13:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:13:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-31 00:13:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-31 00:13:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-31 00:13:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-31 00:13:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-31 00:13:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-31 00:13:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-31 00:13:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-31 00:13:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-31 00:13:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-31 00:13:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
